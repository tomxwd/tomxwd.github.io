<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/ico/girl-128x128.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/ico/girl-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/ico/girl-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="alternate" href="/atom.xml" title="tomxwd.blog" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="tomxwd">
<meta name="keywords" content="blog">
<meta property="og:type" content="website">
<meta property="og:title" content="tomxwd.blog">
<meta property="og:url" content="http:&#x2F;&#x2F;www.blog.tomxwd.com&#x2F;page&#x2F;4&#x2F;index.html">
<meta property="og:site_name" content="tomxwd.blog">
<meta property="og:description" content="tomxwd">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://www.blog.tomxwd.com/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>tomxwd.blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">tomxwd.blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/tomxwd" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/07/Hadoop/06_Hadoop_%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/07/Hadoop/06_Hadoop_%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F/" class="post-title-link" itemprop="url">06_Hadoop_运行模式</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-07 18:13:48" itemprop="dateCreated datePublished" datetime="2019-10-07T18:13:48+08:00">2019-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">Hadoop</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="06-Hadoop-运行模式"><a href="#06-Hadoop-运行模式" class="headerlink" title="06_Hadoop_运行模式"></a>06_Hadoop_运行模式</h1><p>Hadoop运行模式包括：本地模式、伪分布式模式以及完全分布式模式。</p>
<p><a href="http://hadoop.apache.org/" target="_blank" rel="noopener">Hadoop官方网站</a></p>
<p><a href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html" target="_blank" rel="noopener">getting start</a></p>
<h2 id="本地运行模式"><a href="#本地运行模式" class="headerlink" title="本地运行模式"></a>本地运行模式</h2><h3 id="官方Grep案例"><a href="#官方Grep案例" class="headerlink" title="官方Grep案例"></a>官方Grep案例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> mkdir input</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cp etc/hadoop/*.xml input</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.1.jar grep input output <span class="string">'dfs[a-z.]+'</span></span></span><br><span class="line"><span class="meta">$</span><span class="bash"> cat output/*</span></span><br></pre></td></tr></table></figure>

<ol>
<li><p>cd到hadoop目录下</p>
</li>
<li><p>mkdir input</p>
</li>
<li><p>复制etc下的配置文件到input</p>
<ul>
<li>cp etc/haddop/*.xml input</li>
</ul>
</li>
<li><p>运行share目录下的案例jar，且指定为grep案例，指定input以及output，这里output不可以先创建，否则报错，然后正则一下</p>
<ul>
<li>hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar grep input output ‘dfs[a-z.]+’</li>
</ul>
</li>
<li><p>查看output目录</p>
<ul>
<li><p>两个文件，一个是_SUCCESS，这个只是标记，标记成功完成。</p>
</li>
<li><p>另一个文件是结果，这里cat一下看看</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1	dfsadmin</span><br></pre></td></tr></table></figure>

<p>只有一个结果。</p>
</li>
<li><p>可以改一下正则表达式的内容查看输出。</p>
</li>
</ul>
</li>
</ol>
<h3 id="官方WordCount案例"><a href="#官方WordCount案例" class="headerlink" title="官方WordCount案例"></a>官方WordCount案例</h3><p>目的：统计单词的个数</p>
<ol>
<li><p>cd到hadoop目录下</p>
</li>
<li><p>创建wcinput目录</p>
<ul>
<li>mkdir wcinput</li>
</ul>
</li>
<li><p>在wcinput目录下创建wc.input文件</p>
<ul>
<li>touch wc.input</li>
</ul>
</li>
<li><p>编辑wc.input文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop yarn</span><br><span class="line">hadoop mapreduce</span><br><span class="line">tomxwd</span><br><span class="line">tomxwd</span><br></pre></td></tr></table></figure>
</li>
<li><p>回到hadoop目录</p>
</li>
<li><p>运行share目录下的案例jar，指定wordcount案例，指定wcinput和wcoutput</p>
<ul>
<li>hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar wordcount wcinput wcoutput</li>
</ul>
</li>
<li><p>查看执行结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hadoop yarn</span><br><span class="line">hadoop mapreduce</span><br><span class="line">tomxwd</span><br><span class="line">tomxwd</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="伪分布式模式"><a href="#伪分布式模式" class="headerlink" title="伪分布式模式"></a>伪分布式模式</h2><h3 id="启动HDFS并运行MapReduce程序"><a href="#启动HDFS并运行MapReduce程序" class="headerlink" title="启动HDFS并运行MapReduce程序"></a>启动HDFS并运行MapReduce程序</h3><blockquote>
<p><a href="https://hadoop.apache.org/docs/stable/hadoop-project-dist/hadoop-common/SingleCluster.html#Pseudo-Distributed_Operation" target="_blank" rel="noopener">官网文档</a></p>
<p>在官网右侧，可以找到Configuration，是关于xml配置文件的详细解释</p>
</blockquote>
<p>伪分布式模式的配置信息与完全分布式模式的一样，只是说伪分布式模式只用一台服务器来完成，适合学习的时候用。</p>
<ol>
<li><p>修改etc/hadoop/core-site.xml配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定HDFS中NameNode的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://localhost:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定Hadoop运行时产生文件的存储目录，默认是在/tmp/hadoop-$&#123;user.name&#125; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/open/environment/hadoop-2.9.2/data/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改etc/hadoop/hdfs-site.xml配置文件</p>
<p>默认值是3</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定HDFS副本的数量 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改etc/hadoop/hadoop-env.sh文件的jdk</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> Set Hadoop-specific environment variables here.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The only required environment variable is JAVA_HOME.  All others are</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> optional.  When running a distributed configuration it is best to</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">set</span> JAVA_HOME <span class="keyword">in</span> this file, so that it is correctly defined on</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> remote nodes.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> The java implementation to use.</span></span><br><span class="line">JAVA_HOME=/opt/open/environment/jdk1.8.0_221</span><br><span class="line">export JAVA_HOME=$&#123;JAVA_HOME&#125;</span><br></pre></td></tr></table></figure>

<p>上面的说明写了，指定JAVA_HOME，其他的不用</p>
</li>
<li><p>启动集群</p>
<ul>
<li><p>格式化NameNode（第一次启动时格式化，以后就不要总格式化）</p>
<p>bin/hdfs namenode -format</p>
<p>如果格式化遇到任何问题，可能是data文件没有删除，日志文件没有删除</p>
</li>
<li><p>启动NameNode</p>
<p>sbin/hadoop-daemon.sh start namenode</p>
<ul>
<li>出现提示：starting namenode, logging to /opt/open/environment/hadoop-2.9.2/logs/hadoop-tomxwd-namenode-hadoop101.out</li>
</ul>
</li>
<li><p>启动DataNode</p>
<p>sbin/hadoop-daemon.sh start datanode</p>
<ul>
<li>出现提示：starting datanode, logging to /opt/open/environment/hadoop-2.9.2/logs/hadoop-tomxwd-datanode-hadoop101.out</li>
</ul>
</li>
</ul>
</li>
<li><p>查看集群</p>
<ul>
<li>查看是否启动成功<ul>
<li>可以用jps命令来查看进程，是java ps的意思，有NameNode进程，以及DataNode进程</li>
<li><a href="http://192.168.5.101:50070是访问地址，主要关注最后的Utilities&gt;&gt;Browse" target="_blank" rel="noopener">http://192.168.5.101:50070是访问地址，主要关注最后的Utilities&gt;&gt;Browse</a> Directory</li>
</ul>
</li>
</ul>
</li>
<li><p>添加目录：</p>
<ul>
<li>bin/hdfs dfs -mkdir -p /user/tomxwd/input</li>
</ul>
</li>
<li><p>查看新添加的目录：</p>
<ul>
<li>bin/hdfs dfs -ls -R /</li>
</ul>
</li>
<li><p>把本地wcinput上传到HDFS上：</p>
<ul>
<li>bin/hdfs dfs -put wcinput/wc.input /user/tomxwd/input</li>
</ul>
</li>
<li><p>执行一下wordcount案例：</p>
<ul>
<li>bin/hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar wordcount /user/tomxwd/input /user/tomxwd/output</li>
</ul>
</li>
<li><p>到页面上看是否有output，然后下载下来看结果，或者用bin/hdfs dfs -cat /user/tomxwd/output/p*看结果即可。</p>
</li>
</ol>
<h4 id="NameNode格式化注意事项"><a href="#NameNode格式化注意事项" class="headerlink" title="NameNode格式化注意事项"></a>NameNode格式化注意事项</h4><p>格式化前的工作：</p>
<ol>
<li><p>在格式化前，先用jps看看是否已经启动了NameNode，如果启动了要结束进程。</p>
</li>
<li><p>然后再看data和log文件，如果有，则删掉。</p>
</li>
<li><p>最后进行NameNode格式化。</p>
</li>
</ol>
<p>为什么不能一直格式化NameNode？</p>
<ul>
<li><p>cd到data/tmp/dfs/name/current，查看VERSION文件的内容，以及到data/tmp/dfs/data/current，查看VERSION的内容。</p>
<ul>
<li>关注clusterID的值</li>
</ul>
</li>
<li><p>因为格式化NameNode，会产生新的集群id，导致NameNode和DataNode的集群id不一致，集群找不到以往的数据，所以在格式化NameNode的时候，一定要删除data数据和log日志，然后再格式化NameNode</p>
</li>
</ul>
<p><img src="06_Hadoop_%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F/1570547884705.png" alt="1570547884705"></p>
<h4 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h4><p>出现问题的时候看datanode.log文件，也可以看看namenode.log的信息。</p>
<h3 id="启动YARN并运行MapReduce程序"><a href="#启动YARN并运行MapReduce程序" class="headerlink" title="启动YARN并运行MapReduce程序"></a>启动YARN并运行MapReduce程序</h3><p>分析</p>
<ul>
<li>配置集群在YARN上运行MR</li>
<li>启动、测试集群<strong>增删查</strong></li>
<li>在YARN上执行WordCount案例</li>
</ul>
<p>执行步骤</p>
<ol>
<li><p>配置集群</p>
<ul>
<li><p>配置yarn-env.sh</p>
<p>配置一下JAVA_HOME</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> some Java parameters</span></span><br><span class="line">export JAVA_HOME=/opt/open/environment/jdk1.8.0_221</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置yarn-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Reducer获取数据的方法 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定YARN的ResourceManager的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop101<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>配置mapred-env.sh</p>
<p>配置一下JAVAHOME</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> some Java parameters</span></span><br><span class="line">export JAVA_HOME=/opt/open/environment/jdk1.8.0_221</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置mapred-site.xml（把mapred-site.xml.template重命名）</p>
<p><code>mv mapred-site.xml.template mapred-site.xml</code></p>
<p><code>vim mapred-site.xml</code></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定MR运行在YARN上 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>启动集群</p>
<ul>
<li><p>启动前确保NameNode和DataNode已经启动</p>
</li>
<li><p>启动ResourceManager</p>
<p><code>sbin/yarn-daemon.sh start resourcemanager</code></p>
</li>
<li><p>启动NodeManager</p>
<p><code>sbin/yarn-daemon.sh start nodemanager</code></p>
</li>
</ul>
</li>
<li><p>集群操作</p>
<ul>
<li><p>YARN的浏览器页面查看</p>
<p><a href="http://192.168.5.101:8088/cluster" target="_blank" rel="noopener">http://192.168.5.101:8088/cluster</a></p>
</li>
</ul>
</li>
<li><p>删掉之前的output，然后试着再次运行wordcount案例</p>
<p><code>hdfs dfs -rm -r /user/tomxwd/output</code></p>
<p><code>hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar wordcount /user/tomxwd/input /user/tomxwd/output</code></p>
</li>
<li><p>在运行的时候查看浏览器页面</p>
</li>
</ol>
<h4 id="配置历史服务器"><a href="#配置历史服务器" class="headerlink" title="配置历史服务器"></a>配置历史服务器</h4><p>为了查看程序的历史运行情况，需要配置一下历史服务器。具体步骤：</p>
<ol>
<li><p>配置mapred-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 历史服务器端地址  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop101:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 历史服务器web端地址  --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop101:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>启动历史服务器</p>
<p><code>sbin/mr-jobhistory-daemon.sh start historyserver</code></p>
</li>
<li><p>用jps查看历史服务器是否启动</p>
</li>
<li><p>查看JobHistory</p>
<p><a href="http://192.168.5.101:19888/jobhistory" target="_blank" rel="noopener">http://192.168.5.101:19888/jobhistory</a></p>
</li>
</ol>
<h4 id="配置日志的聚集"><a href="#配置日志的聚集" class="headerlink" title="配置日志的聚集"></a>配置日志的聚集</h4><p>日志聚集概念：应用运行完成后，将程序的运行日志信息上传到HDFS系统上；</p>
<p>日志聚集的好处：可以方便查看到程序运行的详情，方便开发调试；</p>
<p>注意：<strong>开启日志聚集功能，需要重新启动NodeManager、ResourceManager和HistoryManager。</strong></p>
<p>​    用jps看开启了哪些，用原来启动的指令，改为stop即可。</p>
<p>步骤：</p>
<ol>
<li><p>配置yarn-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 日志聚集功能 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation-enable<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 日志保留时间为7天 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.log-aggregation.retain-seconds<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>604800<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>关闭NodeManager、ResourceManager和HistoryServer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn-daemon.sh stop nodemanager</span><br><span class="line">yarn-daemon.sh stop resourcemanager</span><br><span class="line">mr-jobhistory-daemon.sh stop historyserver</span><br></pre></td></tr></table></figure>
</li>
<li><p>启动NodeManager、ResourceManager和HistoryServer</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn-daemon.sh start nodemanager</span><br><span class="line">yarn-daemon.sh start resourcemanager</span><br><span class="line">mr-jobhistory-daemon.sh start historyserver</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除HDFS上存在的输出文件output</p>
<p><code>hdfs dfs -rm -rf /user/tomxwd/output</code></p>
</li>
<li><p>执行WordCount程序</p>
<p><code>hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-2.9.2.jar wordcount /user/tomxwd/input /user/tomxwd/output</code></p>
</li>
<li><p>查看日志</p>
<ul>
<li>可以在本地日志文件目录看</li>
<li>可以在网页直接点程序的日志看</li>
<li><a href="http://hadoop101:19888/jobhistory" target="_blank" rel="noopener">http://hadoop101:19888/jobhistory</a> 然后点击job后面的logs</li>
</ul>
</li>
</ol>
<h4 id="配置文件说明"><a href="#配置文件说明" class="headerlink" title="配置文件说明"></a>配置文件说明</h4><p>Hadoop配置文件分为两类：默认配置文件和自定义配置文件，只有用户想修改某一默认配置值时，才需要修改自定义配置文件，更改相应的属性值。</p>
<p>默认配置文件：</p>
<p>在官网，快速开始，左边最底下有Configuration，下面都是默认配置文件的信息。</p>
<table>
<thead>
<tr>
<th>要获取的默认文件</th>
<th>文件存放在Hadoop的jar包中的位置</th>
</tr>
</thead>
<tbody><tr>
<td>core-default.xml</td>
<td>hadoop-common-x.x.x.jar/core-default.xml</td>
</tr>
<tr>
<td>hdfs-default.xml</td>
<td>hadoop-hdfs-x.x.x.jar/hdfs-default.xml</td>
</tr>
<tr>
<td>yarn-default.xml</td>
<td>hadoop-yarn-common-x.x.x.jar/yarn-default.xml</td>
</tr>
<tr>
<td>mapred-default.xml</td>
<td>hadoop-mapreduce-client-core-x.x.x.jar/mapred-default.xml</td>
</tr>
</tbody></table>
<p>自定义配置文件：</p>
<p>core-site.xml、hdfs-site.xml、yarn-site.xml、mapred-site.xml四个配置文件存放在%HADOOP_HOME/etc/hadoop这个路径，用户可以根据项目需求重新进行修改配置。</p>
<h2 id="完全分布式"><a href="#完全分布式" class="headerlink" title="完全分布式"></a>完全分布式</h2><p>分析：</p>
<ol>
<li>准备3台客户机（关闭防火墙、静态ip、主机名称）</li>
<li>安装JDK</li>
<li>配置环境变量</li>
<li>安装hadoop</li>
<li>配置环境变量</li>
<li>配置集群</li>
<li>单点启动</li>
<li>配置ssh</li>
<li>群起并测试</li>
</ol>
<h3 id="虚拟机准备"><a href="#虚拟机准备" class="headerlink" title="虚拟机准备"></a>虚拟机准备</h3><p>创建hadoop102，hadoop103，hadoop104三部虚拟机。</p>
<h3 id="编写集群分发脚本xsync"><a href="#编写集群分发脚本xsync" class="headerlink" title="编写集群分发脚本xsync"></a>编写集群分发脚本xsync</h3><ol>
<li><p>scp（secure copy）安全拷贝</p>
<ul>
<li>scp定义：<ul>
<li>scp可以实现服务器与服务器之间的数据拷贝（from server1 to server2）</li>
</ul>
</li>
<li>基本语法<ul>
<li>scp         -r         $pdir/$fname                        $user@$host:$pdir/$fname</li>
<li>命令       递归     要拷贝的文件路径/名称        目标用户@主机:目标路径/名称</li>
</ul>
</li>
<li>案例实操<ul>
<li>在hadoop101上，将hadoop101中/opt/open目录下的软件拷贝到hadoop102上。<ul>
<li>scp -r /opt/open root@hadoop102:/opt/open</li>
</ul>
</li>
<li>在hadoop103上，将hadoop101服务器上的/opt/open 目录下的软件拷贝到hadoop103上。<ul>
<li>sudo scp -r tomxwd@hadoop101:/opt/open root@hadoop103:/opt/open</li>
<li>sudo scp -r tomxwd@hadoop101:/opt/open ./</li>
</ul>
</li>
<li>在hadoop103上，将hadoop101服务器上的/opt/open 目录下的软件拷贝到hadoop104上。<ul>
<li>sudo scp -r tomxwd@hadoop101:/opt/open root@hadoop104:/opt/open</li>
</ul>
</li>
<li>注意要把拷贝过去的文件该权限。/etc/profile同样操作，以及最后需要source /etc/profile即可。</li>
</ul>
</li>
</ul>
</li>
<li><p>rsync远程同步工具</p>
<p>rsync主要用于备份和镜像，具有速度快、避免复制相同内容和支持符号链接的优点。</p>
<p><strong>rsync和scp的区别：</strong>用rsync做文件的复制要比scp的速度快，rsync只对差异文件做更新，而scp是把所有文件复制过去。</p>
<ul>
<li><p>基本语法</p>
<ul>
<li><p>rsync            -rvl            $pdir/$fname                    $user@host:$pdir/$fname</p>
</li>
<li><p>命令              选项参数  要拷贝的文件路径/名称     目标用户@主机:目标路径/名称</p>
</li>
<li><p>选项参数说明：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-r</td>
<td>递归</td>
</tr>
<tr>
<td>-v</td>
<td>显示复制过程</td>
</tr>
<tr>
<td>-l</td>
<td>拷贝符号链接</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>案例实操</p>
<ul>
<li>把hadoop101服务器上的/opt/open目录同步到hadoop102服务器的root用户的/opt/open目录：<ul>
<li>rsync -rvl /opt/open/ root@hadoop102:/opt/open</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>xsync集群分发脚本</p>
<ul>
<li><p>需求：循环复制文件到所有节点的相同目录下</p>
</li>
<li><p>需求分析：</p>
<ul>
<li><p>rsync命令原始拷贝：</p>
<p>rsync -rvl /opt/module    root@hadoop103:/opt</p>
</li>
<li><p>期望脚本：</p>
<p>xsync 要同步的文件名称</p>
</li>
<li><p>说明：</p>
<p>在/home/tomxwd/bin这个目录下存放的脚本，tomxwd用户可以在系统的任何地方直接运行。</p>
</li>
</ul>
</li>
<li><p>脚本实现</p>
<ul>
<li><p>在/home/tomxwd目录下创建bin目录，并在bin目录下创建xsync文件，文件内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 1. 获取输出参数的个数，如果没有参数，就直接退出</span></span><br><span class="line">pcount=$#</span><br><span class="line">echo $pcount</span><br><span class="line">echo $1</span><br><span class="line">if (($pcount==0))</span><br><span class="line">then</span><br><span class="line">        echo no args;</span><br><span class="line">        exit</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 2. 获取文件的名称</span></span><br><span class="line">p1=$1</span><br><span class="line">fname=`basename $p1`</span><br><span class="line">echo fname=$fname</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 3. 获取上级目录的绝对路径 <span class="built_in">cd</span> -P是进入到软链接实际的路径</span></span><br><span class="line">pdir=`cd -P $(dirname $p1); pwd`</span><br><span class="line">echo pdir=$pdir</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 4. 获取当前用户名称</span></span><br><span class="line">user=`whoami`</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 5. 循环</span></span><br><span class="line">for((host=103; host&lt;105; host++));do</span><br><span class="line">        echo --------------hadoop$host-------------------</span><br><span class="line">   rsync -rvl $pdir/$fname $user@hadoop$host:$pdir</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>修改脚本xsync具有执行权限</p>
<p>chmod 777 xsync</p>
<p>u+o也够用了</p>
</li>
<li><p>调用脚本形式：xsync文件名称</p>
<pre><code>xsync /home/tomxwd/bin</code></pre><ul>
<li>注意：如果将xsync放到/home/tomxwd/bin目录下仍然不能实现全局使用，可以将xsync移动到/usr/local/bin目录下。可以用echo $PATH命令看是否包含/home/tomxwd/bin目录即可确定能否使用。</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="集群配置"><a href="#集群配置" class="headerlink" title="集群配置"></a>集群配置</h3><ol>
<li>集群部署规划</li>
</ol>
<table>
<thead>
<tr>
<th></th>
<th>hadoop102</th>
<th>hadoop103</th>
<th>hadoop104</th>
</tr>
</thead>
<tbody><tr>
<td>HDFS</td>
<td>NameNode<br />DataNode</td>
<td><br />DataNode</td>
<td>SecondaryNameNode<br />DataNode</td>
</tr>
<tr>
<td>YARN</td>
<td><br />NodeManager</td>
<td>ResourceManager<br />NodeManager</td>
<td><br />NodeManager</td>
</tr>
</tbody></table>
<ol start="2">
<li><p>配置集群</p>
<ul>
<li><p>核心配置文件</p>
<p>core-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定HDFS中NameNode的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://hadoop102:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定Hadoop运行时产生文件的存储目录，默认是在/tmp/hadoop-$&#123;user.name&#125; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/opt/open/environment/hadoop-2.9.2/data/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>HDFS配置文件</p>
<p>hadoop-env.sh</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/opt/open/environment/jdk1.8.0_221</span><br></pre></td></tr></table></figure>

<p>hdfs-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定HDFS副本的数量 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>3<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 指定Hadoop辅助名称节点主机配置 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop104:50090<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>YARN配置文件</p>
<p>yarn-env.sh</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/opt/open/environment/jdk1.8.0_221</span><br></pre></td></tr></table></figure>

<p>yarn-site.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Reducer获取数据的方法 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 指定YARN的ResourceManager的地址 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>hadoop103<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>MapReduce配置文件</p>
<p>mapred-env.sh</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/opt/open/environment/jdk1.8.0_221</span><br></pre></td></tr></table></figure>

<p>mapred-site.xml（拷贝mapred-site.xml.template得到）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 指定MR运行在YARN上 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>在集群上分发配置好的Hadoop配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xsync /opt/open/environment/hadoop-2.9.2/</span><br></pre></td></tr></table></figure>
</li>
<li><p>查看文件分发情况</p>
<p>用cat指令即可。</p>
</li>
</ol>
<h3 id="集群单点启动"><a href="#集群单点启动" class="headerlink" title="集群单点启动"></a>集群单点启动</h3><ol>
<li><p>如果是第一次启动集群，需要格式化NameNode</p>
<p>前提是，jps看，没有启动任何程序。删除data以及logs文件夹，再格式化！</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop namenode -format</span><br></pre></td></tr></table></figure>
</li>
<li><p>在hadoop102上启动NameNode</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop-daemon.sh start namenode</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br></pre></td></tr></table></figure>
</li>
<li><p>在hadoop102、hadoop103以及hadoop104上分别启动DataNode</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop-daemon.sh start datanode</span><br></pre></td></tr></table></figure>




</li>
</ol>
<h3 id="配置SSH无密登录配置"><a href="#配置SSH无密登录配置" class="headerlink" title="配置SSH无密登录配置"></a>配置SSH无密登录配置</h3><ol>
<li><p>配置ssh</p>
<ul>
<li><p>基本语法</p>
<p>ssh另一台电脑的ip地址</p>
</li>
<li><p>ssh连接时出现Host key verification failed的解决方法</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[tomxwd@hadoop102 ~]$ ssh 192.168.5.102</span><br><span class="line">The authenticity of host '192.168.5.102 (192.168.5.102)' can't be established.</span><br><span class="line">RSA key fingerprint is 97:36:de:ba:15:f4:99:4c:e5:0f:0a:22:03:be:72:e9.</span><br><span class="line">Are you sure you want to continue connecting (yes/no)? yes</span><br><span class="line">Warning: Permanently added '192.168.5.102' (RSA) to the list of known hosts.</span><br><span class="line">tomxwd@192.168.5.102's password: </span><br><span class="line">Last login: Tue Oct 15 13:24:23 2019 from 192.168.5.1</span><br></pre></td></tr></table></figure>

<p>输入yes并输入密码即可</p>
</li>
</ul>
</li>
<li><p>无密钥配置</p>
<ul>
<li><p>免密登录原理：</p>
<p><img src="06_Hadoop_%E8%BF%90%E8%A1%8C%E6%A8%A1%E5%BC%8F/1571144054503.png" alt="1571144054503"></p>
</li>
<li><p>生成公钥和私钥</p>
<p>在home目录下的.ssh文件夹（隐藏文件夹）下，使用：</p>
<p>ssh-keygen -t rsa</p>
<p>然后敲三个回车，就会生成两个文件id_rsa（私钥）、id_rsa.pub（公钥）</p>
</li>
<li><p>将公钥拷贝到要免密登录的目标机器上</p>
<p>ssh-copy-id hadoop102</p>
<p>ssh-copy-id hadoop103</p>
<p>ssh-copy-id hadoop104</p>
<p>三个都要copy，包括本身；</p>
<p>在三台机器上都需要生成sshkey，并且三台都要有对方的公钥。</p>
<p><strong>注意：在hadoop102上采用root用户，配置无密登录到hadoop102，hadoop103，hadoop104，然后在hadoop103上采用tomxwd用户，配置无密登录到hadoop102，hadoop103，hadoop104上。</strong></p>
<p>原因主要是namenode以及resourcemanager需要跟各个服务器互通信息。</p>
</li>
<li><p>除了tomxwd用户外，还需要把root用户也配置ssh</p>
<p>su root 切换到root用户，重复上一步即可。(如果root目录下没有.ssh文件,就用ssh localhost来生成一次，其实就是用一次ssh即可）</p>
</li>
</ul>
</li>
<li><p>.ssh文件夹下（~/.ssh）的文件功能解释</p>
<table>
<thead>
<tr>
<th>文件名</th>
<th>功能解释</th>
</tr>
</thead>
<tbody><tr>
<td>known_hosts</td>
<td>记录ssh访问过的计算机的公钥（public key）</td>
</tr>
<tr>
<td>id_rsa</td>
<td>生成的私钥</td>
</tr>
<tr>
<td>id_rsa.pub</td>
<td>生成的公钥</td>
</tr>
<tr>
<td>authorized_keys</td>
<td>存放授权过的无密登录服务器公钥</td>
</tr>
</tbody></table>
</li>
</ol>
<h3 id="群起集群"><a href="#群起集群" class="headerlink" title="群起集群"></a>群起集群</h3><ol>
<li><p>配置slaves</p>
<p>/etc/hadoop/slaves配置文件：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hadoop102</span><br><span class="line">hadoop103</span><br><span class="line">hadoop104</span><br></pre></td></tr></table></figure>

<p><strong>注意：该文件中添加的内容结尾不允许有空格，文件中不允许有空行。</strong>里面默认的localhost一定要去掉。</p>
<p>同步所有节点配置文件：</p>
<p><code>xsync slaves</code></p>
</li>
<li><p>启动集群</p>
<ul>
<li><p>hdfs（在hadoop102上启动）</p>
<p><code>start-dfs.sh</code></p>
</li>
<li><p>yarn（在hadoop103上启动，因为resourcemanager在103上）</p>
<p><code>start-yarn.sh</code></p>
<p><strong>注意：NameNode和ResourceManager如果不是同一台机器，不能在NameNode上启动YARN，应该在ResourceManager所在的机器上启动YARN</strong></p>
</li>
</ul>
</li>
<li><p>集群基本测试</p>
<ul>
<li><p>上传文件到集群</p>
<ul>
<li><p>上传小文件</p>
<p><code>hdfs dfs -mkdir -p /user/tomxwd/input</code></p>
<p><code>hdfs dfs -put wcinput/wc.input /user/tomxwd/input</code></p>
</li>
<li><p>上传大文件</p>
<p><code>hadoop fs -put /opt/open/download/hadoop-2.9.2.tar.gz /</code></p>
</li>
</ul>
</li>
<li><p>上传文件后查看文件存放在什么位置</p>
<ul>
<li><p>查看HDFS文件存储路径    </p>
<p>/opt/open/environment/hadoop-2.9.2/data/tmp/dfs/data/current/BP-918887964-192.168.5.102-1571093054040/current/finalized/subdir0/subdir0</p>
</li>
<li><p>可以把几块文件用&gt;&gt;重定向追加到一个文件中，进行解压，发现是刚刚上传的hadoop压缩包。</p>
</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="集群启动-停止方式总结"><a href="#集群启动-停止方式总结" class="headerlink" title="集群启动/停止方式总结"></a>集群启动/停止方式总结</h3><ol>
<li><p>各个服务组件逐一启动/停止</p>
<ul>
<li><p>分别启动/停止HDFS组件</p>
<p><code>hadoop-daemon.sh start/stop namenode/datanode/secondarynamenode</code></p>
</li>
<li><p>启动/停止YARN</p>
<p><code>yarn-daemon.sh start/stop resourcemanager/nodemanager</code></p>
</li>
</ul>
</li>
<li><p>各个模块分开启动/停止（配置ssh是前提）<strong>常用</strong></p>
<ul>
<li>整体启动/停止HDFS<ul>
<li>start-dfs.sh</li>
<li>stop-dfs.sh</li>
</ul>
</li>
<li>整体启动/停止YARN<ul>
<li>start-yarn.sh</li>
<li>stop-yarn.sh</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="集群时间同步（root用户操作）"><a href="#集群时间同步（root用户操作）" class="headerlink" title="集群时间同步（root用户操作）"></a>集群时间同步（root用户操作）</h3><p>时间同步的方式：找一个机器，作为时间服务器，所有的机器与这台集群时间进行定时的同步，比如每隔十分钟同步一次时间。</p>
<p><strong>时间服务器hadoop102—-hadoop103定时去获取hadoop102时间服务器主机时间——&gt;其他服务器hadoop103</strong></p>
<ul>
<li><p>时间服务器配置：</p>
<ol>
<li><p>检查ntp是否安装</p>
<p><code>rpm -qa | grep ntp</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fontpackages-filesystem-1.41-1.1.el6.noarch</span><br><span class="line">ntp-4.2.6p5-12.el6.centos.2.x86_64</span><br><span class="line">ntpdate-4.2.6p5-12.el6.centos.2.x86_64</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改ntp配置文件</p>
<p><code>vim /etc/ntp.conf</code></p>
<ul>
<li><p>修改1：授权192.168.1.0-192.168.1.255网段上所有机器可以从这台机器上查询和同步时间</p>
<p># restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</p>
<p>改为：</p>
<p># restrict 192.168.1.0 mask 255.255.255.0 nomodify notrap</p>
<p>这里，192.168.1.0需要改成自己的网段，如192.168.5.0</p>
</li>
<li><p>修改2：集群在局域网中，不使用其他互联网上的时间</p>
<p>server 0.centos.pool.ntp.org iburst</p>
<p>server 1.centos.pool.ntp.org iburst</p>
<p>server 2.centos.pool.ntp.org iburst</p>
<p>server 3.centos.pool.ntp.org iburst</p>
<p>改为：</p>
<p># server0 .centos.pool.ntp.org iburst</p>
<p># server1 .centos.pool.ntp.org iburst</p>
<p># server2 .centos.pool.ntp.org iburst</p>
<p># server3 .centos.pool.ntp.org iburst</p>
</li>
<li><p>添加3：当该结点丢失网络连接，依然可以采用本地时间作为时间服务器为集群中的其他结点提供时间同步）</p>
<p>server 127.127.1.0</p>
<p>fudge 127.127.1.0 stratum 10</p>
</li>
</ul>
</li>
<li><p>修改/etc/sysconfig/ntpd文件</p>
<p>让硬件时间与系统时间一起同步</p>
<p><code>vim /etc/sysconfig/ntpd</code></p>
<p>增加内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SYNC_HWCLOCK=yes</span><br></pre></td></tr></table></figure>
</li>
<li><p>重新启动ntpd服务</p>
<p><code>service ntpd status</code></p>
<p>ntpd 已停</p>
<p><code>service ntpd start</code></p>
<p>ntpd 启动</p>
</li>
<li><p>设置ntpd服务开机启动</p>
<p><code>chkconfig ntpd on</code></p>
</li>
</ol>
</li>
<li><p>其他服务器配置：</p>
<ol>
<li><p>在其他服务器上配置10分钟与时间服务器同步一次</p>
<p><code>crontab -e</code></p>
<p>内容如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/10 * * * * /usr/sbin/ntpdate hadoop102</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改任意机器时间</p>
<p><code>date -s &quot;2019-10-16 21:21:21&quot;</code></p>
</li>
<li><p>十分钟后查看机器是否与时间服务器同步</p>
<p><code>date</code></p>
<p>测试的时候可以调整为1分钟看效果。</p>
</li>
</ol>
</li>
</ul>
<h2 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h2><p>jps发现没进程，但是重启提示已经开启，原因是linux根目录下/tmp目录中存在启动的进程临时文件，将集群相关进程删除，再重新启动集群。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/07/Hadoop/05_Hadoop_%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/07/Hadoop/05_Hadoop_%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/" class="post-title-link" itemprop="url">05_Hadoop_目录结构</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-07 17:19:02" itemprop="dateCreated datePublished" datetime="2019-10-07T17:19:02+08:00">2019-10-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">Hadoop</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="05-Hadoop-目录结构"><a href="#05-Hadoop-目录结构" class="headerlink" title="05_Hadoop_目录结构"></a>05_Hadoop_目录结构</h1><ul>
<li>bin<ul>
<li>存放了hadoop、hdfs、yarn等基本服务</li>
</ul>
</li>
<li>etc<ul>
<li>配置信息</li>
</ul>
</li>
<li>include<ul>
<li>头文件，c相关</li>
</ul>
</li>
<li>lib<ul>
<li>本地库</li>
</ul>
</li>
<li>sbin<ul>
<li>启动停止等命令</li>
</ul>
</li>
<li>share<ul>
<li>分享，里面有说明手册、案例等。</li>
<li>可以删掉</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/06/Linux/04_Linux_Shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/06/Linux/04_Linux_Shell/" class="post-title-link" itemprop="url">04_Linux_Shell</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-06 09:54:05" itemprop="dateCreated datePublished" datetime="2019-10-06T09:54:05+08:00">2019-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="04-Linux-Shell"><a href="#04-Linux-Shell" class="headerlink" title="04_Linux_Shell"></a>04_Linux_Shell</h1><ol>
<li>Linux运维工程师在进行服务器集群管理的时候，需要编写shell程序来进行服务器管理。</li>
<li>对于JavaEE和Python程序员来说，工作的需要，要求写一些shell脚本进行程序或服务器的维护，比如编写定时备份数据库的脚本。</li>
<li>对于大数据程序员来说，需要编写shell程序来管理集群。</li>
</ol>
<h2 id="Shell是什么"><a href="#Shell是什么" class="headerlink" title="Shell是什么"></a>Shell是什么</h2><p>Shell是一个命令行解释器，为用户提供了一个向Linux内核发送请求以便运行程序的界面系统级程序，用户可以用shell来启动、挂起、停止甚至是编写一些程序。</p>
<p><img src="04_Linux_Shell/1570327060979.png" alt="1570327060979"></p>
<h2 id="Shell脚本的执行方式"><a href="#Shell脚本的执行方式" class="headerlink" title="Shell脚本的执行方式"></a>Shell脚本的执行方式</h2><p>脚本格式要求：</p>
<ul>
<li>脚本以#!/bin/bash开头</li>
<li>脚本需要有可执行权限</li>
</ul>
<p>脚本的常用执行方式：</p>
<ol>
<li>输入脚本的绝对路径或相对路径，需要执行权限 </li>
<li>sh+脚本，不需要执行权限</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">echo "hello,world!"</span><br></pre></td></tr></table></figure>

<h2 id="Shell的变量"><a href="#Shell的变量" class="headerlink" title="Shell的变量"></a>Shell的变量</h2><h3 id="shell变量的介绍"><a href="#shell变量的介绍" class="headerlink" title="shell变量的介绍"></a>shell变量的介绍</h3><ol>
<li>Linux Shell中的变量分为，系统变量和用户自定义变量。</li>
<li>系统变量：$HOME、$PWD、$SHELL、$USER等等，比如echo $HOME；</li>
<li>显示当前shell中所有变量：set</li>
</ol>
<h3 id="shell变量的定义"><a href="#shell变量的定义" class="headerlink" title="shell变量的定义"></a>shell变量的定义</h3><p>基本语法：</p>
<ol>
<li>定义变量：变量=值</li>
<li>撤销变量：unset 变量</li>
<li>声明静态变量：readonly 变量，<strong>注意：不能unset</strong></li>
</ol>
<p>案例：</p>
<ol>
<li><p>定义变量A，撤销变量A</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A=100</span><br><span class="line">echo "A=$A"</span><br><span class="line">unset A</span><br><span class="line">echo "A=$A"</span><br></pre></td></tr></table></figure>
</li>
<li><p>声明静态变量B=2，不能unset</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">readonly B=2</span><br><span class="line">echo "B=$B"</span><br><span class="line">unset B</span><br><span class="line">echo "B=$B"</span><br></pre></td></tr></table></figure>

<p>会报错，不可以unset静态变量，但是可以继续执行。</p>
</li>
<li><p>可把变量提升为全局环境变量，供其他shell程序使用</p>
</li>
</ol>
<p>定义变量的规则：</p>
<ol>
<li>变量名称可以由字母、数字和下划线组成，但是不能以数字开头。</li>
<li>等号两侧不能有空格</li>
<li>变量名称一般习惯为大写</li>
</ol>
<p>将命令的返回值赋给变量</p>
<ol>
<li>A=`ls -la`反引号（键盘左上角），运行里面的命令，并把结果返回给变量A</li>
<li>A=$(ls -la)等价于反引号</li>
</ol>
<h3 id="设置环境变量"><a href="#设置环境变量" class="headerlink" title="设置环境变量"></a>设置环境变量</h3><p>基本语法：</p>
<ol>
<li>export 变量名=变量值：将shell变量输出为环境变量</li>
<li>source 配置文件：让修改后的配置信息立即生效</li>
<li>echo $变量名：查询环境变量的值</li>
</ol>
<p>案例：</p>
<ol>
<li>在/etc/profile文件中定义TOMCAT_HOME环境变量</li>
<li>查看环境变量TOMCAT_HOME的值</li>
<li>在另外一个shell程序中使用TOMCAT_HOME</li>
</ol>
<p>注意：在输出TOMCAT_HOME环境变量前，需要让其生效：source /etc/profile</p>
<h3 id="位置参数变量"><a href="#位置参数变量" class="headerlink" title="位置参数变量"></a>位置参数变量</h3><p>当我们执行一个shell脚本的时候，如果希望得到命令行的参数信息，就可以用到位置参数变量</p>
<p>比如：./myshell.sh 100 200，这个就是一个执行shell的命令行，可以在myshell脚本中获取到参数信息</p>
<p>基本语法：</p>
<ul>
<li>$n：n为数字，$0表示命令本身，$1-$9表示第一个到第九个参数，十以上的参数需要用大括号包含，如${10}</li>
<li>$*：这个变量代表命令行中所有的参数，<strong>$*把所有的参数看成一个整体</strong></li>
<li>$@：这个变量代表命令行中所有的参数，<strong>$@把每个参数区分对待</strong></li>
<li>$#：这个变量代表命令行中所有参数的个数</li>
</ul>
<p>案例：</p>
<p>编写一个shell脚本positionParam.sh，在脚本中获取到命令行的各个参数信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">echo $0</span><br><span class="line">echo $1</span><br><span class="line">echo $2</span><br><span class="line">echo $*</span><br><span class="line">echo $@</span><br><span class="line">echo $#</span><br></pre></td></tr></table></figure>

<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost shell]# ./positionParam.sh 100 200</span><br><span class="line">./positionParam.sh</span><br><span class="line">100</span><br><span class="line">200</span><br><span class="line">100 200</span><br><span class="line">100 200</span><br><span class="line">2</span><br></pre></td></tr></table></figure>



<h3 id="预定义变量"><a href="#预定义变量" class="headerlink" title="预定义变量"></a>预定义变量</h3><p>就是shell设计者事先定义好的变量，可以直接在shell脚本中使用</p>
<p>基本语法：</p>
<ul>
<li>$$：当前进程的进程号（PID）</li>
<li>$!：后台运行的最后一个进程的进程号（PID）</li>
<li>$?：最后一次执行的命令的返回状态，如果这个变量的值为0，证明上一个命令正确执行，如果这个变量的值部位0（具体是哪个数，由命令自己决定），则证明上一个命令执行不正确。</li>
</ul>
<p>案例：</p>
<p>&amp;以后台的方式执行</p>
<p>shell脚本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">echo "当前的进程号=$$"</span><br><span class="line">echo "后台运行myShell.sh"</span><br><span class="line">./myShell.sh &amp;</span><br><span class="line">echo "最后的进程号=$!"</span><br><span class="line">echo "执行的值是=$?"</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost shell]# ./parVar.sh </span><br><span class="line">当前的进程号=2661</span><br><span class="line">后台运行myShell.sh</span><br><span class="line">最后的进程号=2662</span><br><span class="line">执行的值是=0</span><br><span class="line">[root@localhost shell]# total 12 -rwxr--r--. 1 root root 223 Oct 5 19:58 myShell.sh -rwxr--r--. 1 root root 141 Oct 5 20:09 parVar.sh -rwxr--r--. 1 root root 60 Oct 5 20:00 positionParam.sh</span><br><span class="line"></span><br><span class="line">Sat Oct 5 20:10:52 PDT 2019</span><br><span class="line"></span><br><span class="line">date=Sat Oct  5 20:10:52 PDT 2019</span><br></pre></td></tr></table></figure>



<h2 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h2><p>基本语法：</p>
<ol>
<li>$((运算式))或$[运算式]</li>
<li>expr m + n（<strong>注意expr运算符间要有空格</strong>）</li>
<li>expr m - n</li>
<li>expr *,/,%：乘除取余</li>
</ol>
<p>案例：</p>
<ol>
<li><p>算（2+3）*4的值</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">RESULT1=$(((2+3)*4))</span><br><span class="line">echo $RESULT1</span><br><span class="line"></span><br><span class="line">RESULT2=$[(2+3)*4]</span><br><span class="line">echo $RESULT2</span><br><span class="line"></span><br><span class="line">TEMP=`expr 2 + 3`</span><br><span class="line">RESULT3=`expr $TEMP \* 4`</span><br><span class="line">echo $RESULT3</span><br></pre></td></tr></table></figure>
</li>
<li><p>求两个参数的和</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SUM=$[$1+$2]</span><br><span class="line">echo $SUM</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h2><p>基本语法：</p>
<p>[ condition ]（注意condition前后要有空格）</p>
<p>如果非空就返回true，可以用$?验证（0为false，&gt;1为false）</p>
<p>案例：</p>
<p>[ tomxwd ]：true</p>
<p>[]：false</p>
<p>[ condition ]&amp;&amp;echo OK||echo notok</p>
<p>两个整数比较：</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>=</td>
<td>字符串比较</td>
</tr>
<tr>
<td>-lt</td>
<td>小于</td>
</tr>
<tr>
<td>-le</td>
<td>小于等于</td>
</tr>
<tr>
<td>-eq</td>
<td>等于</td>
</tr>
<tr>
<td>-gt</td>
<td>大于</td>
</tr>
<tr>
<td>-ge</td>
<td>大于等于</td>
</tr>
<tr>
<td>ne</td>
<td>不等于</td>
</tr>
</tbody></table>
<p>按照文件权限进行判断</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>-r</td>
<td>有读的权限</td>
</tr>
<tr>
<td>-w</td>
<td>有写的权限</td>
</tr>
<tr>
<td>x</td>
<td>有执行的权限</td>
</tr>
</tbody></table>
<p>按照文件类型进行判断</p>
<table>
<thead>
<tr>
<th>符号</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>-f</td>
<td>文件存在并且是一个常规的文件</td>
</tr>
<tr>
<td>-e</td>
<td>文件存在</td>
</tr>
<tr>
<td>-d</td>
<td>文件存在并且是一个目录</td>
</tr>
</tbody></table>
<p>案例：</p>
<ul>
<li><p>“ok”是否等于“ok“</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [ "ok"="ok" ]</span><br><span class="line">then </span><br><span class="line">	echo "equal"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
</li>
<li><p>23是否大于等于22</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if [ 23 -gt 22 ]</span><br><span class="line">then </span><br><span class="line">	echo "&gt;"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>
</li>
<li><p>/root/install.log目录中的文件是否存在</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if [ -e /root/Desktop/shell/aaa.txt ]</span><br><span class="line">then </span><br><span class="line">	echo "存在"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h2><h3 id="if判断"><a href="#if判断" class="headerlink" title="if判断"></a>if判断</h3><p>基本语法：</p>
<p>if [ 条件判断式 ];then</p>
<p>​    程序</p>
<p>fi</p>
<p>或者</p>
<p>if [ 条件判断式 ]</p>
<p>​    then</p>
<p>​    程序</p>
<p>​    elif [ 条件判断式 ]</p>
<p>​    then</p>
<p>​    程序</p>
<p>fi</p>
<p>注意事项：</p>
<ol>
<li>[ 条件判断式 ]，中括号和条件判断式之间必须有空格</li>
<li>推荐第二种写法</li>
</ol>
<p>案例：</p>
<p>写一个shell脚本，如果输入的参数大于等于60，就输出及格了，如果小于60则不及格。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">if [ $&#123;1&#125; -ge 60 ]</span><br><span class="line">then</span><br><span class="line">        echo "及格了"</span><br><span class="line">elif [ $&#123;1&#125; -lt 60 ]</span><br><span class="line">then</span><br><span class="line">        echo "不及格"</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>



<h3 id="case语句"><a href="#case语句" class="headerlink" title="case语句"></a>case语句</h3><p>基本语法：</p>
<p>case $变量名 in</p>
<p>“值1”)</p>
<p>如果变量的值等于值1，则执行程序1</p>
<p>;;</p>
<p>“值2”)</p>
<p>如果变量的值等于值2，则执行程序2</p>
<p>;;</p>
<p>*）</p>
<p>如果变量的值不等于任意一个，则执行以下</p>
<p>;;</p>
<p>esac</p>
<p>实例：</p>
<p>命令行参数是1的时候，输出”周一”，是2的时候，输出”周二”，其他输出”other”：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">case $1 in</span><br><span class="line">"1")</span><br><span class="line">echo "周一"</span><br><span class="line">;;</span><br><span class="line">"2")</span><br><span class="line">echo "周二"</span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">echo "other"</span><br><span class="line">;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure>



<h3 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h3><p>基本语法：</p>
<ul>
<li><p>第一种：</p>
<p>for 变量 in 值1 值2 值3…</p>
<p>do</p>
<p>​    程序</p>
<p>done</p>
</li>
<li><p>第二种：</p>
<p>for(( 初始值;循环控制条件;变量变化 ))</p>
<p>do</p>
<p>​    程序</p>
<p>done</p>
</li>
</ul>
<p>实例：</p>
<ul>
<li><p>第一种：</p>
<p>打印命令行输入的参数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for i in "$@"</span><br><span class="line">do</span><br><span class="line">	echo "the num is $i"</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
</li>
<li><p>第二种：</p>
<p>从1加到100的值输出显示，这里可以看出$*和$@的区别</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">SUM=0</span><br><span class="line">for((i=1;i&lt;=100;i++))</span><br><span class="line">do</span><br><span class="line">	SUM=$[ $SUM+$i ]	</span><br><span class="line">done</span><br><span class="line">echo $SUM</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h3 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h3><p>基本语法：</p>
<p>while[ 条件判断式 ]</p>
<p>do</p>
<p>​    程序</p>
<p>done</p>
<p>案例：</p>
<p>从命令行输入一个数n，计算1+…+n的值</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">i=1</span><br><span class="line">SUM=0</span><br><span class="line">while [ $i -le $&#123;1&#125; ]</span><br><span class="line">do</span><br><span class="line">	SUM=$[$SUM+$i]</span><br><span class="line">	i=$[$i+1]</span><br><span class="line">done</span><br><span class="line">echo "sum=$SUM"</span><br></pre></td></tr></table></figure>



<h2 id="read读取控制台输入"><a href="#read读取控制台输入" class="headerlink" title="read读取控制台输入"></a>read读取控制台输入</h2><p>基本语法：</p>
<p>read（选项）（参数）</p>
<p>选项：</p>
<ul>
<li>-p：指定读取值时的提示符</li>
<li>-t：指定读取值时等待的时间（秒），如果没有在指定的时间内输入，就不等待了</li>
</ul>
<p>参数：</p>
<p>变量：指定读取值的变量名</p>
<p>案例：</p>
<ol>
<li>读取控制台输入一个num值</li>
<li>读取控制台输入一个num值，在10秒内输入</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">read -p "请输入一个数字num1=" NUM1</span><br><span class="line">echo "你输入的值是 num1=$NUM1"</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">read -t 10 -p "请输入一个数字num2=" NUM2</span><br><span class="line">echo "你输入的值是 num2=$NUM2"</span><br></pre></td></tr></table></figure>



<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>shell编程和其他编程语言一样，有系统函数，也可以自定义函数。</p>
<p>系统函数：</p>
<ul>
<li><p>basename基本语法</p>
<ul>
<li><p>功能：返回完整路径最后/的部分，常用于获取文件名</p>
<ul>
<li>basename [pathname] [suffix]</li>
<li>basename [string] [suffix]</li>
<li>basename命令会删掉所有的前缀包括最后一个/字符，然后将字符串显示出来</li>
</ul>
</li>
<li><p>选项：</p>
<ul>
<li>suffix为后缀，如果指定了suffix，basename会将pathname或string中的suffix去掉</li>
</ul>
</li>
<li><p>案例：</p>
<ul>
<li><p>请返回/home/aaa/test.txt的test.txt部分</p>
<p>直接在命令行就可以：basename /home/aaa/test.txt</p>
<p>甚至后缀都不要：basename /home/aaa/test.txt .txt</p>
</li>
</ul>
</li>
</ul>
</li>
<li><p>dirname基本语法</p>
<ul>
<li><p>功能：返回完整路径最后/的前面部分，常用于返回路径部分</p>
<ul>
<li>dirname 文件绝对路径</li>
<li>从给定的包含绝对路径的文件名中去除文件名（非目录的部分），然后返回剩下的路径（目录的部分）</li>
</ul>
</li>
<li><p>案例：</p>
<ul>
<li><p>请返回/home/aaa/test.txt中的/home/aaa</p>
<p>dirname /home/aaa/test.txt</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>自定义函数：</p>
<ul>
<li><p>基本语法</p>
<p>[ function ] funname[()]</p>
<p>{</p>
<p>​    Action;</p>
<p>​    [return int;]</p>
<p>}</p>
<p>调用直接写函数名：funname [值]</p>
</li>
<li><p>案例：</p>
<ul>
<li>计算输入的两个参数的和</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">function getSum()&#123;</span><br><span class="line">	SUM=$[$n1+$n2]</span><br><span class="line">	echo "和是=$SUM"</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">read -p "请输入第一个数n1" n1</span><br><span class="line">read -p "请输入第二个数n2" n2</span><br><span class="line"></span><br><span class="line">getSum $n1 $n2</span><br></pre></td></tr></table></figure>



</li>
</ul>
<h2 id="综合案例"><a href="#综合案例" class="headerlink" title="综合案例"></a>综合案例</h2><p>需求：</p>
<ol>
<li>每天凌晨2:10备份数据库tomxwdDB到/data/backup/db</li>
<li>备份开始和备份结束能够给出相应的提示信息</li>
<li>备份后的文件要求以备份时间为文件名，并打包成.tar.gz的形式，比如：2019-10-6_230201.tar.gz</li>
<li>在备份的同时，检查是否有10天前备份的数据库文件，如果有就将其删除</li>
</ol>
<p>思路：</p>
<p><img src="04_Linux_Shell/1570352215653.png" alt="1570352215653"></p>
<p>shell脚本内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 完成数据库的定时备份</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 备份的路径</span></span><br><span class="line">BACKUP=/data/backup/db</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">当前的时间作为文件名</span></span><br><span class="line">DATETIME=$(date +%Y_%m_%d_%H%M%S)</span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以输出变量调试</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> <span class="built_in">echo</span> <span class="variable">$DATETIME</span></span></span><br><span class="line"></span><br><span class="line">echo "============开始备份============"</span><br><span class="line">echo "============备份的路径是$BACKUP/$DATETIME.tar.gz"</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 主机</span></span><br><span class="line">HOST=localhost</span><br><span class="line"><span class="meta">#</span><span class="bash"> 用户名</span></span><br><span class="line">DB_USER=root</span><br><span class="line"><span class="meta">#</span><span class="bash"> 密码</span></span><br><span class="line">DB_PWD=tomxwd</span><br><span class="line"><span class="meta">#</span><span class="bash"> 需要备份的数据库名</span></span><br><span class="line">DATABASE=tomxwdDB</span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建备份的路径</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果备份的目录不存在，则创建</span></span><br><span class="line">[ ! -d "$BACKUP/$DATETIME" ] &amp;&amp; mkdir -p "$BACKUP/$DATETIME"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 执行mysql的备份数据库指令 这里是临时目录</span></span><br><span class="line">mysqldump -u$&#123;DB_USER&#125; -p$&#123;DB_PWD&#125; --host=$&#123;HOST&#125; $DATABASE | gzip &gt; $BACKUP/$DATETIME/$DATETIME.sql.gz</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 打包备份文件</span></span><br><span class="line">cd $BACKUP</span><br><span class="line">tar -zcvf $DATETIME.tar.gz $DATETIME</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除临时目录</span></span><br><span class="line">rm -rf $BACKUP/$DATETIME</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除十天前的备份文件</span></span><br><span class="line">find $BACKUP -mtime +10 -name "*.tar.gz" -exec rm -rf &#123;&#125; \;</span><br><span class="line"></span><br><span class="line">echo "=============备份文件成功============="</span><br></pre></td></tr></table></figure>

<p>最后需要放到crond中：</p>
<p>crontab -e</p>
<p>内容：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10 2 * * * /usr/sbin/mysql_db_backup.sh</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/05/Linux/03_Linux_JavaEE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/05/Linux/03_Linux_JavaEE/" class="post-title-link" itemprop="url">03_Linux_JavaEE</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-05 20:37:38" itemprop="dateCreated datePublished" datetime="2019-10-05T20:37:38+08:00">2019-10-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="03-Linux-JavaEE"><a href="#03-Linux-JavaEE" class="headerlink" title="03_Linux_JavaEE"></a>03_Linux_JavaEE</h1><h2 id="安装JDK"><a href="#安装JDK" class="headerlink" title="安装JDK"></a>安装JDK</h2><blockquote>
<p><a href="https://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" target="_blank" rel="noopener">下载地址</a></p>
<p>需要账号密码，百度一下就有</p>
<p>下载-x64.tar.gz版本</p>
</blockquote>
<ol>
<li><p>传jdk到/opt/open/download目录下</p>
</li>
<li><p>解压到/opt/open/environment/jdk/目录下</p>
<ul>
<li><p>注意，如果是解压到指定目录，要加上-C参数</p>
</li>
<li><p>tar -zxvf jdk-8u221-linux-x64.tar.gz -C /opt/open/environment/jdk/</p>
</li>
</ul>
</li>
<li><p>配置环境变量配置文件：vim /etc/profile</p>
</li>
<li><p>JAVA_HOME=/opt/open/environment/jdk/jdk1.8.0_221</p>
</li>
<li><p>PATH=/opt/open/environment/jdk/jdk1.8.0_221/bin:$PATH</p>
</li>
<li><p>export JAVA_HOME PATH</p>
</li>
<li><p>直接生效：source /etc/profile，如果不这样就注销用户再进入</p>
</li>
<li><p>测试是否可用，先用java -version，再编写一个HelloWorld编译后运行试试。</p>
</li>
</ol>
<h2 id="安装tomcat"><a href="#安装tomcat" class="headerlink" title="安装tomcat"></a>安装tomcat</h2><blockquote>
<p><a href="https://tomcat.apache.org/download-80.cgi" target="_blank" rel="noopener">tomcat8下载地址</a></p>
</blockquote>
<ol>
<li><p>放到/opt/open/download目录下</p>
</li>
<li><p>解压到/opt/open/service/tomcat/目录下</p>
<ul>
<li>tar -zxvf apache-tomcat-8.5.46.tar.gz -C /opt/open/service/tomcat/</li>
</ul>
</li>
<li><p>启动tomcat ./startup.sh</p>
</li>
<li><p>开放端口vim /etc/sysconfig/iptables</p>
<ul>
<li><p>复制22端口的形式，改成8080即可</p>
</li>
<li><p>-A INPUT -m state –state NEW -m tcp -p tcp –dport 8080 -j ACCEPT</p>
</li>
</ul>
</li>
<li><p>重启防火墙</p>
<ul>
<li>service iptables restart</li>
</ul>
</li>
<li><p>测试windows是否可以访问到linux上的tomcat服务器</p>
</li>
</ol>
<h2 id="安装eclipse"><a href="#安装eclipse" class="headerlink" title="安装eclipse"></a>安装eclipse</h2><ol>
<li>放到/opt/download目录下</li>
<li>解压到/opt/soft/eclipse目录下</li>
<li>启动eclipse，配置jre和server</li>
<li>编写HelloWorld程序并测试</li>
<li>编写jsp页面并测试</li>
</ol>
<h2 id="安装mysql5-6-44"><a href="#安装mysql5-6-44" class="headerlink" title="安装mysql5.6.44"></a>安装mysql5.6.44</h2><blockquote>
<p><a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener">mysql官方下载地址</a></p>
<p><a href="https://blog.csdn.net/hwh1231/article/details/71426844" target="_blank" rel="noopener">网上步骤</a></p>
<p>记得要下载<strong>Source Code</strong>版本的mysql，因为这里是源码安装</p>
</blockquote>
<ol>
<li><p>先卸载：</p>
<p>rpm -qa|grep mysql</p>
<p>如果有查到，就直接删除：</p>
<ul>
<li>rpm -e mysql：普通删除</li>
<li>rpm -e –nodeps mysql ：强制删除，如果上面的命令提示有依赖，可以用这个命令进行强制删除</li>
</ul>
</li>
<li><p>安装编译代码需要的包</p>
<ul>
<li>yum -y install make gcc-c++ cmake bison-devel ncurses-devel</li>
</ul>
</li>
<li><p>下载MySQL5.6.44</p>
</li>
<li><p>解压</p>
<ul>
<li>tar -zxvf mysql-5.6.44.tar.gz</li>
</ul>
</li>
<li><p>进入到mysql-5.6目录</p>
</li>
<li><p>编译安装</p>
<ul>
<li><pre><code class="shell">cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql -DMYSQL_DATADIR=/usr/local/mysql/data -DSYSCONFDIR=/etc -DWITH_MYISAM_STORAGE_ENGINE=1 -DWITH_INNOBASE_STORAGE_ENGINE=1 -DWITH_MEMORY_STORAGE_ENGINE=1 -DWITH_READLINE=1 -DMYSQL_UNIX_ADDR=/var/lib/mysql/mysql.sock -DMYSQL_TCP_PORT=3306 -DENABLED_LOCAL_INFILE=1 -DWITH_PARTITION_STORAGE_ENHINE=1 -DEXTRA_CHARSETS=all -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">  </span><br><span class="line">- ```shell</span><br><span class="line">  cmake . -DCMAKE_INSTALL_PREFIX=/data/mysql/installdir \</span><br><span class="line">  -DDEFAULT_CHARSET=utf8 \</span><br><span class="line">  -DDEFAULT_COLLATION=utf8_general_ci \</span><br><span class="line">  -DENABLED_LOCAL_INFILE=ON \</span><br><span class="line">  -DWITH_INNOBASE_STORAGE_ENGINE=1 \</span><br><span class="line"> -DWITH_FEDERATED_STORAGE_ENGINE=1 \</span><br><span class="line">  -DWITH_BLACKHOLE_STORAGE_ENGINE=1 \</span><br><span class="line">  -DWITHOUT_EXAMPLE_STORAGE_ENGINE=1 \</span><br><span class="line">  -DWITH_PARTITION_STORAGE_ENGINE=1 \</span><br><span class="line">  -DWITH_PERFSCHEMA_STORAGE_ENGINE=1 \</span><br><span class="line">  -DCOMPILATION_COMMENT=&apos;MySQL&apos; \</span><br><span class="line">  -DWITH_READLINE=ON \</span><br><span class="line">  -DWITH_BOOST=/data/mysql/src/mysql-5.7.18/boost \</span><br><span class="line">  -DSYSCONFDIR=/data/mysql/datadir/3306/data \</span><br><span class="line">  -DMYSQL_UNIX_ADDR=/data/mysql/datadir/3306/data/mysql.sock</span><br></pre></td></tr></table></figure></code></pre>
</li>
<li><p>make &amp;&amp; make install</p>
</li>
</ul>
</li>
<li><p>配置MySQL</p>
<ul>
<li>设置权限<ul>
<li>查看是否有mysql用户和mysql组<ul>
<li>cat /etc/passwd：查看用户列表</li>
<li>cat /etc/group：查看用户组列表</li>
</ul>
</li>
<li>无则创建：<ul>
<li>groupadd mysql</li>
<li>useradd -g mysql mysql</li>
</ul>
</li>
<li>修改/usr/local/mysql权限<ul>
<li>chown -R mysql:mysql /user/local/mysql（-R表示递归修改权限）</li>
</ul>
</li>
</ul>
</li>
<li>初始化配置，进入安装路径（再执行下面的指令），执行初始化配置脚本，创建系统自带的数据库和表<ul>
<li>cd /usr/local/mysql</li>
<li>scripts/mysql_install_db –basedir=/usr/local/mysql –datadir=/usr/local/mysql/data –user=mysql</li>
</ul>
</li>
<li><strong>注意：</strong><ul>
<li><strong>在启动MySQL服务的时候，会按照一定次序搜查my.cnf配置文件，先在/etc目录下找，找不到就会搜索”$basedir/my.cnf”，这里就是/usr/local/mysql/my.cnf，这是最新版MySQL的配置文件的默认位置！</strong></li>
<li><strong>在CentOS6.8版本操作系统的最小安装完成后，会在/etc目录下有个my.cnf，需要吧这个文件改名，如/etc/my.cnf.bak，否则该文件会干扰源码安装的MySQL正确配置，造成无法启动</strong></li>
</ul>
</li>
</ul>
</li>
<li><p>启动MySQL</p>
<ul>
<li>添加服务，拷贝服务脚本到init.d目录，并设置为开机启动<ul>
<li>cd到/usr/local/mysql路径下</li>
<li>cp support-files/mysql.server /etc/init.d/mysql（复制服务到/etc/init.d/mysql目录）</li>
<li>chkconfig mysql on（设置为开机启动）</li>
<li>service mysql start（启动MySQL）<ul>
<li>如果不能启动，查看日志，可能是因为/var/lib/mysql没有给mysql用户权限</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>修改root密码</p>
<ul>
<li>cd /usr/local/mysql/bin</li>
<li>./mysql -uroot -p</li>
<li>mysql &gt; SET PASSWORD = PASSWORD(‘root’);</li>
</ul>
</li>
<li><p>可以把bin放到环境变量里头去（vim /etc/profile）</p>
<ul>
<li>PATH=/usr/local/mysql/bin:/…..:$PATH</li>
<li>source /etc/profile</li>
</ul>
</li>
<li><p>记得要开放防火墙：</p>
<ul>
<li>/etc/sysconfig/iptables</li>
<li>service iptables restart</li>
</ul>
</li>
<li><p>navicat远程连接可能失败</p>
<ul>
<li>可以进入命令行后，update user set host=’%’ where user = ‘root’;</li>
<li>然后flush  privileges;</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/03/Linux/02_%E5%AE%9E%E6%93%8DLinux/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/03/Linux/02_%E5%AE%9E%E6%93%8DLinux/" class="post-title-link" itemprop="url">02_实操Linux</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-03 10:13:38" itemprop="dateCreated datePublished" datetime="2019-10-03T10:13:38+08:00">2019-10-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="02-实操Linux"><a href="#02-实操Linux" class="headerlink" title="02_实操Linux"></a>02_实操Linux</h1><h2 id="开启允许远程连接"><a href="#开启允许远程连接" class="headerlink" title="开启允许远程连接"></a>开启允许远程连接</h2><p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570068962037.png" alt="1570068962037"></p>
<p>Xshell和Xftp：</p>
<ul>
<li>Xshell：远程登录操作Linux</li>
<li>Xftp：上传下载文件</li>
</ul>
<p><strong>前提：</strong>Linux开启了sshd服务，开22端口。</p>
<p>用setup指令，然后进入系统服务(system service)，找到sshd，看看是否开启。</p>
<h2 id="vi和vim编辑器"><a href="#vi和vim编辑器" class="headerlink" title="vi和vim编辑器"></a>vi和vim编辑器</h2><p>所有的Linux系统都会内建vi文本编辑器。</p>
<p>Vim则是具有程序编辑的能力，可以看做是vi的增强版本，可以主动的以字体颜色辨别语法的正确性，方便程序设计。代码补完、编译及错误跳转等方便编程的功能特别丰富，在程序员中广泛使用。</p>
<h3 id="vi和vim常用的三种模式"><a href="#vi和vim常用的三种模式" class="headerlink" title="vi和vim常用的三种模式"></a>vi和vim常用的三种模式</h3><p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570070972848.png" alt="1570070972848"></p>
<ul>
<li>正常模式：在vim打开一个档案就直接进入一般模式了，在这个模式下，可以使用上下左右来移动光标，可以用删除复制等操作。</li>
<li>插入模式：按下i，l，o，O，a，A，r，R等任何一个字母之后才可以进入编辑模式，一般来说i即可</li>
<li>命令行模式：这个模式中，可以提供你相关的指令，完成读取、存盘、替换、离开vim、显示行号等。</li>
</ul>
<h3 id="vi和vim快捷键"><a href="#vi和vim快捷键" class="headerlink" title="vi和vim快捷键"></a>vi和vim快捷键</h3><ol>
<li>拷贝当前行 yy，拷贝当前行向下的5行 5yy</li>
<li>删除当前行 dd，删除当前行向下的5行 5dd</li>
<li>在文件中查找某个单词，命令行模式下/关键字，n就是下一个</li>
<li>设置文件行号，取消文件行号:set nu和:set nonu</li>
<li>文档最末行 G 和 最首行 gg</li>
<li>撤销动作指令 u</li>
<li>移动到指定行 shift+g </li>
</ol>
<h2 id="关机-amp-重启命令"><a href="#关机-amp-重启命令" class="headerlink" title="关机&amp;重启命令"></a>关机&amp;重启命令</h2><ul>
<li>shutdown：<ul>
<li>shutdown -h now：立即关机</li>
<li>shutdown -h 1：1分钟后关机</li>
<li>shutdown -r now：现在重启</li>
</ul>
</li>
<li>halt：关机，其他如上</li>
<li>reboot：现在重启</li>
<li>sync：把内存中的数据同步到磁盘</li>
</ul>
<p><strong>注意：</strong>无论是重启还是关闭系统，都要先运行sync命令，把内存中的数据写入到磁盘中</p>
<h2 id="用户登录和注销"><a href="#用户登录和注销" class="headerlink" title="用户登录和注销"></a>用户登录和注销</h2><h3 id="基本介绍"><a href="#基本介绍" class="headerlink" title="基本介绍"></a>基本介绍</h3><ol>
<li>登录尽量少用root账号登录，因为他是系统管理员，最大的权限，避免操作失误。</li>
<li>可以用普通用户登录，登录后再用su 用户名 命令来切换管理员身份</li>
<li>在提示符下输入logout即可注销用户</li>
</ol>
<h3 id="使用细节"><a href="#使用细节" class="headerlink" title="使用细节"></a>使用细节</h3><ol>
<li>logout注销指令在图形运行级别无效，在运行级别3下有效</li>
<li>运行级别</li>
</ol>
<h2 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h2><h3 id="基本介绍-1"><a href="#基本介绍-1" class="headerlink" title="基本介绍"></a>基本介绍</h3><p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570076370680.png" alt="1570076370680"></p>
<h3 id="添加用户"><a href="#添加用户" class="headerlink" title="添加用户"></a>添加用户</h3><p>基本语法：</p>
<p>useradd 用户名</p>
<p>细节说明：</p>
<ol>
<li>默认：当创建用户成功后，会自动的创建和用户同名的家目录</li>
<li>也可以通过useradd -d 指定目录 新的用户，给新创建的用户指定家目录</li>
</ol>
<h3 id="指定-修改密码"><a href="#指定-修改密码" class="headerlink" title="指定/修改密码"></a>指定/修改密码</h3><p>基本语法：</p>
<p>passwd 用户名</p>
<h3 id="删除用户"><a href="#删除用户" class="headerlink" title="删除用户"></a>删除用户</h3><p>基本语法：</p>
<p>userdel 用户名</p>
<p>细节说明：</p>
<ol>
<li>删除用户，默认保留家目录</li>
<li>删除用户，以及删除家目录，加-r参数</li>
</ol>
<p>一般不会删除家目录</p>
<h3 id="查询、切换用户"><a href="#查询、切换用户" class="headerlink" title="查询、切换用户"></a>查询、切换用户</h3><h4 id="查询用户信息"><a href="#查询用户信息" class="headerlink" title="查询用户信息"></a>查询用户信息</h4><p>基本语法：</p>
<p>id 用户名</p>
<p>细节说明：</p>
<p>当用户不存在，返回无此用户</p>
<h4 id="切换用户"><a href="#切换用户" class="headerlink" title="切换用户"></a>切换用户</h4><p>基本语法：</p>
<p>su - 切换用户名</p>
<p>细节说明：</p>
<ol>
<li><p>高权限用户切换到低权限用户不需要输入密码</p>
</li>
<li><p>用exit可以退回到原来的用户</p>
</li>
</ol>
<h4 id="查看当前用户-登录用户"><a href="#查看当前用户-登录用户" class="headerlink" title="查看当前用户/登录用户"></a>查看当前用户/登录用户</h4><p>基本语法：</p>
<p>whoami/who am i</p>
<h3 id="用户组"><a href="#用户组" class="headerlink" title="用户组"></a>用户组</h3><p>基本语法：</p>
<p>添加组：groupadd 组名</p>
<p>删除组：groupdel 组名</p>
<p>增加用户的时候直接加上组：useradd -g 用户组 用户名</p>
<p>修改用户组：usermod -g 用户组 用户名</p>
<h3 id="用户和组的相关文件"><a href="#用户和组的相关文件" class="headerlink" title="用户和组的相关文件"></a>用户和组的相关文件</h3><table>
<thead>
<tr>
<th>文件目录</th>
<th>作用</th>
<th>每行的含义</th>
</tr>
</thead>
<tbody><tr>
<td>/etc/passwd文件</td>
<td>用户(user)的配置文件，记录用户的各种信息</td>
<td>用户名：口令：用户标识号：组标识号：注释性描述：主目录：登录Shell</td>
</tr>
<tr>
<td>/etc/shadow文件</td>
<td>口令的配置文件</td>
<td>登录名：加密口令：最后一次修改时间：最小时间间隔：最大时间间隔：警告时间：不活动时间：失效时间：标志</td>
</tr>
<tr>
<td>/etc/group文件</td>
<td>组(group)的配置文件，记录Linux包含的组的信息</td>
<td>组名：口令：组标识符：组内用户列表</td>
</tr>
</tbody></table>
<h2 id="实用指令"><a href="#实用指令" class="headerlink" title="实用指令"></a>实用指令</h2><h3 id="指定运行级别"><a href="#指定运行级别" class="headerlink" title="指定运行级别"></a>指定运行级别</h3><p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570081723032.png" alt="1570081723032"></p>
<p>基本介绍：</p>
<p>0：关机</p>
<p>1：单用户【找回丢失密码】</p>
<ul>
<li>进入到单用户模式，然后修改root密码，因为进入到单用户模式，root不需要密码就可以登录</li>
<li>用enter进入到选择引导界面，然后输入e，进第二个选项kernel，再输入一个e，空格 1，这个1就是让我们进入到单用户模式，再输入b去引导</li>
<li>接下来就是进入系统，然后用passwd root修改密码即可<ul>
<li>有个前提，接触到机房的服务器，而不是通过远程连接</li>
</ul>
</li>
</ul>
<p>2：多用户状态没有网络服务</p>
<p><strong>3：多用户状态有网络服务</strong></p>
<p>4：系统未使用保留给用户</p>
<p>5：图形界面</p>
<p>6：系统重启</p>
<p>常用运行级别是3和5，要修改默认的运行级别可改文件/etc/inittab的id:5:initdefault:这一行中的数字</p>
<p>CentOS7是在/lib/systemd/system文件中，命令为systemctl set-default runlevel3.target，改数字即可。</p>
<p><strong>切换到指定运行级别的指令：</strong>init[0123456]</p>
<h3 id="帮助指令"><a href="#帮助指令" class="headerlink" title="帮助指令"></a>帮助指令</h3><ul>
<li>man获得帮助信息：<ul>
<li>基本语法：man[命令或配置文件]（功能描述：获得帮助信息）</li>
<li>案例：查看ls命令的帮助信息，man ls</li>
</ul>
</li>
<li>help指令<ul>
<li>基本语法：help 命令（功能描述：获得shell内置命令的帮助信息）</li>
<li>案例：查看cd命令的帮助信息，help cd</li>
</ul>
</li>
<li>直接百度即可。</li>
</ul>
<h3 id="文件目录类"><a href="#文件目录类" class="headerlink" title="文件目录类"></a>文件目录类</h3><ul>
<li><p>pwd指令：</p>
<ul>
<li>基本语法：pwd（显示当前工作目录的绝对路径）</li>
</ul>
</li>
<li><p>ls指令：</p>
<ul>
<li>基本语法：ls[选项][目录或是文件]</li>
<li>常用选项：<ul>
<li>-a：显示当前目录所有的文件和目录，包括隐藏的</li>
<li>-l：以列表的方式显示信息</li>
<li>-h：人容易阅读的格式</li>
</ul>
</li>
</ul>
</li>
<li><p>cd指令：</p>
<ul>
<li>基本语法：cd[参数]（切换到指定目录）</li>
<li>常用参数：<ul>
<li>cd~或者cd回到自己的家目录</li>
<li>cd..回到上一级目录</li>
</ul>
</li>
</ul>
</li>
<li><p>mkdir指令：</p>
<ul>
<li>基本语法：mkdir[选项]要创建的目录</li>
<li>常用参数：<ul>
<li>-p：创建多级目录</li>
</ul>
</li>
</ul>
</li>
<li><p>rmdir指令</p>
<ul>
<li>基本语法：rmdir[选项]要删除的空目录</li>
<li>注意：<ul>
<li>rmdir删除的是空目录，如果有内容是无法被删除的，如果要删除有目录的目录，需要用rm -rf 要删除的目录</li>
</ul>
</li>
</ul>
</li>
<li><p>touch指令</p>
<ul>
<li>基本语法：touch 文件名称（创建文件，可以一次性创建多个）</li>
</ul>
</li>
<li><p><strong>cp指令</strong></p>
<ul>
<li>基本语法：cp[选项] source dest</li>
<li>常用选项：<ul>
<li>-r：递归复制整个文件夹</li>
</ul>
</li>
<li>用\cp可以强制覆盖，不需要每次都y</li>
</ul>
</li>
<li><p>rm指令</p>
<p>rm指令移除文件或目录</p>
<ul>
<li>基本语法：rm[选项] 要删除的文件或目录</li>
<li>常用选项：<ul>
<li>-r：递归删除整个文件夹</li>
<li>-f：强制删除不提示</li>
</ul>
</li>
<li>用-f参数可以强制删除不提示</li>
</ul>
</li>
<li><p>mv指令</p>
<p>mv<strong>移动文件</strong>与目录或<strong>重命名</strong></p>
<ul>
<li>基本语法：<ul>
<li>mv oldNameFile newNameFile（重命名）</li>
<li>mv /temp/movefile /targetFolder（移动文件）</li>
</ul>
</li>
</ul>
</li>
<li><p>cat指令</p>
<p>cat查看文件内容</p>
<ul>
<li>基本语法：cat[选项]要查看的文件</li>
<li>常用选项：<ul>
<li>-n：显示行号</li>
</ul>
</li>
<li>使用细节：<ul>
<li>cat只能浏览文件，而不能修改文件，为了浏览方便，一般会带上<strong>管道命令|more</strong>，分页显示</li>
</ul>
</li>
</ul>
</li>
<li><p>more指令</p>
<p>more指令是一个基于VI编辑器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容。</p>
<ul>
<li>基本语法：more 要查看的文件</li>
<li>操作说明：<ul>
<li>空白键：向下翻动一页</li>
<li>Enter：向下翻动一行</li>
<li>q：立即离开more，不再显示文件内容</li>
<li>Ctrl+F：向下滚动一屏</li>
<li>Ctrl+B：返回上一屏</li>
<li>=：输出当前行的行号</li>
<li>:f：输出文件名和当前行的行号</li>
</ul>
</li>
</ul>
</li>
<li><p>less指令</p>
<p>less指令用来分屏查看文件内容，它的功能与more指令类似，但是比more指令更加强大，支持各种显示终端。</p>
<p>less指令在显示文件内容时，并不是一次将整个文件加载之后才显示的，而是根据显示需要加载内容，对于显示大型文件具有较高的效率</p>
<ul>
<li>基本语法：less 要查看的文件</li>
<li>操作说明：<ul>
<li>空白键：向下翻动一页</li>
<li>pagedown：向下翻动一页</li>
<li>pageup：向上翻动一页</li>
<li>/字符串：向下搜寻【字符串】的功能；n：向下查找； N：向上查找</li>
<li>?字符串：向上搜寻【字符串】的功能；n：向上查找； N：向下查找</li>
<li>q：离开less这个程序</li>
</ul>
</li>
</ul>
</li>
<li><p>重定向和追加（&gt;指令和&gt;&gt;指令）</p>
<p>&gt;输出重定向</p>
<p>&gt;&gt;追加</p>
<ul>
<li><p>基本语法：</p>
<table>
<thead>
<tr>
<th>指令</th>
<th>功能描述</th>
</tr>
</thead>
<tbody><tr>
<td>ls -l &gt; 文件</td>
<td>列表的内容写入文件a.txt中（覆盖写）</td>
</tr>
<tr>
<td>ls -al &gt;&gt; 文件</td>
<td>列表的内容追加到文件aa.txt的末尾</td>
</tr>
<tr>
<td>cat 文件1 &gt; 文件2</td>
<td>将文件1的内容覆盖到文件2</td>
</tr>
<tr>
<td>echo “内容” &gt;&gt; 文件</td>
<td></td>
</tr>
</tbody></table>
</li>
<li><p>主要就是&gt;和&gt;&gt;，用来写东西到文件中</p>
</li>
</ul>
</li>
<li><p>echo指令</p>
<p>echo输出内容到控制台</p>
<ul>
<li>基本语法<ul>
<li>echo [选项][输出内容]</li>
</ul>
</li>
<li>实例：输出当前环境变量：echo $PATH</li>
</ul>
</li>
<li><p>head指令</p>
<p>head用于显示文件的开头部分内容，默认情况下head指令显示文件的前10行内容</p>
<ul>
<li>基本语法<ul>
<li>head 文件 （查看文件头10行内容）</li>
<li>head -n 5文件 （查看文件头5行内容，5可以是任意数字）</li>
</ul>
</li>
</ul>
</li>
<li><p>tail指令</p>
<p>tail用于输出文件中尾部的内容，默认情况下tail指令显示文件的后10行内容</p>
<ul>
<li>基本语法：<ul>
<li>tail文件（查看文件的后10行内容）</li>
<li>tail -n 5 文件（查看文件的后5行内容，5可以是任意数字）</li>
<li><strong>tail -f 文件（实时追踪该文档的所有修改）</strong></li>
</ul>
</li>
</ul>
</li>
<li><p>ln指令</p>
<p>软链接也叫符号链接，类似于windows里的快捷方式，主要存放了链接其他文件的路径</p>
<ul>
<li>基本语法：<ul>
<li>ln -s[原文件或目录][软链接名]（给原文件创建一个软链接）</li>
</ul>
</li>
<li>细节说明：<ul>
<li>当我们使用pwd指令查看目录时，仍然看到的是软链接所在的目录。</li>
</ul>
</li>
</ul>
</li>
<li><p>history指令</p>
<p>查看已经执行过的历史命令，也可以执行历史指令</p>
<ul>
<li>基本语法：<ul>
<li>history：查看已经执行过的历史命令</li>
<li>history 10：查看最近10条历史命令</li>
<li>! 5 ：执行历史编号为5的历史命令，这里5可以是任意history中的编号</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="时间日期类"><a href="#时间日期类" class="headerlink" title="时间日期类"></a>时间日期类</h3><ul>
<li><p>date指令</p>
<p>date指令显示当前日期</p>
<ul>
<li>基本语法<ul>
<li>date：显示当前时间</li>
<li>date +%Y：显示当前年份</li>
<li>date +%m：显示当前月份</li>
<li>date +%d：显示当前是哪一天</li>
<li>date “+%Y-%m-%d %H:%M:%S”：显示年月日时分秒</li>
</ul>
</li>
</ul>
</li>
<li><p>date指令-设置日期</p>
<ul>
<li>基本语法<ul>
<li>date -s 字符串时间</li>
</ul>
</li>
<li>实例：<ul>
<li>设置系统当前时间，比如date -s “2019-11-11 11:22:22”</li>
</ul>
</li>
</ul>
</li>
<li><p>cal指令</p>
<p>查看日历指令</p>
<ul>
<li>基本语法<ul>
<li>cal[选项] 不加选项，显示本月日历</li>
<li>cal 2020 则是2020年的日历</li>
<li>cal 12 2020 则是2020年12月的日历</li>
<li>cal 8 12 2020 则是2020年12月8日的日历</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="搜索查找类"><a href="#搜索查找类" class="headerlink" title="搜索查找类"></a>搜索查找类</h3><ul>
<li><p>find指令</p>
<p>find指令将从指令目录向下递归遍历其各个子目录，将满足条件的文件或者目录显示在终端</p>
<ul>
<li><p>基本语法：</p>
</li>
<li><p>find[搜索范围][选项]</p>
</li>
<li><p>选项说明：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-name&lt;查询方式&gt;</td>
<td>按照指定的文件名查找模式查找文件</td>
</tr>
<tr>
<td>-user&lt;用户名&gt;</td>
<td>查找属于指定用户名所有文件</td>
</tr>
<tr>
<td>-size&lt;文件大小&gt;</td>
<td>按照指定的文件大小查找文件，+n大于，-n小于，n等于，文件大小单位（k，M…）</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>locate指令</p>
<p>locate指令可以快速定位文件路径。</p>
<p>locate指令利用事先建立的系统中所有文件名称及路径的locate数据库实现快速定位给定的文件。</p>
<p>locate指令无需遍历整个文件系统，查询速度较快，为了保证查询结果的准确度，管理员必须定期更新locate时刻。</p>
<ul>
<li>基本语法<ul>
<li>locate 搜索文件</li>
</ul>
</li>
<li>特别说明<ul>
<li>由于locate指令基于数据库进行查询，所以第一次运行前，必须使用updatedb指令创建locate数据库</li>
</ul>
</li>
</ul>
</li>
<li><p>grep指令和管道符号|</p>
<p>grep过滤查找</p>
<p>|管道符号，表示将前一个命令的处理结果输出传递给后面的命令处理</p>
<ul>
<li><p>基本语法</p>
<ul>
<li>grep [选项] 查找内容 源文件</li>
</ul>
</li>
<li><p>常用选项</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-n</td>
<td>显示匹配行及行号</td>
</tr>
<tr>
<td>-i</td>
<td>忽略字母大小写</td>
</tr>
</tbody></table>
</li>
<li><p>例子</p>
<ul>
<li>cat a.txt | grep -n hello</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="压缩和解压类"><a href="#压缩和解压类" class="headerlink" title="压缩和解压类"></a>压缩和解压类</h3><ul>
<li><p>gzip/gunzip指令</p>
<ul>
<li>基本语法<ul>
<li>gzip 文件（压缩文件，只能将文件压缩为<em>.gz文件*</em>不保留源文件**）</li>
<li>gunzip 文件.gz（解压文件）</li>
</ul>
</li>
</ul>
</li>
<li><p>zip/unzip指令</p>
<ul>
<li>基本语法<ul>
<li>zip [选项] XXX.zip 将要压缩的内容（压缩文件和目录的命令）</li>
<li>unzip [选项] XXX.zip （解压文件）</li>
</ul>
</li>
<li>zip常用选项<ul>
<li>-r：递归压缩，即压缩目录</li>
</ul>
</li>
<li>unzip常用选项<ul>
<li>-d &lt;目录&gt; ：指定解压后文件的存放目录</li>
</ul>
</li>
</ul>
</li>
<li><p>tar指令</p>
<ul>
<li><p>基本语法</p>
<ul>
<li>tar [选项] XXX.tar.gz 打包的内容（打包目录，压缩后的文件格式为.tar.gz）</li>
</ul>
</li>
<li><p>选项说明：</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-c</td>
<td>产生.tar打包文件</td>
</tr>
<tr>
<td>-v</td>
<td>显示详细信息</td>
</tr>
<tr>
<td>-f</td>
<td>指定压缩后的文件名</td>
</tr>
<tr>
<td>-z</td>
<td>打包同时压缩</td>
</tr>
<tr>
<td>-x</td>
<td>解包.tar文件</td>
</tr>
</tbody></table>
</li>
<li><p>实例：</p>
<ul>
<li>把多个文件打包为a.tar.gz：tar -zcvf a.tar.gz a1.txt a2.txt</li>
<li>将a.tar.gz解压到指定目录：tar -zxvf a.tar.gz <strong>-C</strong> /opt/tmp</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="组管理和权限管理（重点）"><a href="#组管理和权限管理（重点）" class="headerlink" title="组管理和权限管理（重点）"></a>组管理和权限管理（重点）</h2><p>用户配置文件：/etc/passwd</p>
<p>密码登录信息：/etc/shadow</p>
<p>组配置文件：/etc/group</p>
<p>linux每个用户必须属于一个组，不能独立于组外。</p>
<ol>
<li>所有者</li>
<li>所在组</li>
<li>其他组</li>
<li>改变用户所在的组</li>
</ol>
<h3 id="文件-目录所有者"><a href="#文件-目录所有者" class="headerlink" title="文件/目录所有者"></a>文件/目录所有者</h3><p>一般为文件的创建者，谁创建了该文件，就自然成为该文件的所有者</p>
<ul>
<li>查看文件的所有者：ls -ahl</li>
<li>修改文件的所有者：chown 用户名 文件名</li>
</ul>
<h3 id="组的创建"><a href="#组的创建" class="headerlink" title="组的创建"></a>组的创建</h3><p>groupadd 组名</p>
<p>创建完后可以用useradd -g 组名 用户名来新建组的用户</p>
<h3 id="文件-目录所在组"><a href="#文件-目录所在组" class="headerlink" title="文件/目录所在组"></a>文件/目录所在组</h3><ul>
<li>查看文件的所在组：ls -ahl</li>
<li>修改文件的所在组：chgrp 组名 文件名</li>
</ul>
<h3 id="其他组"><a href="#其他组" class="headerlink" title="其他组"></a>其他组</h3><p>除文件的所有者和所在组的用户外，系统的其他用户都是文件的其他组。</p>
<h3 id="改变用户所在组"><a href="#改变用户所在组" class="headerlink" title="改变用户所在组"></a>改变用户所在组</h3><ul>
<li>usermod -g 组名 用户名</li>
<li>usermod -d 目录名 用户名 改变该用户登录的初始目录</li>
</ul>
<h3 id="权限的基本介绍"><a href="#权限的基本介绍" class="headerlink" title="权限的基本介绍"></a>权限的基本介绍</h3><p>ls -l中显示的内容如下：</p>
<p>-rwxrw-r– 1 root root 1213 Feb 2 09:39 abc</p>
<p><strong>说明：</strong></p>
<ol>
<li>第0位确定文件类型<ul>
<li>-：普通文件</li>
<li>l：软链接</li>
<li>d：目录</li>
<li>b：块设备【硬盘】</li>
<li>c：字符设备【键盘、鼠标】</li>
<li>p：管道</li>
<li>s：套接字</li>
</ul>
</li>
<li>第1-3位确定所有者（该文件的拥有者）拥有该文件的权限。——User</li>
<li>第4-6位确定所属组（同用户组的）拥有该文件的权限。——Group</li>
<li>第7-9位确定其他用户拥有该文件的权限。——Other</li>
<li>第10位的说明：<ul>
<li>如果是文件，表示硬链接的数，如果是目录则表示该目录的子目录个数</li>
</ul>
</li>
<li>第11位：所有者</li>
<li>第12位：所在组</li>
<li>第13位：文件大小，如果是目录则显示4096</li>
<li>第14位：文件最后的修改时间</li>
</ol>
<h3 id="rwx权限详解"><a href="#rwx权限详解" class="headerlink" title="rwx权限详解"></a>rwx权限详解</h3><p><strong>rwx作用到文件：</strong></p>
<ol>
<li>r代表可读（read）：可读、查看</li>
<li>w代表可写（write）：可以修改，但不代表可以删除文件，删除文件的前提是对该文件所在的目录有写权限，才能删除该文件。</li>
<li>x代表可执行（execute）：可以被执行</li>
</ol>
<p><strong>rwx作用到目录：</strong></p>
<ol>
<li>r代表可读（read）：可以读取，ls查看目录内容</li>
<li>w代表可写（write）：可以修改，目录内创建+删除+重命名目录</li>
<li>x代表可执行（execute）：可以进入该目录</li>
</ol>
<p><strong>可以用数字表示权限：</strong></p>
<p>x = 1</p>
<p>w = 2</p>
<p>xw = 1+2 = 3</p>
<p>r = 4</p>
<p>rx = 4+1 = 5</p>
<p>rw = 4+2 = 6</p>
<p>rwx = 4+2+1 = 7</p>
<h3 id="修改权限（chmod）"><a href="#修改权限（chmod）" class="headerlink" title="修改权限（chmod）"></a>修改权限（chmod）</h3><p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570157069905.png" alt="1570157069905"></p>
<h4 id="、-、-变更权限"><a href="#、-、-变更权限" class="headerlink" title="+、-、=变更权限"></a>+、-、=变更权限</h4><p>u：所有者</p>
<p>g：所在组</p>
<p>o：其他人</p>
<p>a：所有人（u、g、o总和）</p>
<ol>
<li>chmod u=rwx,g=rx,o=x 文件或目录名</li>
<li>chmod o+w 文件或目录名</li>
<li>chmod a-x 文件或目录名</li>
</ol>
<h4 id="数字变更权限"><a href="#数字变更权限" class="headerlink" title="数字变更权限"></a>数字变更权限</h4><p>chmod 751 文件目录名</p>
<h3 id="修改文件所有者（chown）"><a href="#修改文件所有者（chown）" class="headerlink" title="修改文件所有者（chown）"></a>修改文件所有者（chown）</h3><ul>
<li>chown newowner file 改变文件的所有者</li>
<li>chown newowner:newgroup file 改变用户的所有者和所有组</li>
<li>-R：如果是目录，则使其下所有的子文件或目录递归生效</li>
</ul>
<h3 id="修改文件所在组（chgrp）"><a href="#修改文件所在组（chgrp）" class="headerlink" title="修改文件所在组（chgrp）"></a>修改文件所在组（chgrp）</h3><ul>
<li>chgrp newgroup file改变文件的所有组</li>
<li>-R：如果是目录，则使其下所有的子文件或目录递归生效</li>
</ul>
<h2 id="定时任务调度"><a href="#定时任务调度" class="headerlink" title="定时任务调度"></a>定时任务调度</h2><p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570173226019.png" alt="1570173226019"></p>
<h3 id="crond任务调度"><a href="#crond任务调度" class="headerlink" title="crond任务调度"></a>crond任务调度</h3><p>crontab进行定时任务的设置</p>
<ul>
<li><p>概述</p>
<p>任务调度是指系统在某个时间执行的特定的命令或程序</p>
<p>任务调度的分类有：</p>
<ul>
<li>系统工作：有些重要的工作必须周而复始地执行，如病毒扫描等。</li>
<li>个别用户工作：个别用户可能希望执行某些程序，比如对mysql数据库的备份。</li>
</ul>
</li>
<li><p>基本语法</p>
<ul>
<li>crontab[选项]</li>
</ul>
</li>
<li><p>常用选项</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>-e</td>
<td>编辑crontab定时任务</td>
</tr>
<tr>
<td>-l</td>
<td>查询crontab任务</td>
</tr>
<tr>
<td>-r</td>
<td>删除当前用户所有的crontab任务</td>
</tr>
</tbody></table>
</li>
<li><p>参数细节说明</p>
<table>
<thead>
<tr>
<th>项目</th>
<th>含义</th>
<th>范围</th>
</tr>
</thead>
<tbody><tr>
<td>第一个*</td>
<td>一小时当中的第几分钟</td>
<td>0-59</td>
</tr>
<tr>
<td>第二个*</td>
<td>一天当中的第几个小时</td>
<td>0-23</td>
</tr>
<tr>
<td>第三个*</td>
<td>一个月当中的第几天</td>
<td>1-31</td>
</tr>
<tr>
<td>第四个*</td>
<td>一年当中的第几个月</td>
<td>1-12</td>
</tr>
<tr>
<td>第五个*</td>
<td>一周当中的星期几</td>
<td>0-7（0和7都代表星期日）</td>
</tr>
</tbody></table>
</li>
<li><p>特殊符号说明</p>
<table>
<thead>
<tr>
<th>特殊符号</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>*</td>
<td>代表任何时间。比如第一个*就代表一小时中每分钟都执行一次的意思</td>
</tr>
<tr>
<td>,</td>
<td>代表不连续的时间。比如”0 8,12,16 * * * 命令”，就代表在每天的8点0分，12点0分，16点0分都执行一次命令</td>
</tr>
<tr>
<td>-</td>
<td>代表连续的时间范围。比如”0 5 * * 1-6 命令”，代表在周一到周六的凌晨5点0分执行命令</td>
</tr>
<tr>
<td>*/n</td>
<td>代表每隔多久执行一次。比如”*/10 * * * * 命令”，代表每隔10分钟就执行一遍命令</td>
</tr>
</tbody></table>
</li>
<li><p>特定时间执行任务案例</p>
<table>
<thead>
<tr>
<th>时间</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>45 22 * * * 命令</td>
<td>在22点45分执行命令</td>
</tr>
<tr>
<td>0 17 * * 1 命令</td>
<td>每周一的17点0分执行命令</td>
</tr>
<tr>
<td>0 5 1,15 * * 命令</td>
<td>每月1号和15号的凌晨5点0分执行命令</td>
</tr>
<tr>
<td>40 4 * * 1-5 命令</td>
<td>每周一到周五的凌晨4点40分执行命令</td>
</tr>
<tr>
<td>*/10 4 * * * 命令</td>
<td>每天的凌晨4点，每隔10分钟执行一次命令</td>
</tr>
<tr>
<td>0 0 1,15 * 1命令</td>
<td>每月1号和15号，每周一的0点0分都会执行命令。<br />注意：星期几和几号最好不要同时出现，因为他们定义的都是天，非常容易让人混乱。</td>
</tr>
</tbody></table>
</li>
<li><p>crond相关指令：</p>
<ul>
<li>crontab -r：终止任务调度</li>
<li>crontab -l：列出当前有那些任务调度</li>
<li>service crond restart [重启任务调度]</li>
</ul>
</li>
<li><p>案例1：</p>
<p>设置任务调度文件：/etc/crontab</p>
<p>设置个人任务调度。执行crontab -e命令</p>
<p>接着输入任务到调度文件</p>
<p>如：*/1 * * * * ls -l /etc/ &gt; /tmp/to.txt</p>
<p>意思是每小时的每分钟执行一次 ls -l /etc/ &gt; /tmp/to.txt命令</p>
</li>
<li><p>案例2：</p>
<p>每个1分钟，就把当前日期追加到/tmp/mydate文件中</p>
<ol>
<li><p>先编写一个文件 mytask1.sh</p>
<p>date &gt;&gt; /tmp/mydate</p>
</li>
<li><p>给mytask.sh一个可执行权限</p>
</li>
<li><p>crontab -e</p>
<p>*/1 * * * * /root/Desktop/mytask1.sh</p>
</li>
<li><p>完成</p>
</li>
</ol>
</li>
<li><p>案例3：</p>
<p>每天凌晨2点，备份mysql的testdb数据库，备份到mydb.bak文件中</p>
<ol>
<li><p>编写脚本 mytask2.sh</p>
<p>/usr/local/mysql/bin/mysqldump -u root -proot testdb &gt; /tmp/mydb.bak</p>
</li>
<li><p>改可执行权限</p>
</li>
<li><p>crontab -e</p>
<p>0 2 * * * /home/mytask1.sh</p>
</li>
<li><p>完成</p>
</li>
</ol>
</li>
</ul>
<h2 id="Linux磁盘分区、挂载"><a href="#Linux磁盘分区、挂载" class="headerlink" title="Linux磁盘分区、挂载"></a>Linux磁盘分区、挂载</h2><h3 id="分区基础知识"><a href="#分区基础知识" class="headerlink" title="分区基础知识"></a>分区基础知识</h3><p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570176212118.png" alt="1570176212118"></p>
<p>分区的方式：</p>
<ol>
<li>mbr分区<ul>
<li>最多支持4个主分区</li>
<li>系统只能安装在主分区</li>
<li>扩展分区要占用一个主分区</li>
<li>MBR最大支持2TB，但拥有最好的兼容性</li>
</ul>
</li>
<li>gpt分区<ul>
<li>支持无限多个主分区（但操作系统可能限制，如windows下最多128个分区）</li>
<li>最大支持18EB的大容量（1EB=1024PB，1PB=1024TB）</li>
<li>windows7 64位以后支持gpt</li>
</ul>
</li>
</ol>
<h3 id="Linux分区"><a href="#Linux分区" class="headerlink" title="Linux分区"></a>Linux分区</h3><p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570176842747.png" alt="1570176842747"></p>
<ol>
<li>对于Linux来说，无论有几个分区，分给哪一个目录使用，它归根结底就只有一个根目录，一个独立且唯一的文件结构，Linux中每个分区都是用来组成整个文件系统的一部分。</li>
<li>Linux采用了一种叫做“载入”的处理方式，它的整个文件系统中包含了一整套的文件和目录，且将一个分区和一个目录联系起来。这时候要载入的一个分区将使它的存储空间在一个目录下获得。</li>
</ol>
<h4 id="硬盘说明"><a href="#硬盘说明" class="headerlink" title="硬盘说明"></a>硬盘说明</h4><ol>
<li><p>Linux硬盘分为IDE硬盘盒SCSI硬盘，目前基本上是SCSI硬盘</p>
</li>
<li><p>对于IDE硬盘，驱动器标识符为“hdx~”</p>
<ul>
<li>“hd“表明分区所在设备的类型，这里是指IDE硬盘了。</li>
<li>“x”为盘号（a为基本盘，b为基本从属盘，c为辅助主盘，d为辅助从属盘）</li>
<li>“~”代表分区，前四个分区用数字1到4表示，它们是主分区或扩展分区，从5开始就是逻辑分区。</li>
</ul>
<p>例如，hda3表示为第一个IDE硬盘上的第三个主分区或扩展分区，hdb2表示为第二个IDE硬盘上的第二个主分区或扩展分区。</p>
</li>
<li><p>对于SCSI硬盘则标识为“sdx~”，SCSI硬盘是用“sd“来表示分区所在设备的类型的，其余则和IDE硬盘的表示方法一样。</p>
</li>
</ol>
<p>可以用lsblk -f或lsblk指令来查看当前系统的分区和挂载的情况：</p>
<p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570201659406.png" alt="1570201659406"></p>
<h3 id="挂载新硬盘"><a href="#挂载新硬盘" class="headerlink" title="挂载新硬盘"></a>挂载新硬盘</h3><p>虚拟机中增加硬盘步骤（挂载到/home/newdisk）</p>
<ol>
<li>虚拟机添加硬盘<ul>
<li>虚拟机菜单中，设置，设备列表里添加–&gt;硬盘，修改磁盘大小，重启系统生效。</li>
</ul>
</li>
<li>分区<ul>
<li>fdisk /dev/sdb<ul>
<li>m：显示命令列表</li>
<li>p：显示磁盘分区 同 fdisk -l</li>
<li>n：新增分区</li>
<li>d：删除分区</li>
<li>w：写入并退出</li>
<li>q：不保存退出</li>
</ul>
</li>
<li>说明：开始分区后输入n，新增分区，然后选择p，分区类型为主分区。两次回车默认剩余全部空间。最后输入w写入并退出，若不保存退出输入q。</li>
</ul>
</li>
<li>格式化<ul>
<li>mkfs -t ext4 /dev/sdb1</li>
<li>其中ext4是分区文件系统类型</li>
</ul>
</li>
<li>挂载<ul>
<li>先创建/home/newdisk</li>
<li>挂载mount /dev/sbd1 /home/newdisk</li>
<li>卸载用umount 设备名称或者挂载目录</li>
</ul>
</li>
<li>设置可以自动挂载（永久挂载）<ul>
<li>如果不设置自动挂载，那么重启了就没有挂载，因为是临时挂载</li>
<li>vim /etc/fstab 这里记录了分区以及挂载点的情况</li>
<li>拷贝一份之前的格式，然后UUID=xxx删除，改为/dev/sdb1  /home/newdisk 最后两位0 0</li>
<li>添加完成后，执行mount -a即刻生效</li>
</ul>
</li>
</ol>
<h3 id="磁盘情况查询"><a href="#磁盘情况查询" class="headerlink" title="磁盘情况查询"></a>磁盘情况查询</h3><ul>
<li>查询系统整体磁盘使用情况<ul>
<li>df -h</li>
</ul>
</li>
<li>查询指定目录的磁盘占用情况<ul>
<li>du -h /目录</li>
<li>默认为当前目录</li>
<li>参数：<ul>
<li>-s：指定目录占用大小汇总</li>
<li>-h：带计量单位</li>
<li>-a：含文件</li>
<li>–max-depth=1：子目录深度</li>
<li>-c：列出明细的同时，增加汇总值</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>常用指令：</p>
<ol>
<li><p>统计/home文件夹下文件的个数</p>
<p>ls -l /home | grep “^-“ | wc -l</p>
<ul>
<li>grep匹配开头为-的文件类型，也就是文件</li>
<li>wc是用于统计的指令</li>
</ul>
</li>
<li><p>统计/home文件夹下目录的个数</p>
<p>ls -l /home | grep “^d” | wc -l</p>
</li>
<li><p>统计/home文件夹下文件的个，包括子文件夹里的</p>
<p>ls -lR /home | grep “^-“ | wc -l</p>
<p>ls -lR：R表示递归</p>
</li>
<li><p>统计文件夹下目录的个数，包括子文件夹里的</p>
<p>ls -lR /home | grep “^d” | wc -l</p>
</li>
<li><p>以树状显示目录结构</p>
<p>yum install tree安装tree指令</p>
<p>tree 目录名</p>
</li>
</ol>
<h2 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h2><p>Linux网络配置原理图：</p>
<p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570241262789.png" alt="1570241262789"></p>
<h3 id="查看网络IP和网关"><a href="#查看网络IP和网关" class="headerlink" title="查看网络IP和网关"></a>查看网络IP和网关</h3><p>查看虚拟网络编辑器：</p>
<p>虚拟机的编辑–&gt;虚拟网络编辑器</p>
<h3 id="修改IP"><a href="#修改IP" class="headerlink" title="修改IP"></a>修改IP</h3><p>修改虚拟网卡的IP</p>
<p>虚拟网络编辑器–&gt;修改VMnet8 NAT模式–&gt; 子网IP</p>
<h3 id="查看网关"><a href="#查看网关" class="headerlink" title="查看网关"></a>查看网关</h3><p>虚拟网络编辑器–&gt;修改VMnet8 NAT模式–&gt; NAT设置</p>
<h3 id="查看windows环境中的VMnet8网络配置（ipconfig指令）"><a href="#查看windows环境中的VMnet8网络配置（ipconfig指令）" class="headerlink" title="查看windows环境中的VMnet8网络配置（ipconfig指令）"></a>查看windows环境中的VMnet8网络配置（ipconfig指令）</h3><ol>
<li>ipconfig查看</li>
<li>打开网络和共享中心–&gt;更改适配器–&gt; VMnet8右键属性–&gt; IPv4</li>
</ol>
<h3 id="Linux网络环境配置"><a href="#Linux网络环境配置" class="headerlink" title="Linux网络环境配置"></a>Linux网络环境配置</h3><p>第一种方式（自动获取）：</p>
<p>​    登录后，通过界面来设置自动获取IP，缺点是每次自动获取的ip地址可能不一样。</p>
<p>​    系统–&gt; 首选项–&gt; 网络连接–&gt; 编辑–&gt; 自动链接勾上即可</p>
<p>第二种方式（指定固定的IP）：</p>
<p>​    直接修改配置文件来指定IP，并可以连接到外网；</p>
<p>​    编辑/etc/sysconfig/network-scripts/ifcfg-eth0</p>
<p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570243585574.png" alt="1570243585574"></p>
<p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570242782086.png" alt="1570242782086"></p>
<p>​    重启服务service network restart</p>
<p>CentOS7文件为ifcfg-ens33，重启网络为systemctl restart network</p>
<h2 id="进程管理"><a href="#进程管理" class="headerlink" title="进程管理"></a>进程管理</h2><h3 id="进程的基本介绍"><a href="#进程的基本介绍" class="headerlink" title="进程的基本介绍"></a>进程的基本介绍</h3><ol>
<li>在Linux中，每个执行的程序（代码）都称为一个进程，每一个进程都分配一个ID号。</li>
<li>每一个进程，都会对应一个父进程，而这个父进程可以复制多个子进程。例如www服务器。</li>
<li>每个进程都可能以两种方式存在。前台与后台，所谓的前台进程就是用户目前的屏幕上可以进行操作的。后台就是实际在操作的，但由于屏幕上无法看到的进程，通常使用后台方式执行。</li>
<li>一般系统的服务都是以后台进程的方式存在，而且都会常驻在系统中。直到关机才会结束。</li>
</ol>
<h3 id="显示系统执行的进程"><a href="#显示系统执行的进程" class="headerlink" title="显示系统执行的进程"></a>显示系统执行的进程</h3><p>ps命令是用来查看目前系统中有哪些正在执行的进程以及执行情况。可以不加任何参数；</p>
<p>ps命令显示的信息选项：</p>
<table>
<thead>
<tr>
<th>字段</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>PID</td>
<td>进程识别号</td>
</tr>
<tr>
<td>TTY</td>
<td>终端机号</td>
</tr>
<tr>
<td>TIME</td>
<td>此进程所消耗的CPU时间</td>
</tr>
<tr>
<td>CMD</td>
<td>正在执行的命令或进程名</td>
</tr>
</tbody></table>
<p>ps -a：显示当前终端的所有进程信息</p>
<p>ps -u：以用户的格式显示进程信息</p>
<p>ps -x：显示后台进程运行的参数</p>
<p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570245252922.png" alt="1570245252922"></p>
<p>常用的几个指令：</p>
<ul>
<li>ps -aux|more</li>
<li>ps -aux|grep 进程名</li>
</ul>
<p>ps详解：</p>
<p>一般用ps -aux|grep xxx</p>
<ul>
<li>System V展示风格</li>
<li>USER：用户名称</li>
<li>PID：进程号</li>
<li>%CPU：进程占用CPU的百分比</li>
<li>%MEM：进程占用物理内存的百分比</li>
<li>VSZ：进程占用的虚拟内存大小（单位：KB）</li>
<li>RSS：进程占用的物理内存大小（单位：KB）</li>
<li>TT：终端名称，缩写</li>
<li>STAT：进程状态<ul>
<li>S：睡眠</li>
<li>s：表示该进程是会话的先导进程</li>
<li>N：表示进程拥有比普通优先级更低的优先级</li>
<li>R：正在运行</li>
<li>D：短期等待</li>
<li>Z：僵死状态</li>
<li>T：被跟踪或者被停止等等</li>
</ul>
</li>
<li>STARTED：进程的启动时间</li>
<li>TIME：CPU时间，即进程使用CPU的总时间</li>
<li>COMMAND：启动进程所用的命令和参数，如果过长会被截断显示</li>
</ul>
<p>用ps -ef | more显示的是父进程信息，PPID是父进程的PID</p>
<ul>
<li>-e表示所有进程</li>
<li>-f全格式</li>
</ul>
<p>ps -ef | grep xxx</p>
<ul>
<li>是BSD风格</li>
<li>UID：用户ID</li>
<li>PID：进程ID</li>
<li>PPID：父进程ID</li>
<li>C：CPU用于计算执行优先级的因子。<ul>
<li>数值越大，表明进程是CPU密集型运算，执行优先级会降低。</li>
<li>数值越小，表名进程是I/O密集型运算，执行优先级会提高</li>
</ul>
</li>
<li>STIME：进程启动的时间</li>
<li>TTY：完整的终端名称</li>
<li>TIME：CPU时间</li>
<li>CMD：启动进程所用的命令和参数</li>
</ul>
<h3 id="终止进程kill和killall"><a href="#终止进程kill和killall" class="headerlink" title="终止进程kill和killall"></a>终止进程kill和killall</h3><p>若是某个进程执行一半需要停止时，或是已消耗了很大的系统资源的时候，此时可以考虑停止该进程。</p>
<p>使用kill命令来完成此项任务。</p>
<p>kill [选项] 进程号（通过进程号来杀死进程）</p>
<p>killall 进程名称（通过进程名车功能来杀死进程，也支持通配符，这在系统因负载过大而变慢的时候很有用）</p>
<p>常用选项：</p>
<p>-9：表示强迫进程立即停止</p>
<p>案例：</p>
<ol>
<li>踢掉某个非法登录用户<ul>
<li>先ps -aux | grep sshd</li>
<li>找到要踢出的用户进程号</li>
<li>kill 进程号</li>
</ul>
</li>
<li>终止远程登录服务sshd，在适当的时候再次重启sshd服务<ul>
<li>ps -aux | grep sshd</li>
<li>kill进程号即可</li>
</ul>
</li>
<li>终止多个gedit编辑器<ul>
<li>killall gedit</li>
</ul>
</li>
<li>强制杀掉一个终端<ul>
<li>ps -aux | grep bash</li>
<li>找到/bin/bash就是个终端</li>
<li>kill -9 进程号</li>
</ul>
</li>
</ol>
<h3 id="查看进程树pstree"><a href="#查看进程树pstree" class="headerlink" title="查看进程树pstree"></a>查看进程树pstree</h3><p>基本语法：</p>
<p>​    pstree [选项]，更直观查看进程信息</p>
<p>常用选项：</p>
<ul>
<li>-p：显示进程的PID</li>
<li>-u：显示进程的所属用户 </li>
</ul>
<h3 id="服务（service）管理"><a href="#服务（service）管理" class="headerlink" title="服务（service）管理"></a>服务（service）管理</h3><p>服务[service]本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其他程序的请求，比如（mysql、sshd、防火墙等），因此我们又称为守护进程，是Linux中非常重要的知识点。</p>
<p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570254430837.png" alt="1570254430837"></p>
<h4 id="service管理指令"><a href="#service管理指令" class="headerlink" title="service管理指令"></a>service管理指令</h4><p>service 服务名 start|stop|restart|reload|status</p>
<p>systemctl【CentOS7】</p>
<p>例子：</p>
<p>查看防火墙情况，关闭和重启防火墙：</p>
<p>​    service iptables status</p>
<p>​    service iptables stop</p>
<p>​    service iptables restart</p>
<p>可以在windows命令行用telnet ip地址 端口 来测试linux的端口是否可以访问（可能默认没有开，可以到系统设置–&gt;控制面板–&gt;程序和功能–&gt;启用和关闭Windows功能–&gt;开启telnet ）</p>
<p>用service指令开启和停用服务只是暂时的，重启之后还是会恢复原来的状态，如果希望开启或关闭状态永久生效，需要用chkconfig指令</p>
<h4 id="chkconfig指令"><a href="#chkconfig指令" class="headerlink" title="chkconfig指令"></a>chkconfig指令</h4><p>通过chkconfig指令可以给每个服务的各个运行级别设置自启动/关闭</p>
<ol>
<li>查看服务chkconfig –list | grep xxx</li>
<li>chkconfig 服务名 –list</li>
<li>chkconfig –level 5 服务名 on/off</li>
</ol>
<p>注意：chkconfig重新设置服务之后，需要重启reboot才能生效。</p>
<h4 id="查看服务名"><a href="#查看服务名" class="headerlink" title="查看服务名"></a>查看服务名</h4><p>方式1：使用setup指令 –&gt; 系统服务 就可以看到</p>
<p>方式2：/etc/init.d/服务名称</p>
<h4 id="服务的运行级别（runlevel）"><a href="#服务的运行级别（runlevel）" class="headerlink" title="服务的运行级别（runlevel）"></a>服务的运行级别（runlevel）</h4><p>查看或修改默认级别：vi /etc/inittab</p>
<p>Linux系统有7种运行级别（runlevel）：常用的级别是3和5</p>
<ul>
<li>0：系统停机状态，系统默认运行级别不能设置为0，否则不能正常启动</li>
<li>1：单用户工作状态，root权限，用于系统维护，禁止远程登录</li>
<li>2：多用户状态（没有NFS），不支持网络</li>
<li>3：完全的多用户状态（有NFS），登录后进入控制台命令行模式</li>
<li>4：系统未使用，保留</li>
<li>5：X11控制台，登录后进入图形GUI模式</li>
<li>6：系统正常关闭并重启，默认运行级别不能设置为6，否则不能正常启动</li>
</ul>
<p>开启的流程说明：</p>
<p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570255484813.png" alt="1570255484813"></p>
<h3 id="动态监控进程"><a href="#动态监控进程" class="headerlink" title="动态监控进程"></a>动态监控进程</h3><p>top与ps命令和相似，都是用来显示正在执行的进程。</p>
<p>top与ps最大的不同就是在于top在执行一段时间可以更新正在运行的进程。</p>
<p><img src="02_%E5%AE%9E%E6%93%8DLinux/1570262305713.png" alt="1570262305713"></p>
<p>基本语法：</p>
<p>​    top [选项]</p>
<p>选项说明</p>
<table>
<thead>
<tr>
<th>选项</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>-d 秒数</td>
<td>指定top命令每隔几秒更新。默认是3秒</td>
</tr>
<tr>
<td>-i</td>
<td>使top不显示任何闲置或僵死进程</td>
</tr>
<tr>
<td>-p</td>
<td>通过指定监控进程ID来仅仅监控某个进程的状态</td>
</tr>
</tbody></table>
<p>交互操作说明：</p>
<table>
<thead>
<tr>
<th>操作</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>P</td>
<td>以CPU的使用率排序（默认）</td>
</tr>
<tr>
<td>M</td>
<td>以内存的使用率排序</td>
</tr>
<tr>
<td>N</td>
<td>以PID排序</td>
</tr>
<tr>
<td>q</td>
<td>退出top</td>
</tr>
<tr>
<td>u</td>
<td>输入用户名，可以监视指定用户的进程情况</td>
</tr>
<tr>
<td>k</td>
<td>输入要结束的进程号，即可结束进程</td>
</tr>
</tbody></table>
<h3 id="监控网络状态"><a href="#监控网络状态" class="headerlink" title="监控网络状态"></a>监控网络状态</h3><p>查看系统网络情况用netstat指令</p>
<p>基本语法：</p>
<p>​    netstat [选项]</p>
<p>选项说明：</p>
<ul>
<li>-an：按一定顺序排列输出</li>
<li>-p：显示哪个进程在调用</li>
</ul>
<p>一般用netstat -anp|grep xxx 即可</p>
<p>检测主机连接命令ping：</p>
<p>是一种网络检测工具，主要用于检测远程主机是否正常，或两部主机间的介质是否为断、网线是否脱落或网卡故障。</p>
<p>如：ping 对方的ip地址</p>
<h2 id="RPM"><a href="#RPM" class="headerlink" title="RPM"></a>RPM</h2><h3 id="rpm包的管理"><a href="#rpm包的管理" class="headerlink" title="rpm包的管理"></a>rpm包的管理</h3><p>一种用于互联网下载包的打包及安装工具，它包含在某些Linux发行版中。</p>
<p>他生成具有.rpm扩展名的文件。</p>
<p>RPM是RedHat Package Manger（RedHat软件包管理工具）的缩写，类似windows的setup.exe，这一文件格式名称虽然打上了RedHat的标志，但是理念是通用的。</p>
<p>Linux发行版都有采用（suse，redhat，centos等等），可以算是公认的行业标准了。</p>
<p><strong>rpm包的简单查询指令：</strong></p>
<ul>
<li>查询已安装的rmp列表：rmp -qa | grep xx</li>
</ul>
<p><strong>rpm包名基本格式：</strong></p>
<p>一个rpm包名：firefox-52.8.0-1.el6.centos.x86_64.rpm</p>
<p>名称：firefox</p>
<p>版本号：52.8.0-1</p>
<p>适用操作系统：el6.centos.x86_64，表示centos6.x的64位系统</p>
<p>如果是i686、i386表示32位系统，noarch表示通用。</p>
<p><strong>rpm包的其他查询指令：</strong></p>
<p>i：用来展示详细信息</p>
<p>l：用于展示包安装了哪些文件</p>
<p>f：用于展示文件属于哪个rpm包的，与l相反</p>
<ul>
<li>rpm -qa：查询所安装的所有rpm软件包<ul>
<li>rpm -qa | more</li>
<li>rpm -qa | grep X[rpm -qa | grep filefox]</li>
</ul>
</li>
<li>rpm -q 软件包名：查询软件包是否安装<ul>
<li>rpm -q firefox</li>
</ul>
</li>
<li>rpm -qi 软件包名：查询软件包信息<ul>
<li>rpm -qi file</li>
</ul>
</li>
<li>rpm -ql 软件包名：查询软件包中的文件<ul>
<li>rpm -ql firefox</li>
</ul>
</li>
<li>rpm -qf 文件全路径名：查询文件所属的软件包<ul>
<li>rpm -qf /etc/passwd</li>
<li>rpm -qf /root/install.log</li>
</ul>
</li>
</ul>
<h3 id="卸载rpm包"><a href="#卸载rpm包" class="headerlink" title="卸载rpm包"></a>卸载rpm包</h3><p>基本语法：</p>
<p>​    rpm -e rpm包的名称</p>
<p>细节讨论：</p>
<ol>
<li>如果其他软件包依赖于你要卸载的软件包，卸载的时候会产生错误信息<ul>
<li>如：rpm -e foo</li>
<li>removing these packages would break dependencies:foo is needed by bar-1.0-1</li>
</ul>
</li>
<li>如果我们就是要删除foo这个rpm包，可以增加参数 –nodeps，就可以强制卸载，但是一般不推荐这样做，因为依赖于该软件包的程序可能无法运行</li>
</ol>
<h3 id="安装rpm包"><a href="#安装rpm包" class="headerlink" title="安装rpm包"></a>安装rpm包</h3><p>基本语法：</p>
<p>​    rpm -ivh rpm包全路径名称</p>
<p>参数说明：</p>
<ul>
<li>i：install安装</li>
<li>v：verbose提示</li>
<li>h：hash进度条</li>
</ul>
<p>可以把CentOS7的iso镜像挂载到虚拟机上，然后在/media目录把指定的rpm包复制出来，再用rpm -ivh rpm包 进行安装。</p>
<h2 id="YUM"><a href="#YUM" class="headerlink" title="YUM"></a>YUM</h2><p>yum是一个Shell前端软件包管理器。</p>
<p>基于rpm包管理，能够从指定的服务器自动下载rpm包并且安装，可以<strong>自动处理依赖关系</strong>，并且一次安装所有依赖的软件包。</p>
<p>yum的基本指令</p>
<ul>
<li>查询yum服务器是否有需要安装的软件<ul>
<li>yum list | grep xx软件列表</li>
</ul>
</li>
<li>安装指定的yum包<ul>
<li>yum install xxx 下载安装</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/02/Linux/01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/02/Linux/01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/" class="post-title-link" itemprop="url">01_安装VM和CentOS</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-02 17:24:51" itemprop="dateCreated datePublished" datetime="2019-10-02T17:24:51+08:00">2019-10-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="01-安装VM和CentOS"><a href="#01-安装VM和CentOS" class="headerlink" title="01_安装VM和CentOS"></a>01_安装VM和CentOS</h1><blockquote>
<p>安装CentOS 6.8版本，下载bin版本的带图形化界面，下载Live版本的没有图形化界面</p>
<p><a href="https://mirrors.aliyun.com/centos/" target="_blank" rel="noopener">阿里巴巴CentOS下载地址</a></p>
</blockquote>
<h2 id="VM安装"><a href="#VM安装" class="headerlink" title="VM安装"></a>VM安装</h2><ol>
<li>要到BIOS中修改设置开启虚拟化设备支持</li>
<li>安装VM</li>
</ol>
<h2 id="CentOS安装"><a href="#CentOS安装" class="headerlink" title="CentOS安装"></a>CentOS安装</h2><h3 id="网络连接三种形式的说明"><a href="#网络连接三种形式的说明" class="headerlink" title="网络连接三种形式的说明"></a>网络连接三种形式的说明</h3><h4 id="桥连接："><a href="#桥连接：" class="headerlink" title="桥连接："></a>桥连接：</h4><p>直接连接物理网络</p>
<p><img src="01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/1570017182559.png" alt="1570017182559"></p>
<p>使用桥连接的话，也就是共享了网络环境，那么网关最后一位1，广播地址（交换机通讯）最后一位255，当超过253台机器的时候，会有ip冲突的问题。</p>
<h4 id="NAT模式"><a href="#NAT模式" class="headerlink" title="NAT模式"></a>NAT模式</h4><p>用于共享主机的IP地址</p>
<p><img src="01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/1570017534750.png" alt="1570017534750"></p>
<h4 id="主机模式"><a href="#主机模式" class="headerlink" title="主机模式"></a>主机模式</h4><p>Linux就是一个独立的主机，不可以访问外网。</p>
<h4 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h4><p><img src="01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/1570017637590.png" alt="1570017637590"></p>
<ol>
<li>桥连接：Linux可以和其他系统通信，但是可能造成ip冲突。</li>
<li>NAT：网络地址转换方式：Linux可以访问外网，不会造成ip冲突。</li>
<li>主机模式：此时Linux是一个独立的主机，不能访问外网。</li>
</ol>
<h3 id="分区"><a href="#分区" class="headerlink" title="分区"></a>分区</h3><p><img src="01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/1570025231219.png" alt="1570025231219"></p>
<p>标准分区/boot分区：/boot挂载点，200MB，文件系统ext4；</p>
<p>标准分区/swap分区：无挂载点，2048MB，文件系统swap，大小一般是内存的1-1.5倍，这是虚拟内存；</p>
<p>标准分区/根分区：/挂载点，剩下的所有空间，文件系统ext4，</p>
<h2 id="网络"><a href="#网络" class="headerlink" title="网络"></a>网络</h2><p>右上角启用eth0，即成功连接到网络；</p>
<h2 id="VMTools安装"><a href="#VMTools安装" class="headerlink" title="VMTools安装"></a>VMTools安装</h2><p><img src="01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/1570025997376.png" alt="1570025997376"></p>
<p>可以让我们在windows下，方便与虚拟机交互。</p>
<p>如命令之间的复制，文件之间的复制，共享文件夹。</p>
<h3 id="安装步骤"><a href="#安装步骤" class="headerlink" title="安装步骤"></a>安装步骤</h3><ol>
<li>进入CentOS</li>
<li>点击vm菜单的 虚拟机 -&gt; install vmware tools</li>
<li>centos会出现一个vm的安装包</li>
<li>点击右键解压，得到一个安装文件</li>
<li>进入该vm解压的目录，该文件在/root/桌面/vmware-tools-distrib/下</li>
<li>安装./vmware-install.pl</li>
<li>全部使用默认设置即可</li>
<li>需要reboot重新启动来生效</li>
</ol>
<p><img src="01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/1570026565340.png" alt="1570026565340"></p>
<p>把这个tar包放在/opt目录下</p>
<p>用tar -zxvf VMwarTools-10.0….命令进行解压</p>
<p>cd到解压完的文件夹里，发现有个vmware-install.pl</p>
<p>用./vmware-install.pl执行之</p>
<p>一直下一步，安装完成后reboot重启即可用</p>
<h3 id="共享文件夹"><a href="#共享文件夹" class="headerlink" title="共享文件夹"></a>共享文件夹</h3><ol>
<li>为了方便，可以设置一个共享文件夹，比如d:/share</li>
<li>windows和CentOS就可以共享文件了了，但是在实际开发中，文件的上传和下载是需要用远程方式完成的。</li>
</ol>
<p>步骤：</p>
<p><img src="01_%E5%AE%89%E8%A3%85VM%E5%92%8CCentOS/1570026991453.png" alt="1570026991453"></p>
<ol>
<li>菜单-&gt;vm-&gt;setting,如图设置即可，注意：设置选项为always enable，这样就可以读写</li>
<li>windows和CentOS可共享d:/share目录</li>
<li>在CentOS中的/mnt/hgfs/下</li>
</ol>
<h2 id="Linux目录结构"><a href="#Linux目录结构" class="headerlink" title="Linux目录结构"></a>Linux目录结构</h2><p><strong>/bin</strong>（/usr/bin、/usr/local/bin）：可执行的指令等。</p>
<p><strong>/boot</strong>：系统启动文件，包括连接文件以及镜像文件。</p>
<p>/dev：设备管理器，把所有的硬件用文件的形式存储。</p>
<p><strong>/etc</strong>：所有系统管理所需的配置文件和子目录</p>
<p><strong>/home</strong>：家目录，存放普通用户的主目录，在Linux下每个用户都有自己的目录，一般该目录是以用户的账号命名的。</p>
<p>/lib：系统开机所需最基本的动态连接共享库，其作用类似于windows里面的DLL文件。几乎所有的应用程序都要用到这些共享库。</p>
<p>/lost+found：这个目录一般情况下是空的，当系统非法关机后，这里就存放了一些文件</p>
<p>/lib64：库文件</p>
<p><strong>/media</strong>：媒体，当插上如U盘等设备的时候，会把识别的设备挂载到这个目录下。</p>
<p><strong>/mnt</strong>：挂载文件夹，系统提供该目录是为了让用户临时挂载别的文件系统的，我们可以将外部的存储挂载到/mnt上，然后进入该目录就可以查看里面的内容了。</p>
<p>/opt：这是给主机额外安装软件所摆放的目录，如安装ORACLE数据库的时候就可以放在该目录下，默认为空。</p>
<p>/proc：虚拟的目录，是系统内存的映射，访问这个目录来获取系统信息</p>
<p><strong>/root</strong>：root用户的主目录</p>
<p>/sbin（/usr/sbin、/usr/local/sbin）：super，高级用户可以使用的指令</p>
<p>/selinux：SELinux是一种安全子系统，它能控制程序只能访问特定文件。</p>
<p>/srv：service的缩写，该目录存放一些服务启动后需要提取的数据</p>
<p>/sys：该目录下安装了2.6内核中出现的一个文件系统sysfs</p>
<p>/tmp：存放临时文件</p>
<p><strong>/usr</strong>：用户的很多应用程序和文件都放在这个目录下，类似于windows的Program files目录</p>
<p><strong>/urs/local</strong>：这是另一个给主机额外安装软件所安装的目录，一般是通过编译源码的方式安装的程序。</p>
<p><strong>/var</strong>：这个目录存放着不断扩充着的东西，习惯将经常被修改的目录放在该目录下，包括各种日志文件。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/09/29/Hadoop/04_Hadoop_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/29/Hadoop/04_Hadoop_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">04_Hadoop_环境搭建</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-29 21:31:11" itemprop="dateCreated datePublished" datetime="2019-09-29T21:31:11+08:00">2019-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">Hadoop</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="04-Hadoop-环境搭建"><a href="#04-Hadoop-环境搭建" class="headerlink" title="04_Hadoop_环境搭建"></a>04_Hadoop_环境搭建</h1><h2 id="虚拟机环境准备"><a href="#虚拟机环境准备" class="headerlink" title="虚拟机环境准备"></a>虚拟机环境准备</h2><ol>
<li><p>克隆虚拟机</p>
</li>
<li><p>修改克隆虚拟机的静态IP</p>
<ul>
<li><p>vim /etc/udev/rules.d/70-persisitent-net.rules</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> This file was automatically generated by the /lib/udev/write_net_rules</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> program, run by the persistent-net-generator.rules rules file.</span></span><br><span class="line"><span class="meta">#</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> You can modify it, as long as you keep each rule on a single</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> line, and change only the value of the NAME= key.</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> PCI device 0x8086:0x100f (e1000)</span></span><br><span class="line">SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR&#123;address&#125;=="00:0c:29:e2:1d:3d", ATTR&#123;type&#125;=="1", KERNEL=="eth*", NAME="eth0"</span><br></pre></td></tr></table></figure>

<p>这里的物理地址需要复制到下面的配置文件HWADDR中去。</p>
<p>如果是克隆的话，把第一块eth0删除，然后把第二块eth1改为eth0；</p>
</li>
<li><p>vim /etc/sysconfig/network-scripts/ifcfg-eth0</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DEVICE="eth0"</span><br><span class="line">BOOTPROTO="static"</span><br><span class="line">HWADDR="00:0C:29:E2:1D:3D"</span><br><span class="line">IPV6INIT="yes"</span><br><span class="line">NM_CONTROLLED="yes"</span><br><span class="line">ONBOOT="yes"</span><br><span class="line">TYPE="Ethernet"</span><br><span class="line">UUID="0b772052-7949-42c8-8467-e15c36d69b6e"</span><br><span class="line"></span><br><span class="line">IPADDR=192.168.5.101</span><br><span class="line">GATEWAY=192.168.5.2</span><br><span class="line">DNS1=192.168.5.2</span><br></pre></td></tr></table></figure>

<p>这里配BOOTPROTO为static，以及HWADDR为上一步复制的值。</p>
</li>
</ul>
</li>
<li><p>修改主机名</p>
<ul>
<li><p>vim /etc/sysconfig/network</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">NETWORKING=yes</span><br><span class="line">HOSTNAME=hadoop101</span><br></pre></td></tr></table></figure>
</li>
<li><p>vim /etc/hosts</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4</span><br><span class="line">::1         localhost localhost.localdomain localhost6 localhost6.localdomain6</span><br><span class="line">192.168.5.100 hadoop100</span><br><span class="line">192.168.5.101 hadoop101</span><br><span class="line">192.168.5.102 hadoop102</span><br><span class="line">192.168.5.103 hadoop103</span><br><span class="line">192.168.5.104 hadoop104</span><br><span class="line">192.168.5.105 hadoop105</span><br><span class="line">192.168.5.106 hadoop106</span><br><span class="line">192.168.5.107 hadoop107</span><br><span class="line">192.168.5.108 hadoop108</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>关闭防火墙</p>
</li>
<li><p>创建tomxwd用户</p>
</li>
<li><p>配置tomxwd用户具有的root权限</p>
<ul>
<li><p>vim /etc/sudoers</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line">tomxwd  ALL=(ALL)       ALL</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>重启reboot</p>
</li>
<li><p>windows上记得在C:\Windows\System32\drivers\etc配置hosts</p>
</li>
</ol>
<h2 id="JDK安装"><a href="#JDK安装" class="headerlink" title="JDK安装"></a>JDK安装</h2><p>在/opt目录下创建文件夹</p>
<ol>
<li><p>在/opt目录下创建open文件夹（个人习惯）</p>
<ul>
<li>open<ul>
<li>download（存放下载的tar包等）</li>
<li>soft（软件）</li>
<li>environment（环境）</li>
<li>service（服务）</li>
</ul>
</li>
</ul>
<p>sudo mkdir open</p>
</li>
<li><p>修改open文件夹的所有者cd</p>
<ul>
<li>sudo chown tomxwd:tomxwd open</li>
</ul>
</li>
</ol>
<p>把JDK拷贝到Linux上，download目录下即可。</p>
<p>安装步骤：</p>
<ol>
<li><p>解压：</p>
<p>tar -zxvf jdk-8u221-linux-x64.tar.gz -C /opt/open/environment/</p>
</li>
<li><p>获取安装路径：</p>
<p>pwd</p>
<p>/opt/open/environment/jdk1.8.0_221</p>
</li>
<li><p>配置环境变量：</p>
<p>sudo vim /etc/profile</p>
<p>末尾追加以下内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"><span class="comment"># JAVA_HOME</span></span></span><br><span class="line">export JAVA_HOME=/opt/open/environment/jdk1.8.0_221</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br></pre></td></tr></table></figure>
</li>
<li><p>source /etc/profile</p>
</li>
<li><p>java -version看是否安装成功</p>
</li>
</ol>
<h2 id="Hadoop安装"><a href="#Hadoop安装" class="headerlink" title="Hadoop安装"></a>Hadoop安装</h2><blockquote>
<p><a href="http://archive.apache.org/dist/hadoop/core/" target="_blank" rel="noopener">下载地址1</a></p>
<p><a href="http://hadoop.apache.org/releases.html" target="_blank" rel="noopener">下载地址2</a></p>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hadoop/common/" target="_blank" rel="noopener">清华的下载地址3,</a></p>
<p>下载binary版本，否则需要自己去编译</p>
</blockquote>
<p>把hadoop拷贝到Linux上，download目录下即可。</p>
<p>安装步骤：</p>
<ol>
<li><p>解压：</p>
<p>tar -zxvf hadoop-2.9.2.tar.gz -C /opt/open/environment/</p>
</li>
<li><p>获取安装路径：</p>
<p>pwd</p>
<p>/opt/open/environment/hadoop-2.9.2</p>
</li>
<li><p>配置环境变量：</p>
<p>sudo vim /etc/profile</p>
<p>末尾追加内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> HADOOP_HOME</span></span><br><span class="line">export HADOOP_HOME=/opt/open/environment/hadoop-2.9.2</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/bin</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/sbin</span><br></pre></td></tr></table></figure>
</li>
<li><p>source /etc/profile</p>
</li>
<li><p>hadoop version看是否安装成功</p>
</li>
</ol>
<p>跟jdk不同的就是环境变量PATH多一个sbin，以及看版本是用version而不是-version</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/09/29/Hadoop/03_Hadoop_%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/29/Hadoop/03_Hadoop_%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/" class="post-title-link" itemprop="url">03_Hadoop_推荐系统框架</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-29 21:27:34" itemprop="dateCreated datePublished" datetime="2019-09-29T21:27:34+08:00">2019-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">Hadoop</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><img src="03_Hadoop_%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%E6%A1%86%E6%9E%B6/1569763807928.png" alt="03_Hadoop_推荐系统框架"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/09/29/Hadoop/02_Hadoop_%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/29/Hadoop/02_Hadoop_%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB/" class="post-title-link" itemprop="url">02_Hadoop_大数据技术生态体系</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-29 21:07:45" itemprop="dateCreated datePublished" datetime="2019-09-29T21:07:45+08:00">2019-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">Hadoop</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="02-Hadoop-大数据技术生态体系"><a href="#02-Hadoop-大数据技术生态体系" class="headerlink" title="02_Hadoop_大数据技术生态体系"></a>02_Hadoop_大数据技术生态体系</h1><p><img src="02_Hadoop_%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF%E7%94%9F%E6%80%81%E4%BD%93%E7%B3%BB/1569762482212.png" alt="Hadoop_大数据技术生态体系"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/09/29/Hadoop/01_Hadoop_%E7%BB%84%E6%88%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/09/29/Hadoop/01_Hadoop_%E7%BB%84%E6%88%90/" class="post-title-link" itemprop="url">01_Hadoop_组成</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-09-29 20:37:46" itemprop="dateCreated datePublished" datetime="2019-09-29T20:37:46+08:00">2019-09-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">Hadoop</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="01-Hadoop-组成"><a href="#01-Hadoop-组成" class="headerlink" title="01_Hadoop_组成"></a>01_Hadoop_组成</h1><p><img src="01_Hadoop_Hadoop%E7%BB%84%E6%88%90/1569762325816.png" alt="1569762325816"></p>
<h2 id="HDFS架构概述"><a href="#HDFS架构概述" class="headerlink" title="HDFS架构概述"></a>HDFS架构概述</h2><p>HDFS(Hadoop Distributed File System)的架构概述</p>
<ol>
<li>NameNode(nn)：存储文件的元数据，如文件名，文件目录结构，文件属性（生成时间、副本数、文件权限），以及每个文件的块列表和块所在的DataNode等。</li>
<li>DataNode(dn)：在本地文件系统存储文件块数据，以及块数据的校验和。</li>
<li>Secondary NameNode(2nn)：用来监控HDFS状态的辅助后台程序，每隔一段时间获取HDFS元数据的快照。</li>
</ol>
<p><img src="01_Hadoop_Hadoop%E7%BB%84%E6%88%90/1569762047162.png" alt="1569762047162"></p>
<h2 id="MapReduce架构概述"><a href="#MapReduce架构概述" class="headerlink" title="MapReduce架构概述"></a>MapReduce架构概述</h2><p>MapReduce将计算过程分为两个阶段：Map和Reduce</p>
<ol>
<li>Map阶段并行处理输入数据</li>
<li>Reduce阶段对Map结果进行汇总</li>
</ol>
<p><img src="01_Hadoop_Hadoop%E7%BB%84%E6%88%90/1569762268963.png" alt="1569762268963"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="tomxwd"
      src="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
  <p class="site-author-name" itemprop="name">tomxwd</p>
  <div class="site-description" itemprop="description">tomxwd</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">342</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tomxwd" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tomxwd" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备18158552号-1 </a>
      <img src="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/ico/%E5%A4%87%E6%A1%88%E5%9B%BE%E6%A0%87.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=18158552" rel="noopener" target="_blank">1213123 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-bug"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tomxwd</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  
















  

  

</body>
</html>
