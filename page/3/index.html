<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/ico/girl-128x128.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/ico/girl-32x32.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/ico/girl-16x16.ico">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <link rel="alternate" href="/atom.xml" title="tomxwd.blog" type="application/atom+xml">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.5.0',
    exturl: false,
    sidebar: {"position":"right","display":"post","offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: '',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    sidebarPadding: 40
  };
</script>

  <meta name="description" content="tomxwd">
<meta name="keywords" content="blog">
<meta property="og:type" content="website">
<meta property="og:title" content="tomxwd.blog">
<meta property="og:url" content="http:&#x2F;&#x2F;www.blog.tomxwd.com&#x2F;page&#x2F;3&#x2F;index.html">
<meta property="og:site_name" content="tomxwd.blog">
<meta property="og:description" content="tomxwd">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://www.blog.tomxwd.com/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: true,
    isPost: false,
    isPage: false,
    isArchive: false
  };
</script>

  <title>tomxwd.blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">tomxwd.blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/tomxwd" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/11/09/tomcat/05_tomcat_EL%E8%A1%A8%E8%BE%BE%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/tomcat/05_tomcat_EL%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="post-title-link" itemprop="url">05_tomcat_EL表达式</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-09 19:43:47" itemprop="dateCreated datePublished" datetime="2019-11-09T19:43:47+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tomcat/" itemprop="url" rel="index">
                    <span itemprop="name">tomcat</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="05-tomcat-EL表达式"><a href="#05-tomcat-EL表达式" class="headerlink" title="05_tomcat_EL表达式"></a>05_tomcat_EL表达式</h1><p>EL全名为Expression Language，它可以在JSP页面上直接使用；</p>
<p>格式：${表达式内容}</p>
<p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value=<span class="string">"$&#123;requestScope.emp.empName&#125;"</span></span><br></pre></td></tr></table></figure>

<p>相当于</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">Employee</span> <span class="attr">emp</span> = <span class="string">(Employee)request.getAttribute(</span>"<span class="attr">emp</span>"); %&gt;</span></span><br><span class="line">    员工姓名<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"empName"</span> <span class="attr">value</span>=<span class="string">"&lt;%=emp.getEmpName()%&gt;"</span> &gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="EL表达式的功能"><a href="#EL表达式的功能" class="headerlink" title="EL表达式的功能"></a>EL表达式的功能</h2><ol>
<li><strong>在页面显示域中的属性值</strong><ul>
<li>${输入属性名}</li>
</ul>
</li>
<li><strong>要获取对象中的某个属性直接使用.属性名的方式（还是根据getter、setter取出来的）</strong></li>
<li><strong>el表达式如果获取域中的属性，直接写属性名，会从4个域中从小到大找，找到就停止（可以用隐含对象取指定的域）</strong></li>
<li><strong>el隐含对象（11个）</strong><ul>
<li><strong>四个域对象：</strong><ul>
<li>pageScope：page域中的数据，是一个map，可以用.属性名的方式获取</li>
<li>requestScope：request域中的数据，也是一个map</li>
<li>sessionScope：session域中的数据，也是一个map</li>
<li>applicationScope：application域中的数据，也是一个map</li>
</ul>
</li>
<li><strong>一个非map对象：</strong><ul>
<li>pageContext：就是JSP页面上的pageContext，可以取出jsp页面其他的隐含对象（九大隐含对象），但是是用.的形式取。</li>
</ul>
</li>
<li><strong>和HTTP协议有关：</strong><ul>
<li>param：map类型，对应一个请求参数，request.getParamer(“username”)</li>
<li>paramValues：map类型，对应一组请求参数，数组（${paramValues.ah[0]},${paramValues.ah[1]}）等</li>
<li>header：map类型，请求头，request.getHeader(“User-Agent”)</li>
<li>headerValues：map类型，请求头返回字符数组</li>
<li>cookie：map类型，获取某个cookie对象，取出cookie的值</li>
</ul>
</li>
<li><strong>获取初始化参数：</strong><ul>
<li>initParam：map类型，获取应用初始化参数，获取web的初始化参数，在web.xml中初始化参数</li>
</ul>
</li>
</ul>
</li>
<li><strong>el表达式如何获取stu-x这些特殊命名的属性（因为会产生歧义，如减号等）</strong><ul>
<li>使用[‘stu-x’]取出<ul>
<li><code>${requestScope[&#39;stu-x&#39;]}</code></li>
</ul>
</li>
</ul>
</li>
<li><strong>el表达式运算</strong><ul>
<li>算术运算：${5+3}</li>
<li>关系运算：${5&gt;3}</li>
<li>逻辑运算：${true&amp;&amp;false}</li>
<li>empty运算：<ul>
<li>${empty requestScope.emp}<ul>
<li>null<ul>
<li>变量的值是null</li>
<li>域对象中不存在这个变量</li>
</ul>
</li>
<li>空集</li>
<li>空数组</li>
<li>空字符串</li>
<li>空字符</li>
</ul>
</li>
</ul>
</li>
<li>三目条件运算：${16&lt;5?’a’:’big’}</li>
</ul>
</li>
<li><strong>获取项目虚拟路径</strong><ul>
<li>获取request对象：${pageContext.request}</li>
<li>获取contextPath：${pageContext.request.contextPath}</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/11/09/tomcat/04_tomcat_%E8%BF%9B%E9%98%B6%E6%94%B9%E9%80%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/11/09/tomcat/04_tomcat_%E8%BF%9B%E9%98%B6%E6%94%B9%E9%80%A0/" class="post-title-link" itemprop="url">04_tomcat_进阶改造</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-11-09 18:12:28" itemprop="dateCreated datePublished" datetime="2019-11-09T18:12:28+08:00">2019-11-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tomcat/" itemprop="url" rel="index">
                    <span itemprop="name">tomcat</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="04-tomcat-进阶改造"><a href="#04-tomcat-进阶改造" class="headerlink" title="04_tomcat_进阶改造"></a>04_tomcat_进阶改造</h1><h2 id="编写BaseServlet"><a href="#编写BaseServlet" class="headerlink" title="编写BaseServlet"></a>编写BaseServlet</h2><p>一个Servlet只有一套doGet和doPost方法，那么如何让一个Servlet处理多个功能：</p>
<ul>
<li><p>第一种就是直接在请求参数里加一个method作为判断，根据判断结果做出对应操作；</p>
<ul>
<li>看上去没问题，但是实际存在很大问题：<ul>
<li>get请求，表单的数据会被带上，但是请求地址的数据会被表单元素覆盖，可以用隐藏的input框来解决。</li>
<li>每个Servlet会存在大量的method判断，存在多个方法；</li>
</ul>
</li>
</ul>
</li>
<li><p>第二种，基于第一种的形式，利用反射解决if判断</p>
<ul>
<li><pre><code class="java"><span class="comment">// 获取该类声明的方法，（方法名，参数...）</span>
Method m = <span class="keyword">this</span>.getClass().getDeclareMethod(method,HttpServletRequest<span class="class">.<span class="keyword">class</span>,<span class="title">HttpServletResponse</span>.<span class="title">class</span>)</span>;
<span class="comment">// 把方法权限设置大</span>
m.setAccessible(<span class="keyword">true</span>);
<span class="comment">// invoke(对象，参数)</span>
m.invoke(<span class="keyword">this</span>,req,resp);
&lt;!--￼<span class="number">0</span>--&gt;</code></pre>
</li>
<li><p>这样，子类只要继承BaseServlet，然后编写相应的方法即可，页面需要调用的之后只要指定方法名就可以。</p>
</li>
</ul>
</li>
</ul>
<h2 id="参数封装优化"><a href="#参数封装优化" class="headerlink" title="参数封装优化"></a>参数封装优化</h2><p>继续抽取一个自动化工具，根据前台传入的参数信息，自动封装数据到对象中，可以用反射来做。</p>
<p>用到apache工具类：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- beanutils --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-beanutils<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-beanutils<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.8.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>WebUtils类：</p>
<p>不用beanutils做：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 传入request对象，将request中的数据封装给对象</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> t</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">param2bean</span><span class="params">(HttpServletRequest req, T t)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 封装对象并返回</span></span><br><span class="line">        <span class="comment">// 1. 获取所有属性</span></span><br><span class="line">        Field[] fields = t.getClass().getFields();</span><br><span class="line">        <span class="comment">// 2. 每个属性都有name值，属性名</span></span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            <span class="comment">// 获取属性名</span></span><br><span class="line">            String name = field.getName();</span><br><span class="line">            <span class="comment">// 在request中根据name取出值</span></span><br><span class="line">            String value = req.getParameter(<span class="string">"name"</span>);</span><br><span class="line">            <span class="comment">// 封装对象（用setAttrName方法）</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是需要做很麻烦的操作，因为request获取的都是String类型，需要做类型判断然后强转；</p>
<p>而beanutils已经做好了这一步，而且不对应类型就不做操作，使用方便；</p>
<p>使用beanutils做：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 传入request对象，将request中的数据封装给对象</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> t</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">param2bean</span><span class="params">(HttpServletRequest req, T t)</span> </span>&#123;</span><br><span class="line">        Field[] fields = t.getClass().getFields();</span><br><span class="line">        <span class="keyword">for</span> (Field field : fields) &#123;</span><br><span class="line">            String name = field.getName();</span><br><span class="line">            String value = req.getParameter(<span class="string">"name"</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                BeanUtils.setProperty(t, name, value);</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>但是还是觉得用了一些底层的反射代码，进行改造：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 传入request对象，将request中的数据封装给对象</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> t</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">param2bean</span><span class="params">(HttpServletRequest req, T t)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// populate将map中的键值对直接映射到javabean中去</span></span><br><span class="line">        Map&lt;String, String[]&gt; parameterMap = req.getParameterMap();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            BeanUtils.populate(t,parameterMap);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IllegalAccessException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InvocationTargetException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> t;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/31/tomcat/03_tomcat_JSP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/31/tomcat/03_tomcat_JSP/" class="post-title-link" itemprop="url">03_tomcat_JSP</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-31 20:38:26" itemprop="dateCreated datePublished" datetime="2019-10-31T20:38:26+08:00">2019-10-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tomcat/" itemprop="url" rel="index">
                    <span itemprop="name">tomcat</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="03-tomcat-JSP"><a href="#03-tomcat-JSP" class="headerlink" title="03_tomcat_JSP"></a>03_tomcat_JSP</h1><p>Java Server Page</p>
<ol>
<li>JSP的本质是一个Servlet，Servlet能做的事情JSP都能做；</li>
<li>JSP能够以HTML页面的方式呈现数据，是一个可以嵌入Java代码的HTML；</li>
<li>JSP不同于HTML，不能使用浏览器直接打开，而必须运行在Servlet容器中；</li>
</ol>
<h2 id="JSP运行原理"><a href="#JSP运行原理" class="headerlink" title="JSP运行原理"></a>JSP运行原理</h2><p>在tomcat的webapp的work目录下，存放着运行时编译的文件，可以在里面看到JSP对应的java文件以及编译完的class文件。</p>
<p><strong>原理就是JSP是java文件；</strong></p>
<p>可以打开JSP对应的java文件，看到里面继承了HttpJspBase类，而HttpJspBase继承自HttpServlet，因此JSP就是一个Servlet。</p>
<p>而JSP是一个Servlet，那么是怎么加入到tomcat容器呢？可以到web.xml中看映射关系，其url-pattern是*.jsp，而其servlet-class是JspServlet，这个类处理所有.jsp结尾的请求。</p>
<p><img src="03_tomcat_JSP/1572527364542.png" alt="1572527364542"></p>
<h2 id="JSP基本语法"><a href="#JSP基本语法" class="headerlink" title="JSP基本语法"></a>JSP基本语法</h2><h3 id="JSP模板元素"><a href="#JSP模板元素" class="headerlink" title="JSP模板元素"></a>JSP模板元素</h3><p>JSP页面中的静态HTML内容称为JSP模板元素；</p>
<h3 id="JSP表达式"><a href="#JSP表达式" class="headerlink" title="JSP表达式"></a>JSP表达式</h3><ul>
<li>&lt;%= %&gt;</li>
</ul>
<p>JSP表达式（expression）提供了将一个Java变量或表达式的计算结果输出到客户端的简化方式，它将要输出的变量或表达式直接装在&lt;%=和%&gt;之中；</p>
<p>例如：Current time:&lt;%=new java.util.Date()%&gt;，注意：不可以写分号(;)，因为被传参到out.print()中的，所以不能够写分号；</p>
<h3 id="JSP脚本片段"><a href="#JSP脚本片段" class="headerlink" title="JSP脚本片段"></a>JSP脚本片段</h3><ul>
<li>&lt;% %&gt;</li>
</ul>
<p>在脚本片段里可以写java代码；</p>
<p>如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">   <span class="attr">int</span> <span class="attr">age</span> = <span class="string">18;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">if</span>(<span class="attr">age</span> &gt;</span>= 18)&#123;</span><br><span class="line">   		out.print("Xxx")</span><br><span class="line">   &#125;else&#123;</span><br><span class="line">    	out.print("Xxx")</span><br><span class="line">   &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<p>脚本片段会被原封不动的复制到.java文件中去。</p>
<p>JSP脚本片段还可以拆分出来写，但是必须要合法而且完整：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">   <span class="attr">int</span> <span class="attr">age</span> = <span class="string">18;</span></span></span><br><span class="line"><span class="tag">   <span class="attr">if</span>(<span class="attr">age</span> &gt;</span>= 18)&#123;</span><br><span class="line">%&gt;</span><br><span class="line">   <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">       你好</span><br><span class="line">    <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span></span></span><br><span class="line"><span class="tag">   &#125;<span class="attr">else</span>&#123;</span></span><br><span class="line"><span class="tag">    	<span class="attr">out.print</span>("<span class="attr">Xxx</span>")</span></span><br><span class="line"><span class="tag">   &#125;</span></span><br><span class="line"><span class="tag">%&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="JSP声明"><a href="#JSP声明" class="headerlink" title="JSP声明"></a>JSP声明</h3><ul>
<li>&lt;%! %&gt;</li>
</ul>
<p>如可以声明变量、方法等，也就是在service()方法外部编写的内容；</p>
<h3 id="JSP指令"><a href="#JSP指令" class="headerlink" title="JSP指令"></a>JSP指令</h3><ul>
<li>&lt;%@ 指令名 属性名=”值” %&gt;</li>
</ul>
<p>例如：</p>
<p><code>&lt;%@ page contentType=&quot;text/html;charset=gb2312&quot;%&gt;</code>：设置响应头信息</p>
<p>属性名部分是大小写敏感的。</p>
<p>JSP2.0中定义了三种指令：page、include、taglib；</p>
<p>三种指令的属性：</p>
<ul>
<li>page（定义页面如何解析）：<ul>
<li>import：用来在页面导包</li>
<li>pageEncoding：指定页面使用的字符集，也是告诉JSP引擎使用指定的编码翻译</li>
<li>contentType：设置响应头，页面如何响应给浏览器</li>
<li>errorPage：指定发生错误去向的页面</li>
<li>isErrorPage：表示当前页面是一个错误页面，可以使用exception对象信息，如：<ul>
<li><code>&lt;%=exception.getMessage()%&gt;</code>获取错误信息</li>
</ul>
</li>
<li>session：默认是true，当前页面是否参与会话，也就是是否可以使用session对象；</li>
<li>isELIgnored：是否忽略EL表达式，默认是false（不忽略）；</li>
<li>info：定义页面的信息（描述信息），在getServletInfo()里面return的信息；</li>
</ul>
</li>
<li>include（静态包含）：<ul>
<li><code>&lt;%@ include 属性名=&quot;属性值&quot;%&gt;</code>，可以把另一个页面包含进来，采用的方式是将整个页面复制到service方法里，这里不编译include的页面；</li>
</ul>
</li>
<li>taglib：在页面引入标签库：<ul>
<li>&lt;%@ taglib 属性名=属性值%&gt;</li>
</ul>
</li>
</ul>
<h3 id="JSP标签"><a href="#JSP标签" class="headerlink" title="JSP标签"></a>JSP标签</h3><p>JSP中内置了很多标签，每个标签都有不同的功能，就是执行一段代码；</p>
<ul>
<li><code>&lt;jsp:include&gt;</code>：也是在页面包含另外一个页面，<strong>动态包含</strong><ul>
<li>page：页面路径</li>
<li>把要包含的页面先翻译出来，再编译出来，再包含。</li>
</ul>
</li>
<li><code>&lt;jsp:forward page=&quot;Xxx.jsp&quot;&gt;</code>：要转发的页面<ul>
<li><code>&lt;jsp:param name=&quot;&quot; value=&quot;&quot;&gt;</code>：子标签，转发的时候带的参数；在请求中看不出来，而在后台实际上可以取得，因为是在父页面进行的请求，而设置参数的是在父页面jsp的servlet里，所以参数是在中途设置进去的。</li>
</ul>
</li>
</ul>
<h3 id="JSP九大隐含对象"><a href="#JSP九大隐含对象" class="headerlink" title="JSP九大隐含对象"></a>JSP九大隐含对象</h3><p>包括五个常规对象以及四个域对象；</p>
<p>是我们在页面可以直接进行使用的对象。</p>
<ul>
<li>PageContext pageContext：代表当前页面对象</li>
<li>HttpSession session：代表会话对象</li>
<li>Throwable exception：代表当前页面捕获的异常对象</li>
<li>ServletContext application：代表整个Web应用</li>
<li>ServletConfig config：代表Servlet配置信息</li>
<li>JspWriter out：代表可以在页面输出数据的out对象</li>
<li>Object page = this：代表当前这个Servlet对象</li>
<li>HttpServletRequest request：代表封装当次请求详细信息的对象</li>
<li>HttpServletResponse response：代表当次响应的对象</li>
</ul>
<h4 id="五个常规对象"><a href="#五个常规对象" class="headerlink" title="五个常规对象"></a>五个常规对象</h4><ul>
<li>exception</li>
<li>config</li>
<li>out</li>
<li>page</li>
<li>response</li>
</ul>
<p><img src="03_tomcat_JSP/1572700279509.png" alt="1572700279509"></p>
<p>out.write()和response.getWriter().write()，如果out没有调用flush()方法，会导致response永远输出在out之前。</p>
<p><strong>原理：</strong></p>
<p>out会写入到JspWriter对象的缓冲区，response会写入到response的缓冲区，而JspWriter缓冲区的东西会塞到response缓冲区，所以显示的时候是response在前。</p>
<p>所以如果要保证顺序，要在out调用完write之后再调用flush()方法。</p>
<h4 id="四大域对象"><a href="#四大域对象" class="headerlink" title="四大域对象"></a>四大域对象</h4><p>域对象用来在其他资源共享数据</p>
<ul>
<li><p>pageContext</p>
<ul>
<li>getXxx方法可以获取所有其他的隐含对象</li>
<li>作为域对象共享数据：只能在<strong>当前页面共享数据</strong>，离开页面就无法共享。</li>
<li>通过setAttribute(key,value)共享内容；</li>
<li>通过getAttribute(key)获取内容；</li>
</ul>
</li>
<li><p>request</p>
<ul>
<li>在同一个请求对象中共享数据，只要是同一次请求，就可以共享数据（请求转发可以共享，而重定向不行）</li>
</ul>
</li>
<li><p>session</p>
<ul>
<li>同一次会话共享数据，也就是打开浏览器——开始会话，关闭浏览器——结束会话</li>
</ul>
</li>
<li><p>application</p>
<ul>
<li>代表当前应用，只要在同一个Web应用中都可以共享数据，Web应用只要不卸载，都可以访问到。</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>域对象</th>
<th>作用范围</th>
<th>起始时间</th>
<th>结束时间</th>
</tr>
</thead>
<tbody><tr>
<td>pageContext</td>
<td>当前JSP页面</td>
<td>页面加载</td>
<td>离开页面</td>
</tr>
<tr>
<td>request</td>
<td>同一个请求</td>
<td>收到请求</td>
<td>响应</td>
</tr>
<tr>
<td>session</td>
<td>同一个会话</td>
<td>开始会话</td>
<td>结束会话</td>
</tr>
<tr>
<td>application</td>
<td>当前Web应用</td>
<td>Web应用加载</td>
<td>Web应用卸载</td>
</tr>
</tbody></table>
<h2 id="获取Base路径"><a href="#获取Base路径" class="headerlink" title="获取Base路径"></a>获取Base路径</h2><ul>
<li><p>request.getScheme()：获取协议名(http)</p>
</li>
<li><p>request.getServerName()：获取服务器名</p>
</li>
<li><p>request.getServerPort()：获取服务器端口</p>
</li>
<li><p>request.getContentPath()：获取项目上下文路径</p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/27/tomcat/02_tomcat_Servlet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/27/tomcat/02_tomcat_Servlet/" class="post-title-link" itemprop="url">02_tomcat_Servlet</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-27 10:48:40" itemprop="dateCreated datePublished" datetime="2019-10-27T10:48:40+08:00">2019-10-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tomcat/" itemprop="url" rel="index">
                    <span itemprop="name">tomcat</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="02-tomcat-Servlet"><a href="#02-tomcat-Servlet" class="headerlink" title="02_tomcat_Servlet"></a>02_tomcat_Servlet</h1><p>定义：</p>
<ul>
<li>从广义上来讲，Servlet规范是Sun公司制定的一套技术标准，包含与Web应用相关的一系列接口，是Web应用实现方式的宏观解决方案。而具体的Servlet容器负责提供标准的实现。</li>
<li>从狭义上来讲，Servlet指的是javax.serlvet.Servlet接口及其子接口，也可以指实现了Servlet接口的实现类。</li>
<li>Servlet作为服务器端的一个组件，它的本意是“服务器端的小程序”。Servlet的实例对象由Servlet容器负责创建；Servlet的方法由容器在特定情况下调用；Servlet容器会在Web应用卸载的时候销毁Servlet对象的实例。</li>
</ul>
<p>官方文档：一个servlet就是一个小java程序，servelt运行在web服务器，servlet接收和响应来自客户端的请求，通过http；</p>
<p>作用：</p>
<ul>
<li>接收请求</li>
<li>处理请求</li>
<li>完成响应</li>
</ul>
<h2 id="HelloWorld"><a href="#HelloWorld" class="headerlink" title="HelloWorld"></a>HelloWorld</h2><p>编写Servlet三步：</p>
<ol>
<li>创建自己的类HelloServlet，实现Servlet接口</li>
<li>实现service方法</li>
<li>在web.xml中配置servlet信息</li>
</ol>
<p>测试：运行项目，在浏览器访问配置的url</p>
<p>代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> top.tomxwd.servlet;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Enumeration;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 一个Servlet只能处理一个指定的请求，</span></span><br><span class="line"><span class="comment"> * 应该指定servlet处理哪个请求，</span></span><br><span class="line"><span class="comment"> * 需要在web.xml文件里面配置servlet的详细信息</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xieweidu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@createDate</span> 2019-10-27 11:12</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloServlet</span> <span class="keyword">implements</span> <span class="title">Servlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 初始化</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> config</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        Enumeration&lt;String&gt; names = config.getInitParameterNames();</span><br><span class="line">        <span class="keyword">while</span> (names.hasMoreElements()) &#123;</span><br><span class="line">            String name = names.nextElement();</span><br><span class="line">            System.out.println(<span class="string">"name = "</span> + name);</span><br><span class="line">            String initParameter = config.getInitParameter(name);</span><br><span class="line">            System.out.println(<span class="string">"initParameter = "</span> + initParameter);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">"-------------------"</span>);</span><br><span class="line">        ServletContext servletContext = config.getServletContext();</span><br><span class="line">        System.out.println(<span class="string">"servletContext.getContextPath() = "</span> + servletContext.getContextPath());</span><br><span class="line">        System.out.println(<span class="string">"-------------------"</span>);</span><br><span class="line">        System.out.println(<span class="string">"config.getServletName() = "</span> + config.getServletName());</span><br><span class="line">        System.out.println(<span class="string">"初始化方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取Servlet配置信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ServletConfig <span class="title">getServletConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 服务</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> req</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> res</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ServletException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">service</span><span class="params">(ServletRequest req, ServletResponse res)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        <span class="comment">// service方法是用来处理来自客户端的请求</span></span><br><span class="line">        System.out.println(<span class="string">"我是HelloServlet！！！"</span>);</span><br><span class="line">        <span class="comment">// res用于响应浏览器</span></span><br><span class="line">        res.getWriter().println(<span class="string">"123"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取Servlet信息，没什么用，直接返回一个String作为描述信息</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getServletInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"HelloServlet信息"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 销毁方法</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"销毁方法"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">"4.0"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 在servlet标签里配置servlet的类信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置servlet的名字 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>helloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 配置servlet类的全名 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>top.tomxwd.servlet.HelloServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- servlet映射信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- servlet的名字 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>helloServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 这个servlet用来处理哪个请求 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/hello<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>pom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- servlet --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- jsp --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>javax.servlet.jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- jstl --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="Servlet详解"><a href="#Servlet详解" class="headerlink" title="Servlet详解"></a>Servlet详解</h2><p>在web.xml中配置的servlet-class标签指定全类名是为了让服务器通过全类名找到Servlet，通过反射创建实例。</p>
<p>web.xml关于servlet与servlet-mapping标签，servlet是给服务器反射创建实例，而servlet-mapping是用来指定servlet处理哪个请求。</p>
<p>在地址栏输入一个地址的时候经过的步骤：</p>
<ol>
<li>用户在浏览器地址栏输入：<a href="http://localhost:8080/hello请求，首先找是否有动态资源对应，没有就找静态资源。" target="_blank" rel="noopener">http://localhost:8080/hello请求，首先找是否有动态资源对应，没有就找静态资源。</a></li>
<li>然后在url-pattern找是否有相应的映射地址，如果没有则404，如果有就找相应的servlet-name，通过servlet-name找到servlet的信息。</li>
<li>那么找到servlet的信息，就可以找到servlet的类，然后初始化–&gt;调用service方法。</li>
</ol>
<h3 id="Servlet生命周期"><a href="#Servlet生命周期" class="headerlink" title="Servlet生命周期"></a>Servlet生命周期</h3><p>Servlet是跑在Tomcat服务器上的。</p>
<p>Tomcat服务器—-&gt;Servlet容器；</p>
<p>Servlet的生命周期，Servlet从创建到销毁的过程。</p>
<p>当我们第一次访问HelloServlet的时候：</p>
<ol>
<li>创建一个Servlet对象</li>
<li>调用Init方法，进行初始化</li>
<li>调用service方法</li>
<li>第n次调用，就只调用service方法来处理请求，整个运行期间只创建了一个servlet对象（<strong>单实例、多线程</strong>），因此不能写共享变量。</li>
<li>正常停止服务器的时候会调用destory方法</li>
</ol>
<h3 id="ServletConfig对象"><a href="#ServletConfig对象" class="headerlink" title="ServletConfig对象"></a>ServletConfig对象</h3><p>ServletConfig封装的了当前servlet的配置信息。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取servelt的名字</span></span><br><span class="line">String servletName = config.getServletName();</span><br><span class="line">System.out.println(<span class="string">"servletName = "</span> + servletName);</span><br><span class="line">System.out.println(<span class="string">"------------------------------------"</span>);</span><br><span class="line"><span class="comment">// 获取servlet初始化参数</span></span><br><span class="line">String username = config.getInitParameter(<span class="string">"username"</span>);</span><br><span class="line">System.out.println(<span class="string">"username = "</span> + username);</span><br><span class="line">System.out.println(<span class="string">"------------------------------------"</span>);</span><br><span class="line"><span class="comment">// 获取servlet上下文，代表当前的Web项目信息（一个web项目只有一个servletContext）</span></span><br><span class="line">ServletContext servletContext = config.getServletContext();</span><br></pre></td></tr></table></figure>

<p><strong>一个Servlet有一个ServletConfig对象，一个Web项目只有一个ServletContext对象。</strong></p>
<p>主要就是三个方法：</p>
<ol>
<li>获取servlet的名字</li>
<li>获取servlet初始化参数</li>
<li>获取servlet的上下文对象</li>
</ol>
<h3 id="ServletContext对象"><a href="#ServletContext对象" class="headerlink" title="ServletContext对象"></a>ServletContext对象</h3><p>一个Web项目只有一个ServeltContext对象，代表整个Web项目；</p>
<p>作用：</p>
<ol>
<li><p>可以获取web项目的配置信息</p>
<ul>
<li><p>在web.xml配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 配置web项目初始化参数 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>user<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>用ServletContext的getInitParameter()方法只能获取到web项目的初始化参数，而不能拿到servlet的初始化参数。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(ServletConfig config)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">    ServletContext servletContext = config.getServletContext();</span><br><span class="line">    Enumeration&lt;String&gt; initParameterNames = servletContext.getInitParameterNames();</span><br><span class="line">    <span class="keyword">while</span> (initParameterNames.hasMoreElements())&#123;</span><br><span class="line">        String name = initParameterNames.nextElement();</span><br><span class="line">        String initParameter = servletContext.getInitParameter(name);</span><br><span class="line">        System.out.println(<span class="string">"----------------------------------"</span>);</span><br><span class="line">        System.out.println(<span class="string">"name = "</span> + name);</span><br><span class="line">        System.out.println(<span class="string">"initParameter = "</span> + initParameter);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>可以获取web项目的路径getContextPath()</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String contextPath = servletContext.getContextPath();</span><br><span class="line">System.out.println(<span class="string">"contextPath = "</span> + contextPath);</span><br></pre></td></tr></table></figure>
</li>
<li><p>获取资源的真实路径getRealPath()</p>
<ul>
<li>虚拟路径：是网络访问使用的，每一个虚拟路径应该对应一个实际的资源。<ul>
<li>静态资源：文件的形式</li>
<li>动态资源：只是启动一段程序代码</li>
</ul>
</li>
<li>真实路径：文件在磁盘中的存储路径</li>
</ul>
</li>
<li><p>作为最大的域对象共享数据</p>
<ul>
<li>域对象：共享数据（跨区域共享数据）四大作用域对象<ul>
<li>application域对象</li>
</ul>
</li>
</ul>
</li>
</ol>
<h3 id="HttpServlet"><a href="#HttpServlet" class="headerlink" title="HttpServlet"></a>HttpServlet</h3><p>HttpServlet是专门为了处理Http请求定制的Servlet</p>
<p>继承关系图：</p>
<p><img src="02_tomcat_Servlet/1572170781600.png" alt="1572170781600"></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet</span>(<span class="string">"/http"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HttpTestServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">HttpTestServlet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>();</span><br><span class="line">        System.out.println(<span class="string">"构造器"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doGet"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doPost"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到调用的是doGet或者doPost方法，但是实际上我们知道需要调用的是Servlet接口的service方法才对。 </p>
<p>原理：</p>
<p><img src="02_tomcat_Servlet/1572171794000.png" alt="1572171794000"></p>
<p>我们知道其实是调用service方法来处理请求的，但是从类继承图上看，以及跟入代码之后可以发现，顺序是Servlet接口service被调用，但是GenericServlet将service方法声明为抽象方法，所以HttpServlet对service方法进行实现，而service方法又调用了本地的service重载方法，再在这个重载的方法里判断method，然后调用指定的doGet或者doPost方法来进行处理请求。</p>
<h3 id="HttpServletRequest和HttpServletResponse"><a href="#HttpServletRequest和HttpServletResponse" class="headerlink" title="HttpServletRequest和HttpServletResponse"></a>HttpServletRequest和HttpServletResponse</h3><p>HttpServletRequest代表就是封装浏览器请求信息的对象，收到的浏览器的请求。</p>
<p>HttpServletResponse代表的就是发送浏览器的响应对象，封装了响应信息。</p>
<p>request：</p>
<ul>
<li><p>正常的http请求：</p>
<ul>
<li>请求首行（get请求封装的参数在url里）</li>
<li>请求头</li>
<li>空行</li>
<li>请求体（封装的请求参数-post）</li>
</ul>
</li>
<li><p>获取参数：</p>
<ul>
<li>req.getParameter(“username”)：返回一个String</li>
<li>req.getParameterValues(“username”)：返回一个String数组</li>
</ul>
</li>
<li><p>获取请求头相关信息：</p>
<ul>
<li>req.getHeader(“User-Agent”);</li>
</ul>
</li>
<li><p>转发一个页面/资源</p>
<ul>
<li><pre><code class="java">RequestDispatcher requestDispatcher = req.getRequestDispatcher(<span class="string">"index.jsp"</span>);
requestDispatcher.forward(req,resp);
&lt;!--￼<span class="number">8</span>--&gt;
</code></pre>
</li>
</ul>
</li>
</ul>
<p>或者：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.setContentType(<span class="string">"text/html;charset=utf-8"</span>);</span><br></pre></td></tr></table></figure>

<p>或者：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">resp.setHeader(<span class="string">"Content-Type"</span>,<span class="string">"text/html;charset=utf-8"</span>);</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>必须在获取流之前设置字符编码以及内容类型。</p>
<h2 id="Get-Post请求乱码"><a href="#Get-Post请求乱码" class="headerlink" title="Get\Post请求乱码"></a>Get\Post请求乱码</h2><h3 id="Get乱码原因"><a href="#Get乱码原因" class="headerlink" title="Get乱码原因"></a>Get乱码原因</h3><p>浏览器对URL进行编码，而服务器对URL进行解码。因为在进入到具体的代码之前，URL就已经被服务器解码过了，所以设置request是没有作用的，因此用req.setCharacterEncoding(“utf-8”)并不能解决get方法乱码问题。</p>
<p>那么就需要在服务器对URL进行解析之前，设置UTF-8编码即可。</p>
<p>解决：</p>
<p>在服务器的配置目录里<strong>修改server.xml</strong>配置文件。</p>
<p>我们知道监听的是8080端口，而就是这个地方对URL进行接收并解析，所以修改：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span> <span class="attr">redirectPort</span>=<span class="string">"8443"</span> <span class="attr">URIEncoding</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br></pre></td></tr></table></figure>



<h3 id="Post乱码原因"><a href="#Post乱码原因" class="headerlink" title="Post乱码原因"></a>Post乱码原因</h3><p>浏览器将数据编码并提交给服务器，而服务器并不知道编码规则造成乱码；</p>
<p>解决：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">req.setCharacterEncoding(<span class="string">"utf-8"</span>);</span><br></pre></td></tr></table></figure>

<p><strong>注意：</strong>必须要在取数据之前设置，否则取出来的还是乱码。</p>
<h2 id="项目路径问题"><a href="#项目路径问题" class="headerlink" title="项目路径问题"></a>项目路径问题</h2><p>绝对路径以/开始，也就是从根开始，那么就不会带上上下文路径了，所以需要用/上下文路径/资源路径；</p>
<p>请求转发，是从项目的根目录开始，所以不用加上下文路径；</p>
<p>重定向是从服务器的根目录开始，需要拼上上下文路径才行；</p>
<p>理由很简单，请求转发是服务器在做处理，那么上下文路径是可以确定的，而重定向是交给浏览器去做处理，所以需要再拼上上下文路径才行。</p>
<h3 id="获取项目上下文路径的几种方式"><a href="#获取项目上下文路径的几种方式" class="headerlink" title="获取项目上下文路径的几种方式"></a>获取项目上下文路径的几种方式</h3><ol>
<li><code>String contextPath = req.getContextPath();</code></li>
<li><code>String contextPath = getServletContext().getContextPath();</code></li>
</ol>
<h3 id="base标签"><a href="#base标签" class="headerlink" title="base标签"></a>base标签</h3><p>可以指定页面上所有路径的基础路径，所有路径都是以指定的基础路径开始，只有<strong>相对路径</strong>的写法，会按照base标签指定的基础路径来拼接新的路径。</p>
<p>在页面的head标签内加入：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">"http://localhost:8080/test/"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>也就是说以后所有的相对路径参考的都是base标签指定的路径，而不是当前资源。</p>
<h2 id="类加载器加载资源"><a href="#类加载器加载资源" class="headerlink" title="类加载器加载资源"></a>类加载器加载资源</h2><p>由于发布到服务器上之后，不可以用new File()来读取配置文件(.properties)信息，所以要用：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">properties.load(Xxx.class.getClassLoader().getResourceAsStream("jdbc.properties"));</span><br></pre></td></tr></table></figure>

<p>可以看到是在WEB-INF/classes目录下，也就是类路径下进行加载；</p>
<p><strong>注意：</strong>不可以用系统的类加载器。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/26/tomcat/01_tomcat_%E7%AE%80%E4%BB%8B_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/26/tomcat/01_tomcat_%E7%AE%80%E4%BB%8B_%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="post-title-link" itemprop="url">01_tomcat_简介_环境搭建</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-26 17:25:02" itemprop="dateCreated datePublished" datetime="2019-10-26T17:25:02+08:00">2019-10-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/tomcat/" itemprop="url" rel="index">
                    <span itemprop="name">tomcat</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="01-tomcat-简介-环境搭建"><a href="#01-tomcat-简介-环境搭建" class="headerlink" title="01_tomcat_简介_环境搭建"></a>01_tomcat_简介_环境搭建</h1><blockquote>
<p><a href="https://tomcat.apache.org/" target="_blank" rel="noopener">apache tomcat官网</a></p>
<p><a href="https://archive.apache.org/dist/tomcat/" target="_blank" rel="noopener">各个版本下载地址</a></p>
</blockquote>
<p>Web服务器主要用来接收客户端发送的请求和响应客户端发送的请求。</p>
<h2 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h2><p>先要有JAVA_HOME，然后在tomcat的bin下有启动文件。</p>
<h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><table>
<thead>
<tr>
<th>目录名</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>bin</td>
<td>包含tomcat启动命令、停止tomcat命令等批处理文件，可执行文件</td>
</tr>
<tr>
<td>conf</td>
<td>配置文件</td>
</tr>
<tr>
<td>lib</td>
<td>tomcat运行依赖的jar包</td>
</tr>
<tr>
<td>logs</td>
<td>tomcat的运行日志文件</td>
</tr>
<tr>
<td>temp</td>
<td>tomcat的临时文件夹</td>
</tr>
<tr>
<td>webapps</td>
<td>里面集合了所有的web项目每一个文件夹就代表一个web项目（默认访问ROOT目录）</td>
</tr>
<tr>
<td>work</td>
<td>work保存的tomcat运行时编译好的一些文件</td>
</tr>
</tbody></table>
<h2 id="修改端口号"><a href="#修改端口号" class="headerlink" title="修改端口号"></a>修改端口号</h2><p>conf目录下：</p>
<p>server.xml配置文件，上限是65535</p>
<h2 id="对应版本关系"><a href="#对应版本关系" class="headerlink" title="对应版本关系"></a>对应版本关系</h2><table>
<thead>
<tr>
<th>tomcat版本</th>
<th>servlet版本</th>
<th>jsp版本</th>
<th>el版本</th>
<th>websocket版本</th>
</tr>
</thead>
<tbody><tr>
<td>tomcat6</td>
<td>servlet2.5</td>
<td>jsp2.1</td>
<td>el</td>
<td></td>
</tr>
<tr>
<td>tomcat7</td>
<td>servlet3.0</td>
<td>jsp2.2</td>
<td>el2.2</td>
<td>websocket1.1</td>
</tr>
<tr>
<td>tomcat8</td>
<td>servlet3.1</td>
<td>jsp2.3</td>
<td>el3.0</td>
<td>websocket1.1</td>
</tr>
<tr>
<td>tomcat9</td>
<td>servlet4.0</td>
<td>jsp2.3</td>
<td>el3.0</td>
<td>websocket1.1</td>
</tr>
</tbody></table>
<p>tomcat6是需要些配置文件的版本，tomcat7之后都是基于注解的，所以tomcat6可以体会一下配置文件来编写web应用。</p>
<h2 id="eclipse集成tomcat"><a href="#eclipse集成tomcat" class="headerlink" title="eclipse集成tomcat"></a>eclipse集成tomcat</h2><p>集成使用的是tomcat的镜像，所以webapps目录下是空的，而且该其配置文件并不会对本机下载的tomcat产生影响。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/26/XML/01_XML_%E8%AE%A4%E8%AF%86XML/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/26/XML/01_XML_%E8%AE%A4%E8%AF%86XML/" class="post-title-link" itemprop="url">01_XML_认识XML</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-26 12:57:43" itemprop="dateCreated datePublished" datetime="2019-10-26T12:57:43+08:00">2019-10-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/XML/" itemprop="url" rel="index">
                    <span itemprop="name">XML</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="01-XML-认识XML"><a href="#01-XML-认识XML" class="headerlink" title="01_XML_认识XML"></a>01_XML_认识XML</h1><h2 id="xml简介"><a href="#xml简介" class="headerlink" title="xml简介"></a>xml简介</h2><ul>
<li><p>xml，eXtensible Markup Language，可扩展标记语言，是一种标记语言。</p>
</li>
<li><p>xml是一种非常灵活的语言，没有固定的标签，所有的标签都可以自定义；</p>
</li>
<li><p>通常，xml被用于信息的记录和传递，因此xml经常被用于充当配置文件；</p>
</li>
</ul>
<h2 id="格式良好的xml格式"><a href="#格式良好的xml格式" class="headerlink" title="格式良好的xml格式"></a>格式良好的xml格式</h2><ul>
<li>XML编辑器<ul>
<li>记事本</li>
<li>Dreamweaver</li>
<li>XMLSpy</li>
</ul>
</li>
</ul>
<ul>
<li>格式良好的XML文档：遵循XML文档的基本规则<ul>
<li>必须有XML声明语句</li>
<li>必须<strong>有且仅有一个根元素</strong></li>
<li>标签大小写敏感</li>
<li>属性值用双引号</li>
<li>标签成对</li>
<li>元素正确嵌套</li>
</ul>
</li>
<li>有效的XML文档<ul>
<li>首先必须是格式良好的</li>
<li>使用DTD和XSD（XML Schema）定义语义约束</li>
</ul>
</li>
</ul>
<ul>
<li><p>声明信息，用于描述xml的版本和编码方式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>xml有且仅有一个根元素；</p>
</li>
<li><p>xml是大小写敏感的；</p>
</li>
<li><p>标签是成对的，而且要正确嵌套；</p>
</li>
<li><p>属性值要使用双引号；</p>
</li>
<li><p>注释的写法：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--注释--&gt;</span></span><br></pre></td></tr></table></figure>




</li>
</ul>
<h2 id="XML解析"><a href="#XML解析" class="headerlink" title="XML解析"></a>XML解析</h2><ul>
<li>dom：（Document Object Model，文档对象模型）是W3C组织推荐的处理XML的一种方式，下面有两个分支：jDom和dom4j，可以对XML文件进行增删改查的操作；<ul>
<li>Dom4j：dom下的一个分支。我们常用dom4j替换原生dom解析。</li>
</ul>
</li>
<li>sax：（Simple API for XML）不是官方标准，但是XML社区事实上的标准，几乎所有的XML解析器都支持它，只能进行解析（查询）；<ul>
<li>pull：Pull解析和Sax解析很相似，都是轻量级的解析，它是一个第三方开源的Java项目，但是在Android的内核中已经嵌入了Pull，只能进行解析（查询）；</li>
</ul>
</li>
</ul>
<p><img src="01_XML_%E8%AE%A4%E8%AF%86XML/1572066727188.png" alt="1572066727188"></p>
<h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>dom4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>dom4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol>
<li>导入dom解析包dom4j</li>
<li>创建有个车SAXReader（一个xml文档阅读器）</li>
<li>使用reader读取文件，返回一个document对象</li>
<li>获取到document以后就可以执行增删改查</li>
<li>先要获取根节点</li>
<li>使用根节点继续往下找</li>
</ol>
<ul>
<li>getName()：获取元素名</li>
<li>getText()：获取元素里面的文本值</li>
<li>attributeValue(“属性名”)：获取元素的属性值</li>
<li>elementText(“标签名”)：获取ele子元素为标签名的文本值</li>
<li>element()：找到第一个子元素(可带参数)</li>
<li>elements()：找到所有子元素</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test1</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    SAXReader saxReader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">    Document document = saxReader.read(<span class="keyword">new</span> File(<span class="string">"classpath:student.xml"</span>));</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test2</span><span class="params">()</span> <span class="keyword">throws</span> DocumentException </span>&#123;</span><br><span class="line">    SAXReader saxReader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">    Document document = saxReader.read(<span class="keyword">new</span> File(<span class="string">"E:\\IDEA_PROJECT\\JAVA_WEB\\xml-test\\src\\main\\resources\\student.xml"</span>));</span><br><span class="line">    Element rootElement = document.getRootElement();</span><br><span class="line">    System.out.println(<span class="string">"rootElement.getName() = "</span> + rootElement.getName());</span><br><span class="line">    <span class="comment">// 获取当前结点下的所有子节点</span></span><br><span class="line">    List&lt;Element&gt; elements = rootElement.elements();</span><br><span class="line"></span><br><span class="line">    elements.stream().forEach(e-&gt; &#123;</span><br><span class="line">        System.out.println(<span class="string">"e.getName() = "</span> + e.getName());</span><br><span class="line">        System.out.println(<span class="string">"e.attributeValue(\"id\") = "</span> + e.attributeValue(<span class="string">"id"</span>));</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * xml转对象</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test3</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    SAXReader saxReader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">    Document read = saxReader.read(<span class="keyword">new</span> File(<span class="string">"E:\\IDEA_PROJECT\\JAVA_WEB\\xml-test\\src\\main\\resources\\student.xml"</span>));</span><br><span class="line">    Element rootElement = read.getRootElement();</span><br><span class="line">    <span class="comment">// 遍历--&gt;封装</span></span><br><span class="line">    ArrayList&lt;Student&gt; students = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    ((List&lt;Element&gt;)rootElement.elements()).stream().forEach(e-&gt;&#123;</span><br><span class="line">        Student student = <span class="keyword">new</span> Student();</span><br><span class="line">        student.setId(e.attributeValue(<span class="string">"id"</span>));</span><br><span class="line">        student.setName(e.elementText(<span class="string">"name"</span>));</span><br><span class="line">        student.setAge(e.elementText(<span class="string">"age"</span>));</span><br><span class="line">        students.add(student);</span><br><span class="line">    &#125;);</span><br><span class="line">    students.forEach(e-&gt; System.out.println(<span class="string">"student = "</span> + e));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> Exception</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test4</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</span><br><span class="line">    SAXReader saxReader = <span class="keyword">new</span> SAXReader();</span><br><span class="line">    Document document = saxReader.read(<span class="keyword">new</span> File(<span class="string">"E:\\IDEA_PROJECT\\JAVA_WEB\\xml-test\\src\\main\\resources\\student.xml"</span>));</span><br><span class="line">    Element rootElement = document.getRootElement();</span><br><span class="line">    <span class="comment">// 获取到的是第一个student</span></span><br><span class="line">    Element student = rootElement.element(<span class="string">"student"</span>);</span><br><span class="line">    <span class="comment">// 改student的name为张三三</span></span><br><span class="line">    Element name = student.element(<span class="string">"name"</span>);</span><br><span class="line">    System.out.println(<span class="string">"name.getText() = "</span> + name.getText());</span><br><span class="line">    name.setText(<span class="string">"张三三"</span>);</span><br><span class="line">    name.addAttribute(<span class="string">"name"</span>,<span class="string">"zhangzhang"</span>);</span><br><span class="line">    <span class="comment">// 保存修改</span></span><br><span class="line">    <span class="comment">// OutputFormat输出格式化</span></span><br><span class="line">    OutputFormat prettyPrint = OutputFormat.createPrettyPrint();</span><br><span class="line">    XMLWriter writer = <span class="keyword">new</span> XMLWriter(<span class="keyword">new</span> FileOutputStream(<span class="string">"E:\\IDEA_PROJECT\\JAVA_WEB\\xml-test\\src\\main\\resources\\student.xml"</span>),prettyPrint);</span><br><span class="line">    writer.write(document);</span><br><span class="line">    writer.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="xPath"><a href="#xPath" class="headerlink" title="xPath"></a>xPath</h2><p>xPath是在XML文档中查找信息的语言。</p>
<p>xPath是通过元素和属性进行查找。</p>
<p>xPath简化了Dom4j查找节点的过程。</p>
<p>使用xPath必须导入jaxen-1.1-beta-6.jar</p>
<p>否则出现NoClassDefFoundError：org/jaxen/JaxenException</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jaxen<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxen<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>语法：</p>
<table>
<thead>
<tr>
<th>使用</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>/student/student</td>
<td>从根元素开始逐层找，以”/“开头</td>
</tr>
<tr>
<td>开头//name</td>
<td>直接获取所有name元素对象，以”//“开头</td>
</tr>
<tr>
<td>//student/*</td>
<td>获取所有student元素的所有子元素对象</td>
</tr>
<tr>
<td>//student[1] 或者 //student[last()]</td>
<td>获取所有student元素的第一个或最后一个元素</td>
</tr>
<tr>
<td>//student[@id]</td>
<td>获取所有带id属性的student元素对象</td>
</tr>
<tr>
<td>//student[@id=’002’]</td>
<td>获取id等于002的student元素对象</td>
</tr>
<tr>
<td>//student[not(@*)]</td>
<td>获取所有student元素下不包含属性的元素对象</td>
</tr>
</tbody></table>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/20/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/01_%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E8%BF%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/20/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/01_%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E8%BF%B0/" class="post-title-link" itemprop="url">01_计算机网络概述</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-20 19:30:12" itemprop="dateCreated datePublished" datetime="2019-10-20T19:30:12+08:00">2019-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:17" itemprop="dateModified" datetime="2019-11-16T17:59:17+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index">
                    <span itemprop="name">计算机网络</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="01-计算机网络概述"><a href="#01-计算机网络概述" class="headerlink" title="01_计算机网络概述"></a>01_计算机网络概述</h1><h2 id="计算机网络在信息时代的作用"><a href="#计算机网络在信息时代的作用" class="headerlink" title="计算机网络在信息时代的作用"></a>计算机网络在信息时代的作用</h2><ul>
<li>网络：许多计算机连接在一起</li>
<li>互联网：internet，许多网络连接在一起</li>
<li>因特网：Internet，全球最大的一个互联网</li>
</ul>
<p>作用范围：</p>
<p>新的理解：不单单从网络覆盖范围区分局域网和广域网，应用了广域网技术就是广域网，应用了局域网技术就是局域网。</p>
<ul>
<li><p>局域网：自己购买设备，自己维护，带宽固定100M，1000M，距离100米内。</p>
</li>
<li><p>广域网：花钱买服务，花钱买带宽</p>
</li>
</ul>
<p>OSI 7层</p>
<ul>
<li>应用层：能够产生网络流量，能够和用户交互的应用程序。</li>
<li>表示层：加密、压缩，开发人员需要考虑的问题。</li>
<li>会话层：服务和客户端建立的会话（查木马netstat -nb）</li>
<li>传输层：可靠传输（需要建立会话）、不可靠传输（不需要建立会话）、流量控制</li>
<li>网络层：IP地址编址，选择最佳路径</li>
<li>数据链路层：数据如何封装，添加物理层地址MAC地址</li>
<li>物理层：电压、接口标准</li>
</ul>
<p>网络排错：</p>
<p>从底层到高层；</p>
<p>网络安全和OSI参考模型</p>
<ul>
<li><p>物理层安全</p>
</li>
<li><p>数据链路安全，ADSL，AP密码</p>
</li>
<li><p>网络层安全</p>
</li>
<li><p>应用层安全（SQL注入漏洞，上传漏洞</p>
</li>
</ul>
<p><img src="01_%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E8%BF%B0/1571667146060.png" alt="1571667146060"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/20/Spring/Spring%E6%BA%90%E7%A0%81/02_Spring_IOC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/20/Spring/Spring%E6%BA%90%E7%A0%81/02_Spring_IOC/" class="post-title-link" itemprop="url">02_Spring_IOC</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-20 16:51:29" itemprop="dateCreated datePublished" datetime="2019-10-20T16:51:29+08:00">2019-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring%E6%BA%90%E7%A0%81/" itemprop="url" rel="index">
                    <span itemprop="name">spring源码</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="02-Spring-IOC"><a href="#02-Spring-IOC" class="headerlink" title="02_Spring_IOC"></a>02_Spring_IOC</h1><ol>
<li><p>为什么我们要使用Spring呢？</p>
<ul>
<li><p>为什么用IOC？</p>
<p>在没有IOC之前，使用的是内部创建的方式来管理对象，这样会导致创建出来的对象很多，每次依赖到对象都要去new，而且依赖关系复杂。</p>
</li>
<li><p>如何设计IOC容器？</p>
<p>对于上面的<strong>依赖对象多次创建问题</strong>，可以用单例，工厂模式等设计模式来解决（beanFactory）</p>
<p>容器要去统一对象的构建方式，通过反射、单例、工厂模式</p>
<p>对于上面的<strong>依赖关系复杂问题</strong>，可以用外部传入对象方式解决依赖问题（构造器、方法传参、属性、反射）    </p>
</li>
<li><p>SpringIOC如何做的？</p>
<p><strong>统一负责对象的创建，管理生命周期，自动维护对象之间的依赖关系。</strong></p>
</li>
<li><p>依赖注入：</p>
<ul>
<li>构造器传参</li>
<li>方法传参</li>
<li>属性反射 field.set(x)</li>
</ul>
</li>
<li><p>依赖查找：</p>
<ul>
<li>byType</li>
<li>byName</li>
</ul>
</li>
<li><p>spring使用：</p>
<ul>
<li>bean的装配方式：<ul>
<li>xml</li>
<li>注解：<ul>
<li>@Component、@ComponentScan、@Service、@Controller…</li>
<li>@Bean、@Configuration…</li>
</ul>
</li>
<li>FactoryBean<ul>
<li>接口：FactoryBean</li>
</ul>
</li>
<li>@Import<ul>
<li>等同于xml中的import</li>
<li>实现接口ImportBeanDefinitionRegistry、ImportSelector</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>BeanFactory和FactoryBean有什么区别？</p>
<ul>
<li>FactoryBean是一个接口，实现里面的三个方法，可以往容器里添加bean，用byName的方式来取，如”myFactoryBean”，则会拿到其getObject方法返回的bean对象(User)，而如果用”&amp;myFactoryBean”来取，则会取到真实的factoryBean对象。</li>
<li></li>
</ul>
</li>
<li><p>Spring提供了几种方式管理bean的生命周期？有什么区别？</p>
</li>
</ol>
<h2 id="IOC介绍"><a href="#IOC介绍" class="headerlink" title="IOC介绍"></a>IOC介绍</h2><p>什么是IOC？</p>
<p>IOC也称为依赖注入（DI），它是一个对象定义依赖关系的过程，也就是说，对象只通过构造函数参数、工厂方法的参数或对象实例构造方法或从工厂返回在对象实例上设置的属性来定义他们所使用的其他对象。然后容器在创建bean时注入这些依赖项。这个过程本质上是bean本身的逆过程，因此称为控制反转（IOC），通过直接构造来控制其依赖项的实例化。</p>
<p>什么是bean？</p>
<p>在Spring中，构成应用程序主干并由Spring IOC容器管理的对象称为bean，bean是由SpringIOC容器实例化、组装和管理的对象。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/20/Spring/Spring%E6%BA%90%E7%A0%81/01_Spring_AOP/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/20/Spring/Spring%E6%BA%90%E7%A0%81/01_Spring_AOP/" class="post-title-link" itemprop="url">01_Spring_AOP</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-20 13:44:53" itemprop="dateCreated datePublished" datetime="2019-10-20T13:44:53+08:00">2019-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/spring%E6%BA%90%E7%A0%81/" itemprop="url" rel="index">
                    <span itemprop="name">spring源码</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="01-Spring-AOP"><a href="#01-Spring-AOP" class="headerlink" title="01_Spring_AOP"></a>01_Spring_AOP</h1><p>与OOP（Object Oriented Programming面向对象）相比，传统的OOP开发中的代码逻辑是自上向下的，而在这些自上而下的过程中产生横切性的问题，而这些横切性的问题又与我们的业务逻辑关系不大，会散落在代码的各个地方，造成难以维护。</p>
<p>AOP的编程思想是把这些横切性的问题和主业务逻辑进行分离，从而起到解耦的目的。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>首先导入织入包：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>用<code>@EnableAspectJAutoProxy</code>或者<code>&lt;aop:aspectj-autoproxy/&gt;</code>开启。</p>
<p><img src="01_Spring_AOP/1571550660947.png" alt="1571550660947"></p>
<p>编写一个切面组件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> xieweidu</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@createDate</span> 2019-10-20 13:51</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Aspect</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyAspect</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Pointcut</span>(<span class="string">"execution(* top.tomxwd.controller.*.*(..))"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">pointcut</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Around</span>(<span class="string">"top.tomxwd.config.aop.MyAspect.pointcut()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">around</span><span class="params">(ProceedingJoinPoint pjp)</span></span>&#123;</span><br><span class="line">        <span class="keyword">long</span> start = System.currentTimeMillis();</span><br><span class="line">        Object proceed = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            proceed = pjp.proceed();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable throwable) &#123;</span><br><span class="line">            throwable.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> end = System.currentTimeMillis();</span><br><span class="line">        log.info(<span class="string">"执行时间为&#123;&#125;"</span>,end-start);</span><br><span class="line">        <span class="keyword">return</span> proceed;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span>(<span class="string">"top.tomxwd.config.aop.MyAspect.pointcut()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">before</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"-------------------before-------------------"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span>(<span class="string">"top.tomxwd.config.aop.MyAspect.pointcut()"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">after</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"-------------------after--------------------"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>debug源码发现是在后置处理器的时候进行aop动态代理的。</p>
<p>为什么jdk动态代理必须是接口？</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProxyTest</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">byte</span>[] proxyClassFile = ProxyGenerator.generateProxyClass(<span class="string">"$Proxy"</span>, <span class="keyword">new</span> Class[]&#123;UserService<span class="class">.<span class="keyword">class</span>&#125;)</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            FileOutputStream fileOutputStream = <span class="keyword">new</span> FileOutputStream(<span class="string">"MyProxy.class"</span>);</span><br><span class="line">            fileOutputStream.write(proxyClassFile);</span><br><span class="line">            fileOutputStream.flush();</span><br><span class="line">            fileOutputStream.close();</span><br><span class="line">            System.out.println(<span class="string">"writer完毕"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>查看输出的MyProxy.class反编译后的结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> $<span class="title">Proxy</span> <span class="keyword">extends</span> <span class="title">Proxy</span> <span class="keyword">implements</span> <span class="title">UserService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m1;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m4;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m2;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m3;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Method m0;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> $Proxy(InvocationHandler var1) <span class="keyword">throws</span>  &#123;</span><br><span class="line">        <span class="keyword">super</span>(var1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object var1)</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Boolean)<span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m1, <span class="keyword">new</span> Object[]&#123;var1&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var3;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var4) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var4);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> List <span class="title">userList</span><span class="params">()</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (List)<span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m4, (Object[])<span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var2) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var2;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">toString</span><span class="params">()</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (String)<span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m2, (Object[])<span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var2) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var2;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> Integer <span class="title">saveUser</span><span class="params">(User var1)</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Integer)<span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m3, <span class="keyword">new</span> Object[]&#123;var1&#125;);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var3;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var4) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var4);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> <span class="keyword">throws</span>  </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> (Integer)<span class="keyword">super</span>.h.invoke(<span class="keyword">this</span>, m0, (Object[])<span class="keyword">null</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (RuntimeException | Error var2) &#123;</span><br><span class="line">            <span class="keyword">throw</span> var2;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> UndeclaredThrowableException(var3);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            m1 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"equals"</span>, Class.forName(<span class="string">"java.lang.Object"</span>));</span><br><span class="line">            m4 = Class.forName(<span class="string">"top.tomxwd.service.UserService"</span>).getMethod(<span class="string">"userList"</span>);</span><br><span class="line">            m2 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"toString"</span>);</span><br><span class="line">            m3 = Class.forName(<span class="string">"top.tomxwd.service.UserService"</span>).getMethod(<span class="string">"saveUser"</span>, Class.forName(<span class="string">"top.tomxwd.entity.User"</span>));</span><br><span class="line">            m0 = Class.forName(<span class="string">"java.lang.Object"</span>).getMethod(<span class="string">"hashCode"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (NoSuchMethodException var2) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchMethodError(var2.getMessage());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException var3) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NoClassDefFoundError(var3.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到JDK动态代理是继承自Proxy类，然后实现接口来达到代理的。底层是先通过字节码来实现。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

        
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block home" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://www.blog.tomxwd.com/2019/10/16/Hadoop/07_Hadoop_%E7%BC%96%E8%AF%91%E6%BA%90%E7%A0%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
      <meta itemprop="name" content="tomxwd">
      <meta itemprop="description" content="tomxwd">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="tomxwd.blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          
            <a href="/2019/10/16/Hadoop/07_Hadoop_%E7%BC%96%E8%AF%91%E6%BA%90%E7%A0%81/" class="post-title-link" itemprop="url">07_Hadoop_编译源码</a>
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-10-16 22:34:39" itemprop="dateCreated datePublished" datetime="2019-10-16T22:34:39+08:00">2019-10-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2019-11-16 17:59:16" itemprop="dateModified" datetime="2019-11-16T17:59:16+08:00">2019-11-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Hadoop/" itemprop="url" rel="index">
                    <span itemprop="name">Hadoop</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="07-Hadoop-编译源码"><a href="#07-Hadoop-编译源码" class="headerlink" title="07_Hadoop_编译源码"></a>07_Hadoop_编译源码</h1><h2 id="前期准备工作"><a href="#前期准备工作" class="headerlink" title="前期准备工作"></a>前期准备工作</h2><p><strong>切换到root用户进行操作，减少文件夹权限出现问题</strong></p>
<ol>
<li><p>CentOS联网</p>
<p>配置CentOS能连接外网。</p>
</li>
<li><p>jar包准备（hadoop源码、JDK1.8、maven、ant、protobuf）</p>
<ul>
<li>hadoop-2.9.2-src.tar.gz</li>
<li>jdk-8u221-linux-x64.tar.gz</li>
<li><a href="https://archive.apache.org/dist/ant/" target="_blank" rel="noopener"></a>（build工具，打包用的，网站中binaries、source中下载）</li>
<li><a href="https://archive.apache.org/dist/maven/" target="_blank" rel="noopener"></a>（maven，网站中找maven3下载）</li>
<li><a href="https://github.com/protocolbuffers/protobuf/releases" target="_blank" rel="noopener">protobuf</a>（序列化的框架）</li>
</ul>
</li>
</ol>
<h2 id="tar包安装"><a href="#tar包安装" class="headerlink" title="tar包安装"></a>tar包安装</h2><p><strong>注意切换到root用户操作</strong></p>
<ol>
<li>JDK解压、配置环境变量JAVA_HOME和PATH，验证java-version<ul>
<li>编辑/etc/profile文件</li>
</ul>
</li>
<li>MAVEN解压、配置MAVEN_HOME和PATH</li>
<li>ant解压、配置ANT_HOME和PATH</li>
<li>安装glibc-headers和g++命令</li>
<li>安装make和cmake</li>
<li>解压protobuf，进入到解压后protobuf主目录，/opt/module/protobuf-2.5.0,然后执行以下命令</li>
<li>安装OpenSSL库</li>
<li>安装ncurses-devel库</li>
</ol>
<h2 id="编译源码"><a href="#编译源码" class="headerlink" title="编译源码"></a>编译源码</h2><ol>
<li><p>解压源码到/opt/目录</p>
</li>
<li><p>进入到hadoop源码主目录</p>
</li>
<li><p>通过maven执行编译命令</p>
</li>
<li><p>成功的64位hadoop包在/opt/hadoop/hadoop-dist/target下</p>
</li>
<li><p>编译源码过程中常见的问题及解决方案</p>
<ul>
<li><p>maven install的时候发现JVM内存溢出</p>
<p>在环境配置文件和maven的执行文件均可调整MAVEN_OPT的heap的大小。</p>
</li>
<li><p>编译期间maven报错。可能网络阻塞问题导致依赖库下载不完整导致，多次执行命令（一次通过比较难）</p>
</li>
<li><p>报ant、protobuf等错误，插件下载未完整或者插件版本问题，最开始链接有较多特殊情况</p>
</li>
</ul>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

  </div>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/35/">35</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="tomxwd"
      src="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/blog_headImg/%E9%B1%BC%E4%BA%BA%E5%A4%B4%E5%83%8F.jpg">
  <p class="site-author-name" itemprop="name">tomxwd</p>
  <div class="site-description" itemprop="description">tomxwd</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">342</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">40</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="feed-link motion-element">
    <a href="/atom.xml" rel="alternate">
      <i class="fa fa-rss"></i>RSS
    </a>
  </div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/tomxwd" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;tomxwd" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        
  <div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">粤ICP备18158552号-1 </a>
      <img src="https://raw.githubusercontent.com/tomxwd/ImageHosting/master/resource/ico/%E5%A4%87%E6%A1%88%E5%9B%BE%E6%A0%87.png" style="display: inline-block;"><a href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=18158552" rel="noopener" target="_blank">1213123 </a>
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-bug"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tomxwd</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.0.0
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>












        
      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/muse.js"></script>
<script src="/js/next-boot.js"></script>



  
















  

  

</body>
</html>
